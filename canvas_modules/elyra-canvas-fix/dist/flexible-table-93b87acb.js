import{t as e,u as t,R as r,S as o,o as i,c as l,_ as s,v as n,w as a,x as c,O as p}from"./extends-a9c1b4cd.js";import{_ as d,a as u,b as h}from"./createClass-be661622.js";import{_ as b,a as m,b as f,c as v}from"./getPrototypeOf-3751add9.js";import{A as w,B as g,C as y,D as k,k as C,E as R,F as x,e as S,_ as E,G as T,y as I,H as N,I as O,b as H,m as A,q as M,l as D,h as L,j as z}from"./isArrayLikeObject-7787005e.js";import B from"react";import{injectIntl as _}from"react-intl";import P from"react-dom";import{Checkbox as j,Loading as F,Search as W}from"carbon-components-react";import{_ as K}from"./_baseForOwn-6ff4cc59.js";import{AutoSizer as G,Table as V,Column as U}from"react-virtualized";import q from"react-draggable";import{ArrowsVertical16 as X,ArrowDown16 as Y,ArrowUp16 as $,Information16 as J}from"@carbon/icons-react";import Q from"./lib/tooltip.es.js";import{v4 as Z}from"uuid";import ee from"react-resize-detector";var te={"subPanel.button.tooltip":"Edit","structureListEditor.addButton.label":"Add value","structureListEditor.removeButton.label":"Remove","structureTable.addButton.label":"Add columns","structureTable.removeButton.label":"Remove","fieldPicker.saveButton.label":"Select Fields for","fieldPicker.saveButton.modal.label":"Save and continue","fieldPicker.resetButton.label":"Reset ","fieldPicker.filter.label":"Filter:","fieldPicker.fieldColumn.label":"Field name","fieldPicker.schemaColumn.label":"Schema name","fieldPicker.dataTypeColumn.label":"Data type","fieldPicker.integer.label":"integer","fieldPicker.double.label":"double","fieldPicker.string.label":"string","fieldPicker.date.label":"date","fieldPicker.time.label":"time","fieldPicker.timestamp.label":"timestamp","flyout.applyButton.label":"OK","flyout.rejectButton.label":"Cancel","propertiesEdit.closeButton.label":"Close","propertiesEdit.applyButton.label":"Save","propertiesEdit.rejectButton.label":"Cancel","propertiesEdit.revertButton.label":"Revert","propertiesEdit.resizeButton.expand.label":"Expand","propertiesEdit.resizeButton.contract.label":"Contract","properties.revert.message":"Click Revert to go back to the previous screen or click Close to exit the pane. Then try your operation again.","properties.close.message":"Click Close to exit the pane. Then try your operation again.","properties.support.message":"If the problem persists, contact support.","properties.unexpected.message":"Oops, the pane didn't load.","table.search.header":"View in tables","table.search.placeholder":"Find in column {column_name}","table.search.label":"Search in {table_name} table","summary.longTable.placeholder":"More than ten fields...","alerts.tab.title":"Alerts","title.editor.label":"edit title","title.editor.helpButton.label":"help","table.summary.error":"There are {errorMsgCount} error cells. ","table.summary.warning":"There are {warningMsgCount} warning cells. ","control.summary.error":"There are {errorMsgCount} parameters with errors. ","control.summary.warning":"There are {warningMsgCount} parameters with warnings. ","control.summary.error.warning":"There are {errorMsgCount} parameters with errors and {warningMsgCount} parameters with warnings.","required.error":"You must provide your {label}.","datetime.format.error":"Invalid {role}. Format should be {format}.","invalid.field.error":"Invalid {label}, field not found in data set.","invalid.number.error":"Number is not valid.","expression.validate.label":"Validate","expression.validating.label":"Validating","expression.builder.title":"Expression Builder","expression.builder.icon.description":"launch expression builder","expression.builder.label":"Expression","expression.fields.table.label":"Fields table","expression.values.table.label":"Values table","expression.fields.empty.table.label":"No fields found","expression.values.empty.table.label":"No values found","expression.functions.table.label":"Functions table","expression.fields.dropdown":"Fields","expression.fields.title":"Fields","expression.values.title":"Values","expression.field.column":"Field","expression.field.column.description":"","expression.storage.column":"Storage","expression.value.column":"Value","expression.value.column.description":"","expression.function.column":"Function","expression.return.column":"Return","expression.recently.used.column":"Item","expression.field.tab":"Fields","expression.functions.tab":"Functions","expression.recently.used":"Recently Used","expression.all.functions":"All Functions","expression.min.label":"Min","expression.minimize.label":"Minimize","expression.max.label":"Max","expression.maximize.label":"Maximize","toggle.on.label":"On","toggle.off.label":"Off","passwordShow.tooltip":"Show password","passwordHide.tooltip":"Hide password","expression.no.functions":"No functions found.","multi.selected.row.label":"rows selected.","multi.selected.row.action":"Changing a value in this row will change the value in all allowed selected rows.","datetimefield.format.error.message":"Invalid format object provided. Check input definitions.","editorform.group.type.error":"(Unknown group type '{group.groupType()}')","moveable.table.button.top":"Move to top","moveable.table.button.up":"Move up","moveable.table.button.down":"Move down","moveable.table.button.bottom":"Move to bottom","list.table.label":"Values","dropdown.tooltip.openMenu":"Open menu","dropdown.tooltip.closeMenu":"Close menu","dropdown.tooltip.clear.all":"Clear all","dropdown.tooltip.clear.selection":"Clear selection","truncate.long.string.error":"These values exceed the display limit of {truncate_limit} characters and can't be edited.","properties.label":"Properties","readonlytable.edit.button.label":"Edit","toggletext.icon.description":"{toggletext_label} Icon","multiselect.dropdown.empty.label":"None selected","multiselect.dropdown.options.selected.label":"options selected","virtualizedTable.header.checkbox.label":"Select all {header_checkbox_label}","virtualizedTable.row.checkbox.label":"Select row {row_index} from {table_label}","properties.empty.table.text":'To begin, click "{button_label}"',"label.indicator.required":"(required)","label.indicator.optional":"(optional)","emptyList.placeholder":"No options available"};var re=function(e,t){return null!=e&&t in Object(e)},oe=w;var ie=function(e,t){return null!=e&&oe(e,t,re)};var le=function(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}},se=g,ne=y,ae=le;var ce=k,pe=C,de=ie,ue=R,he=x,be=le,me=S;var fe=E;var ve=function(e){return function(t){return null==t?void 0:t[e]}},we=function(e){return function(t){return fe(t,e)}},ge=R,ye=S;var ke=function(e){var t=ne(e);return 1==t.length&&t[0][2]?ae(t[0][0],t[0][1]):function(r){return r===e||se(r,e,t)}},Ce=function(e,t){return ue(e)&&he(t)?be(me(e),t):function(r){var o=pe(r,e);return void 0===o&&o===t?de(r,e):ce(t,o,3)}},Re=T,xe=I,Se=function(e){return ge(e)?ve(ye(e)):we(e)};var Ee=function(e){return"function"==typeof e?e:null==e?Re:"object"==typeof e?xe(e)?Ce(e[0],e[1]):ke(e):Se(e)},Te=N,Ie=K,Ne=Ee;var Oe=function(e,t){var r={};return t=Ne(t),Ie(e,(function(e,o,i){Te(r,o,t(e,o,i))})),r},He=O,Ae=H,Me=Ee,De=M,Le=D,ze=A((function(e,t){var r=Le(t);return De(r)&&(r=void 0),De(e)?He(e,Ae(t,1,De,!0),Me(r)):[]}));function Be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m(e);if(t){var i=m(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return f(this,r)}}var _e=function(n){b(c,n);var a=Be(c);function c(e,t){var r;return d(this,c),(r=a.call(this,e,t)).state={rowCount:r.props.rowCount,columns:r.props.columns,columnResized:!1},r.virtualizedTableRef=B.createRef(),r.lastChecked=L(e.rowsSelected)?null:e.rowsSelected.slice(-1).pop(),r.isOverSelectOption=!1,r.mouseEventCalled=!1,r.keyBoardEventCalled=!1,r.cellRenderer=r.cellRenderer.bind(v(r)),r.selectAll=r.selectAll.bind(v(r)),r.headerRowRenderer=r.headerRowRenderer.bind(v(r)),r.headerColRenderer=r.headerColRenderer.bind(v(r)),r.onRowClick=r.onRowClick.bind(v(r)),r.overSelectOption=r.overSelectOption.bind(v(r)),r.resizeColumn=r.resizeColumn.bind(v(r)),r}return u(c,[{key:"componentDidUpdate",value:function(){"function"==typeof this.props.rowHeight&&this.recomputeRowHeights()}},{key:"onRowClick",value:function(e,t,r){if("bx--select-option"===e.target.className)e.stopPropagation();else{var o=!this.isRowSelected(t.originalRowIndex);"function"==typeof this.props.setRowsSelected&&(this.props.setRowsSelected({index:r,originalRowIndex:t.originalRowIndex,selected:o,isOverSelectOption:this.isOverSelectOption,selectMultipleRows:!!e.shiftKey&&e.shiftKey,lastCheckedRow:null===this.lastChecked?0:this.lastChecked},e),this.lastChecked=t.index)}}},{key:"onRowDoubleClick",value:function(e,t,r){this.props.onRowDoubleClick&&this.props.onRowDoubleClick(e,t,r)}},{key:"getCheckboxLabelColumnIndex",value:function(e){for(var t=0;t<e.length;t++)if("index"!==e[t].operation)return t;return 0}},{key:"getColumnIndex",value:function(e,t){return e.findIndex((function(e){return e.key===t}))}},{key:"getColumnWiseDeltas",value:function(r,o){var i={};if(r.length>0){r.sort((function(e,t){return e.width-t.width}));for(var l=o,s=0;s<r.length;s++){var n=r.slice(s).reduce((function(e,t){return e+t.width}),0),a=Math.round(r[s].width*l/n);r[s].headerLabel.length>0&&r[s].width-a<e?a=r[s].width-e:r[s].width-a<t&&(a=r[s].width-t),l-=a,i[r[s].key]=a}if(l>0)return Oe(i,(function(){return 0}))}return i}},{key:"isRowSelected",value:function(e){return!!this.props.rowsSelected&&this.props.rowsSelected.indexOf(e)>-1}},{key:"isLastColumn",value:function(e){var t=this.getColumnIndex(this.props.columns,e)===this.props.columns.length-1;return t}},{key:"selectAll",value:function(e){this.props.setAllRowsSelected(e)}},{key:"cellRenderer",value:function(e){var t=e.cellData;return null==t?"":t}},{key:"cellRendererHTML",value:function(e){var t=e.cellData;return null==t?"":B.createElement("div",{dangerouslySetInnerHTML:{__html:t}})}},{key:"recomputeRowHeights",value:function(e){this.virtualizedTableRef&&this.virtualizedTableRef.current&&this.virtualizedTableRef.current.recomputeRowHeights(e)}},{key:"headerRowRenderer",value:function(e,t){var o=t.className,i=t.columns,l=t.style,s=void 0===this.props.columns||0===this.props.columns.length?0:this.getCheckboxLabelColumnIndex(this.props.columns),n=void 0===this.props.columns||0===this.props.columns.length?"":this.props.columns[s].headerLabel,a=this.props.intl.formatMessage({id:"virtualizedTable.header.checkbox.label",defaultMessage:te["virtualizedTable.header.checkbox.label"]},{header_checkbox_label:n}),c=this.props.selectable&&this.props.rowSelection!==r.SINGLE?B.createElement("div",{role:"columnheader",className:"properties-vt-header-checkbox"},B.createElement(j,{id:"properties-vt-hd-cb-".concat(e),onChange:this.selectAll,checked:this.props.checkedAll,labelText:a,hideLabel:!0})):"";return B.createElement("div",{className:o,"data-role":"properties-header-row",role:"row",style:l},c,i)}},{key:"headerColRenderer",value:function(e){var t=this,r=e.columnData,s=e.dataKey,n=e.disableSort,a=e.label;e.sortBy,e.sortDirection;var c=null;if(void 0!==this.props.sortColumns[s]){var p=null;switch(this.props.sortColumns[s]){case i.ASC:p=B.createElement($,{disabled:this.props.tableState===o.DISABLED});break;case i.DESC:p=B.createElement(Y,{disabled:this.props.tableState===o.DISABLED});break;default:p=B.createElement(X,{disabled:this.props.tableState===o.DISABLED})}c=B.createElement("span",{className:"properties-ft-column-sort-icon"},p)}var d=r.headerLabel?B.createElement("div",{className:"properties-tooltips"},B.createElement("span",{style:{fontWeight:"bold"}},r.headerLabel)):null,u=L(r.description)?null:B.createElement("div",{className:"properties-vt-info-icon-tip"},B.createElement(Q,{id:"properties-tooltip-".concat(r.headerLabel,"-info"),tip:r.description,direction:"bottom",className:"properties-tooltips",showToolTipOnClick:!0},B.createElement(J,{className:"properties-vt-info-icon"}))),h=Z()+"-tooltip-column-"+s,b=r.resizable&&!this.isLastColumn(s)?B.createElement(q,{axis:"x",defaultClassName:"properties-vt-header-resize",defaultClassNameDragging:"properties-vt-header-resize-active",onDrag:function(e,r){var o=r.deltaX;t.resizeColumn({dataKey:s,deltaX:o})},position:{x:0},zIndex:999},B.createElement("div",{role:"button",tabIndex:"0","aria-label":"Resize column"})):"",m=L(d)?B.createElement("div",{className:"properties-vt-label-icon"},a,u):B.createElement("div",{className:"properties-vt-label-tip-icon"},B.createElement(Q,{id:h,tip:d,direction:"bottom",className:"properties-tooltips"},a),u);return B.createElement("div",{className:l({"properties-vt-column-with-resize":""!==b,"properties-vt-column-without-resize":""===b})},B.createElement("div",{className:l("properties-vt-column properties-tooltips-container",{"sort-column-active":s===this.props.sortBy})},m,!1===n&&c),b)}},{key:"resizeColumn",value:function(r){var o=this,i=r.dataKey,l=r.deltaX;this.setState((function(r){var s=r.columns,n=o.getColumnIndex(s,i),a=s.slice(n+1).filter((function(e){return!e.staticWidth})).filter((function(r){return!(l>=0)||(r.headerLabel.length>0?r.width>e:r.width>t)})),c=o.getColumnWiseDeltas(a,l),p=Object.keys(c),d=Object.values(c).every((function(e){return 0===e}));return s[n].width+l>e&&!L(c)&&!d&&(s[n].width+=l,p.forEach((function(e){var t=s.findIndex((function(t){return t.key===e}));s[t].width-=c[e]}))),{columnResized:!0,columns:s}}))}},{key:"overSelectOption",value:function(e){"mouseenter"!==e.type||this.keyBoardEventCalled?"mouseleave"===e.type&&this.mouseEventCalled?(this.mouseEventCalled=!1,this.isOverSelectOption=!this.isOverSelectOption):"focus"!==e.type||this.mouseEventCalled?"blur"===e.type&&this.keyBoardEventCalled&&(this.keyBoardEventCalled=!1,this.isOverSelectOption=!this.isOverSelectOption):(this.keyBoardEventCalled=!0,this.isOverSelectOption=!this.isOverSelectOption):(this.mouseEventCalled=!0,this.isOverSelectOption=!this.isOverSelectOption)}},{key:"rowRenderer",value:function(e,t){var o=this,i=t.className,s=t.columns,n=t.index,a=t.key,c=t.rowData,p=t.style,d="",u=!1,h="boolean"==typeof c.disabled&&c.disabled;if("function"==typeof this.props.rowHeight&&0===this.props.rowHeight({index:n}))return null;if(this.props.selectable){var b=this.isRowSelected(c.originalRowIndex);if(u=this.props.selectable&&b,this.props.rowSelection!==r.SINGLE){var m=this.props.intl.formatMessage({id:"virtualizedTable.row.checkbox.label",defaultMessage:te["virtualizedTable.row.checkbox.label"]},{row_index:n+1,table_label:this.props.tableLabel?this.props.tableLabel:""});d=B.createElement("div",{className:"properties-vt-row-checkbox",role:"gridcell",onMouseEnter:function(e){return o.overSelectOption(e)},onMouseLeave:function(e){return o.overSelectOption(e)},onFocus:function(e){return o.overSelectOption(e)},onBlur:function(e){return o.overSelectOption(e)},onKeyDown:function(e){"Space"!==e.code&&"Enter"!==e.code||o.onRowClick(e,c,n)}},B.createElement(j,{id:"properties-vt-row-cb-".concat(e,"-").concat(n),key:"properties-vt-row-cb-".concat(e,"-").concat(n),labelText:m,hideLabel:!0,checked:b,disabled:h}))}}if(this.props.summaryTable&&(d=B.createElement("div",{className:"properties-vt-row-checkbox"})),!0===c.loading)return B.createElement("div",{className:i,key:a,"data-role":"properties-loading-row",role:"row",style:p},B.createElement(F,{className:"properties-vt-small-loading",small:!0,withOverlay:!1}));var f=parseInt(p.width,10)+"px",v=Object.assign({},p,{width:f});return B.createElement("div",{style:{},key:a,className:"properties-vt-double-click",onDoubleClick:function(e){return o.onRowDoubleClick(e,c.rowKey,n)}},B.createElement("div",{className:l(i,{"properties-vt-row-selected":u},{"properties-vt-row-disabled":h},{"properties-vt-row-non-interactive":!this.props.selectable}),"data-role":"properties-data-row",role:"row",style:v,onMouseDown:function(e){return o.onRowClick(e,c,n)}},d,s))}},{key:"render",value:function(){var e=this;return B.createElement("div",{className:"properties-vt"},B.createElement("div",{className:l("properties-vt-autosizer",{"properties-vt-single-selection":this.props.rowSelection&&this.props.rowSelection===r.SINGLE,"properties-light-disabled":!this.props.light})},B.createElement(G,null,(function(t){var r=t.height,o=t.width;return B.createElement(V,{ref:e.virtualizedTableRef,width:o||500,height:e.props.tableHeight||r||2e3,className:"properties-autosized-vt","aria-label":e.props.tableLabel?e.props.tableLabel:"",disableHeader:e.props.disableHeader,headerClassName:"properties-autosized-vt-header",headerHeight:32,headerRowRenderer:e.headerRowRenderer.bind(e,e.props.scrollKey),onHeaderClick:e.props.onHeaderClick,rowClassName:"properties-vt-row-class",rowHeight:e.props.rowHeight?e.props.rowHeight:32,rowCount:e.state.rowCount,rowGetter:e.props.rowGetter,rowRenderer:e.rowRenderer.bind(e,e.props.scrollKey),scrollToIndex:e.props.scrollToIndex,scrollToAlignment:e.props.scrollToAlignment,sort:e.props.onSort,sortDirection:e.props.sortDirection},e.state.columns.map((function(t){return B.createElement(U,s({key:t.key,label:t.label,dataKey:t.key,width:t.width,columnData:t,disableSort:void 0===e.props.sortColumns[t.key],cellRenderer:t.isHTML?e.cellRendererHTML:e.cellRenderer,headerRenderer:e.headerColRenderer},t.minWidth&&{minWidth:t.minWidth}))})))}))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var r={};return e.rowCount!==t.rowCount&&(r.rowCount=e.rowCount),t.columnResized&&L(ze(e.columns,t.columns,"headerLabel"))||(r.columns=e.columns),r}}]),c}(B.Component);_e.defaultProps={disableHeader:!1};var Pe=_(_e);function je(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Fe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Fe(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,s=!0,n=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){n=!0,l=e},f:function(){try{s||null==r.return||r.return()}finally{if(n)throw l}}}}function Fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function We(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,o=m(e);if(t){var i=m(this).constructor;r=Reflect.construct(o,arguments,i)}else r=o.apply(this,arguments);return f(this,r)}}var Ke=function(e){b(m,e);var t=We(m);function m(e){var r;d(this,m);var o={};if(void 0!==(r=t.call(this,e)).props.sortable)for(var l=0;l<r.props.sortable.length;l++){o[r.props.sortable[l]]=i.NOT_SORTED}return r.state={checkedAllRows:!1,columnSortDir:o,currentSortColumn:"",tableWidth:0,tableHeight:0,rows:void 0!==e.rows?e.rows:5.5,dynamicHeight:null},r.rowHeight=r.rowHeight.bind(v(r)),r.rowGetter=r.rowGetter.bind(v(r)),r.getOriginalRowIndex=r.getOriginalRowIndex.bind(v(r)),r.getLastChildPropertyIdRow=r.getLastChildPropertyIdRow.bind(v(r)),r.calculateColumnWidths=r.calculateColumnWidths.bind(v(r)),r.handleFilterChange=r.handleFilterChange.bind(v(r)),r.onSort=r.onSort.bind(v(r)),r.sortHeaderClick=r.sortHeaderClick.bind(v(r)),r._updateTableWidth=r._updateTableWidth.bind(v(r)),r._adjustTableHeight=r._adjustTableHeight.bind(v(r)),r.handleCheckedRow=r.handleCheckedRow.bind(v(r)),r.handleCheckedAllRows=r.handleCheckedAllRows.bind(v(r)),r.handleCheckedMultipleRows=r.handleCheckedMultipleRows.bind(v(r)),r}return u(m,[{key:"componentDidMount",value:function(){this._adjustTableHeight(),window.addEventListener("resize",this._adjustTableHeight),this.tableNode=P.findDOMNode(this.refs.table)}},{key:"componentDidUpdate",value:function(e,t){e.rows===this.props.rows&&e.columns===this.props.columns&&e.noAutoSize===this.props.noAutoSize||this._adjustTableHeight(),this.props.selectedRows&&!L(this.props.data)&&this.setCheckedAll(this.props.selectedRows),this.tableNode=P.findDOMNode(this.refs.table)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._adjustTableHeight)}},{key:"onSort",value:function(e){var t=e.sortBy;if(this.props.onSort){var r={column:t,direction:this.state.columnSortDir[t]===i.ASC?i.DESC:i.ASC};this.props.onSort(r)}}},{key:"getOriginalRowIndex",value:function(e,t){var r=t;return e.columns&&z(e.columns[0],"content.props.children.props.propertyId.propertyId")?r=this.getLastChildPropertyIdRow(e.columns[0].content.props.children.props.propertyId,t):e.columns&&z(e.columns[0],"content.props.children.props.propertyId.index")?r=e.columns[0].content.props.children.props.propertyId.index:e.columns&&z(e.columns[0],"content.props.children.props.propertyId.row")?r=e.columns[0].content.props.children.props.propertyId.row:"number"==typeof e.rowKey&&(r=parseInt(e.rowKey,10)),r}},{key:"getLastChildPropertyIdRow",value:function(e,t){return void 0!==e.propertyId?this.getLastChildPropertyIdRow(e.propertyId):void 0!==e.row?e.row:t}},{key:"setCheckedAll",value:function(e){for(var t=!0,r=0;r<this.props.data.length;r++){var o=this.props.data[r],i=this.getOriginalRowIndex(o,r);if(e.indexOf(i)<0){t=!1;break}}this.state.checkedAllRows!==t&&this.setState({checkedAllRows:t})}},{key:"calculateColumnWidths",value:function(e,t){var o=t-12;this.props.rowSelection!==r.SINGLE&&(o-=40);var i,l=e.length,s=0,n=je(e);try{for(n.s();!(i=n.n()).done;){var a=i.value;a.width&&("string"==typeof a.width&&a.width.includes("px")?(o-=parseInt(a.width,10),l--):s=Math.max(s,a.width))}}catch(e){n.e(e)}finally{n.f()}var c,p=[],d=Math.floor(o/l),u=[],h=0,b=je(e);try{for(b.s();!(c=b.n()).done;){var m=c.value;m.width&&!isNaN(m.width)?(u.push(m.width/s),h+=m.width/s):u.push(null)}}catch(e){b.e(e)}finally{b.f()}for(var f=o/h,v=0,w=0;w<e.length;w++){var g=e[w];if(g.width)if("string"==typeof g.width&&g.width.includes("px"))p.push(Math.floor(parseInt(g.width,10))+"px"),v+=parseInt(g.width,10);else{var y=Math.floor(u[w]*f);p.push(y+"px"),v+=y}else p.push(d),v+=d}var k=t;if(this.props.rowSelection!==r.SINGLE&&(k-=40),v<k){var C=parseInt(p[0],10);p[0]=C+k-v+"px"}return p}},{key:"_updateTableWidth",value:function(e,t){this.state.tableWidth!==Math.floor(e-2)&&this.setState({tableWidth:Math.floor(e-2)})}},{key:"_adjustTableHeight",value:function(){if(!this.props.noAutoSize){var e=this.state.tableHeight,t=this.state.dynamicHeight,r=n+a;if(Array.isArray(this.props.data)&&this.props.data.length<this.state.rows)e=n*this.props.data.length+a+(this.props.selectedEditRow?r:0)+"rem";else if(this.state.rows>0)e=n*this.state.rows+a+(this.props.selectedEditRow?r:0)+"rem";else if(0===this.state.rows)e=a+"rem";else if(-1===this.state.rows&&this.flexibleTable){var o=void 0!==this.flexibleTableHeader?P.findDOMNode(this.flexibleTableHeader).getBoundingClientRect().height:0,i=this.findPropertyNodeHeight(this.flexibleTable,"properties-wf-children");0===i?(e="100vh",t=-1):(e="calc(".concat(i-o-50,"px - 3.5rem)"),t=i-o-50-56)}e!==this.state.tableHeight&&this.setState({tableHeight:e,dynamicHeight:t})}}},{key:"findPropertyNodeHeight",value:function(e,t){if(e&&e.parentNode&&e.parentNode.className&&e.parentNode.className.includes(t)){var r=P.findDOMNode(e.parentNode).getBoundingClientRect();return r?r.height:0}return e&&e.parentNode?this.findPropertyNodeHeight(e.parentNode,t):0}},{key:"sortHeaderClick",value:function(e){var t=e.dataKey,r=this.state.columnSortDir;void 0!==r[t]&&(Object.keys(r).forEach((function(e){e!==t&&(r[e]=i.NOT_SORTED)})),r[t]=r[t]===i.ASC?i.DESC:i.ASC,this.setState({columnSortDir:r,currentSortColumn:t}))}},{key:"handleFilterChange",value:function(e){this.props.onFilter&&this.props.onFilter(e.target.value)}},{key:"handleCheckedAllRows",value:function(e){var t=[],r=this.props.data;if(e){t=Array.from(this.props.selectedRows);for(var o=0;o<r.length;o++){var i=this.getOriginalRowIndex(r[o],o);t.push(i)}}t=Array.from(new Set(t)),this.props.updateRowSelections(t),this.setState({checkedAllRows:e})}},{key:"handleCheckedMultipleRows",value:function(e,t,r){var o,i=this.props.selectedRows?this.props.selectedRows:[];return o=e<t?Array.from({length:t-e+1},(function(t,r){return e+r})):Array.from({length:e-t+1},(function(e,r){return t+r})),i=i.filter((function(e){return!o.includes(e)})),r&&(i=i.concat(o)),i}},{key:"handleCheckedRow",value:function(e,t){var o=e.originalRowIndex,i=e.index,l=e.selected,s=e.isOverSelectOption;if(!this.props.data[i].disabled&&"function"==typeof this.props.updateRowSelections)if(s){var n=this.props.selectedRows?this.props.selectedRows:[];e.selectMultipleRows?(n=this.handleCheckedMultipleRows(e.lastCheckedRow,i,l),this.setCheckedAll(n)):l?(n=n.concat(o),this.setCheckedAll(n)):n&&(n=n.filter((function(e){return e!==o})),this.setState({checkedAllRows:!1})),n.sort((function(e,t){return e-t})),this.props.updateRowSelections(n)}else this.props.rowSelection===r.SINGLE&&this.props.updateRowSelections(e.index,t,this.props.data[e.index].rowKey)}},{key:"generateTableHeaderRow",value:function(e){for(var t=[],r="",o=0;o<this.props.columns.length;o++){var i=this.props.columns[o];void 0!==this.props.filterable&&this.props.filterable[0]===i.key&&(r=i.label);var l=Math.abs(parseInt(e[o],10)),s=void 0;"object"===h(i.label)?s=i.label.props.labelText:"string"==typeof i.label&&(s=i.label),t.push({key:i.key,label:i.label,width:l,description:i.description,headerLabel:s,resizable:i.resizable,operation:i.operation,staticWidth:!!i.staticWidth&&i.staticWidth})}return{headers:t,searchLabel:r}}},{key:"rowGetter",value:function(e){var t=e.index,r=this.props.data[t],o=this.getOriginalRowIndex(r,t),i={};if(r.columns)for(var l=0;l<r.columns.length;l++){var s=r.columns[l];i[s.column]=s.content}return Object.assign({},i,{loading:!1,index:t,originalRowIndex:o,rowKey:void 0!==r.rowKey?r.rowKey:this.props.scrollKey+"-row-"+t,disabled:r.disabled})}},{key:"rowHeight",value:function(e){return e.index,c}},{key:"render",value:function(){var e=this,t=this.state.tableWidth,r=this.calculateColumnWidths(this.props.columns,t),i=this.generateTableHeaderRow(r),n=i.headers,c=i.searchLabel,d=this.props.tableState===o.DISABLED,u=null;if(void 0!==this.props.filterable&&0!==this.props.filterable.length){var h=this.props.intl.formatMessage({id:"table.search.placeholder",defaultMessage:te["table.search.placeholder"]},{column_name:c}),b=this.props.intl.formatMessage({id:"table.search.label",defaultMessage:te["table.search.label"]},{table_name:this.props.tableLabel});u=B.createElement("div",{className:l("properties-ft-search-container",{disabled:d})},B.createElement(W,{className:"properties-ft-search-text",placeholder:h,onChange:this.handleFilterChange,disabled:d,size:"sm",labelText:b,light:this.props.light}))}var m=-1;void 0!==this.props.scrollToRow&&null!==this.props.scrollToRow&&(m=this.props.scrollToRow);var f={};this.props.noAutoSize||(f={height:this.state.tableHeight});var v=this.props.showHeader?"properties-ft-container-absolute ":"properties-ft-container-absolute-noheader ",w=this.props.messageInfo?v:v+o.INFO,g=u||this.props.topRightPanel?B.createElement("div",{className:"properties-ft-table-header",ref:function(t){return e.flexibleTableHeader=t}},u,this.props.topRightPanel):null,y=L(this.props.data)?B.createElement("div",{className:"properties-ft-empty-table"},this.props.emptyTablePlaceholder):null,k=l("properties-ft-control-container",{"properties-light-disabled":!this.props.light}),C=0,R=2*a,x=R*p;-1!==this.state.rows&&this.state.tableHeight?C=(parseInt(this.state.tableHeight,10)-(this.props.selectedEditRow?R:0))*p:-1===this.state.rows&&this.state.dynamicHeight&&-1!==this.state.dynamicHeight&&(C=this.state.dynamicHeight-(this.props.selectedEditRow?x:0));return B.createElement("div",{"data-id":"properties-ft-"+this.props.scrollKey,className:k,ref:function(t){return e.flexibleTable=t}},g,B.createElement("div",{className:"properties-ft-container-panel"},B.createElement(ee,{handleWidth:!0,onResize:this._updateTableWidth},B.createElement("div",{className:l("properties-ft-container-wrapper",this.props.messageInfo?this.props.messageInfo.type:""),style:f},B.createElement("div",{className:w},this.props.selectedEditRow,B.createElement(Pe,s({tableLabel:this.props.tableLabel,tableHeight:C,columns:n,onHeaderClick:this.sortHeaderClick,rowCount:this.props.data.length,rowHeight:this.rowHeight,rowGetter:this.rowGetter,summaryTable:this.props.summaryTable,selectable:void 0!==this.props.updateRowSelections,rowSelection:this.props.rowSelection,disableHeader:!this.props.showHeader,onRowDoubleClick:this.props.onRowDoubleClick,rowsSelected:this.props.selectedRows,checkedAll:this.state.checkedAllRows,setRowsSelected:this.handleCheckedRow,setAllRowsSelected:this.handleCheckedAllRows,scrollKey:this.props.scrollKey,onSort:this.onSort,sortBy:this.state.currentSortColumn,sortColumns:this.state.columnSortDir,sortDirection:this.state.columnSortDir[this.state.currentSortColumn],tableState:this.props.tableState,light:this.props.light},-1!==m&&{scrollToIndex:m,scrollToAlignment:"center"})))))),y)}}]),m}(B.Component);Ke.defaultProps={showHeader:!0,light:!0,emptyTablePlaceholder:""};var Ge=_(Ke);export{Ge as F,Ee as _,te as d,ie as h};
//# sourceMappingURL=flexible-table-93b87acb.js.map
