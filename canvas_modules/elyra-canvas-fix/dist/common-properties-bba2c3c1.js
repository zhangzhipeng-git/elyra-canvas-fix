"use strict";var e=require("./createClass-826941b3.js"),t=require("./getPrototypeOf-1e698126.js"),r=require("react"),o=require("./index-92040066.js"),n=require("./en-7cc24212.js"),a=require("./isArrayLikeObject-694e2d20.js"),i=require("./datarecord-metadata-v3-schema-677aa8cc.js"),s=require("./flexible-table-86768b1c.js"),l=require("carbon-components-react"),u=require("./extends-841b39ac.js"),p=require("react-portal"),c=require("react-redux"),d=require("@carbon/icons-react"),f=require("react-dom"),h=require("./icon-f6f2bffc.js"),m=require("uuid"),y=require("./lib/tooltip.js"),v=require("./canvas-constants-07dbe4b7.js"),g=require("redux"),b=require("seedrandom"),E=require("./lib/command-stack.js"),_=require("react-intl"),S=require("date-fns"),T=require("react-inlinesvg"),I=require("prop-types"),C=require("./toolbar-6c90f2f9.js"),R=require("react-codemirror2"),A=require("jsonschema");function k(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var O=k(r),w=k(f),N=k(b),P=k(T),L=k(I),D=a._baseGet,M=i._baseSet,x=a._castPath;var B=function(e,t,r){for(var o=-1,n=t.length,a={};++o<n;){var i=t[o],s=D(e,i);r(s,i)&&M(a,x(i,e),s)}return a},F=s.hasIn_1;var V=function(e,t){return B(e,t,(function(t,r){return F(e,r)}))},U=a._baseFlatten;var z=function(e){return(null==e?0:e.length)?U(e,1):[]},H=a._overRest,j=a._setToString;var G=function(e){return j(H(e,void 0,z),e+"")},q=V,Y=G((function(e,t){return null==e?{}:q(e,t)}));var K=function(e,t,r){var o=-1,n=e.length;t<0&&(t=-t>n?0:n+t),(r=r>n?n:r)<0&&(r+=n),n=t>r?0:r-t>>>0,t>>>=0;for(var a=Array(n);++o<n;)a[o]=e[o+t];return a},W=a._baseGet,X=K;var $=function(e,t){return t.length<2?e:W(e,X(t,0,-1))},J=a._castPath,Z=a.last_1,Q=$,ee=a._toKey;var te=function(e,t){return t=J(t,e),null==(e=Q(e,t))||delete e[ee(Z(t))]},re=a._baseGetTag,oe=n._getPrototype,ne=a.isObjectLike_1,ae=Function.prototype,ie=Object.prototype,se=ae.toString,le=ie.hasOwnProperty,ue=se.call(Object);var pe=function(e){if(!ne(e)||"[object Object]"!=re(e))return!1;var t=oe(e);if(null===t)return!0;var r=le.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&se.call(r)==ue};var ce=function(e){return pe(e)?void 0:e},de=a._arrayMap,fe=n._baseClone,he=te,me=a._castPath,ye=n._copyObject,ve=ce,ge=G,be=n._getAllKeysIn,Ee=ge((function(e,t){var r={};if(null==e)return r;var o=!1;t=de(t,(function(t){return t=me(t,e),o||(o=t.length>1),t})),ye(e,be(e),r),o&&(r=fe(r,7,ve));for(var n=t.length;n--;)he(r,t[n]);return r}));function _e(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var Se=function(r){t._inherits(a,r);var n=_e(a);function a(){return e._classCallCheck(this,a),n.apply(this,arguments)}return e._createClass(a,[{key:"getCarbonModalSize",value:function(){switch(this.props.bsSize){case o.Size.SMALL:return u.CARBON_MODAL_SIZE_XSMALL;case o.Size.LARGE:case o.Size.MAX:return u.CARBON_MODAL_SIZE_LARGE;case o.Size.MEDIUM:default:return u.CARBON_MODAL_SIZE_SMALL}}},{key:"render",value:function(){var e=this.getCarbonModalSize();return O.default.createElement(p.Portal,null,O.default.createElement(l.Modal,{className:u.classNames("properties-modal",{noButtons:!1===this.props.showPropertiesButtons},this.props.classNames),open:!0,modalHeading:this.props.title,primaryButtonText:this.props.applyLabel,secondaryButtonText:this.props.rejectLabel,onRequestSubmit:this.props.okHandler,onSecondarySubmit:this.props.cancelHandler,"aria-label":"",size:e},O.default.createElement("div",{className:"properties-modal-children"},this.props.children)))}}]),a}(r.Component),Te=Se;function Ie(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var Ce=function(r){t._inherits(a,r);var n=Ie(a);function a(){return e._classCallCheck(this,a),n.apply(this,arguments)}return e._createClass(a,[{key:"render",value:function(){var e="properties-editing properties-"+(void 0===this.props.bsSize?"large":this.props.bsSize),t=O.default.createElement(o.PropertiesButtons,{okHandler:this.props.okHandler,cancelHandler:this.props.cancelHandler,applyLabel:this.props.applyLabel,rejectLabel:this.props.rejectLabel,showPropertiesButtons:this.props.showPropertiesButtons});return O.default.createElement("div",{className:e},O.default.createElement("h2",null,this.props.title),O.default.createElement("div",{className:"properties-body"},this.props.children),t)}}]),a}(r.Component),Re=Ce;function Ae(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var ke=function(r){t._inherits(a,r);var n=Ae(a);function a(){return e._classCallCheck(this,a),n.apply(this,arguments)}return e._createClass(a,[{key:"render",value:function(){var e=this.props.tearsheet?this.props.tearsheet.title:null,t=this.props.tearsheet?this.props.tearsheet.description:null,r=this.props.tearsheet?this.props.tearsheet.content:null,n=this.props.showPropertiesButtons&&!this.props.applyOnBlur,a=!Array.isArray(r),i=this.props.applyOnBlur?null:O.default.createElement(o.PropertiesButtons,{okHandler:this.props.okHandler,cancelHandler:this.props.cancelHandler,applyLabel:this.props.applyLabel,rejectLabel:this.props.rejectLabel,showPropertiesButtons:this.props.showPropertiesButtons});return O.default.createElement(p.Portal,null,O.default.createElement(l.ComposedModal,{className:u.classNames("properties-tearsheet-panel",{"properties-tearsheet-stacked":this.props.stacked}),open:this.props.open,size:"lg",preventCloseOnClickOutside:!0},O.default.createElement(l.ModalHeader,{className:u.classNames("properties-tearsheet-header",{"with-buttons":n},{"with-tabs":a},{"hide-close-button":"function"!=typeof this.props.onCloseCallback}),title:e,buttonOnClick:this.props.onCloseCallback},t?O.default.createElement("p",null,t):null),O.default.createElement(l.ModalBody,{className:u.classNames("properties-tearsheet-body",{"with-buttons":n},{"with-tabs":a})},r),i))}}]),a}(r.Component);ke.defaultProps={open:!1,showPropertiesButtons:!1,applyOnBlur:!1,stacked:!1};var Oe=ke;function we(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var Ne=function(r){t._inherits(a,r);var n=we(a);function a(){return e._classCallCheck(this,a),n.apply(this,arguments)}return e._createClass(a,[{key:"shouldEnabledSaveButton",value:function(){return!!this.props.saveButtonEnabled&&(!this.props.disableSaveOnRequiredErrors||0===Object.keys(this.props.requiredErrorMessages).length)}},{key:"render",value:function(){var e=this.shouldEnabledSaveButton();return O.default.createElement(o.PropertiesButtons,{okHandler:this.props.okHandler,cancelHandler:this.props.cancelHandler,applyLabel:this.props.applyLabel,rejectLabel:this.props.rejectLabel,showPropertiesButtons:this.props.showPropertiesButtons,applyButtonEnabled:e})}}]),a}(r.Component);Ne.defaultProps={saveButtonEnabled:!0};var Pe=c.connect((function(e,t){return{saveButtonEnabled:!t.controller.getSaveButtonDisable(),requiredErrorMessages:t.controller.getRequiredErrorMessages()}}),null)(Ne),Le="SET_PROPERTY_VALUES",De="UPDATE_PROPERTY_VALUE",Me="REMOVE_PROPERTY_VALUE",xe="SET_CONTROL_STATES",Be="UPDATE_CONTROL_STATE",Fe="SET_PANEL_STATES",Ve="UPDATE_PANEL_STATE",Ue="SET_ACTION_STATES",ze="UPDATE_ACTION_STATE",He="SET_ERROR_MESSAGES",je="UPDATE_ERROR_MESSAGE",Ge="CLEAR_ERROR_MESSAGE",qe="SET_DATASET_METADATA",Ye="UPDATE_SELECTED_ROWS",Ke="CLEAR_SELECTED_ROWS",We="SET_TITLE",Xe="SET_ACTIVE_TAB",$e="DISABLE_ROW_MOVE_BUTTONS",Je="SET_SAVE_BUTTON_DISABLE",Ze="SET_WIDE_FLYOUT_PRIMARY_BUTTON_DISABLED",Qe="SET_ADD_REMOVE_ROWS",et="UPDATE_STATIC_ROWS",tt="CLEAR_STATIC_ROWS",rt="SET_TABLE_BUTTON_ENABLED",ot="SET_HIDE_EDIT_BUTTON",nt="SET_ACTIVE_TEARSHEET";function at(e){return{type:We,title:e}}function it(e){return{type:Xe,activeTab:e}}function st(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var lt=function(r){t._inherits(n,r);var o=st(n);function n(){return e._classCallCheck(this,n),o.apply(this,arguments)}return e._createClass(n,[{key:"render",value:function(){var e=this.props.panel;return void 0===e&&(e=O.default.createElement("div",{className:"properties-control-panel"})),e}}]),n}(O.default.Component),ut=c.connect((function(e,t){return{panel:t.panels[t.controller.getPropertyValue({name:t.dependsOn})]}}),null)(lt);function pt(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var ct=function(r){t._inherits(a,r);var n=pt(a);function a(r){var o;return e._classCallCheck(this,a),(o=n.call(this,r)).state={style:{height:0}},o.updateDimensions=o.updateDimensions.bind(t._assertThisInitialized(o)),o}return e._createClass(a,[{key:"componentDidMount",value:function(){this.updateDimensions(),window.addEventListener("resize",this.updateDimensions)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateDimensions)}},{key:"updateDimensions",value:function(){if(this.wideFlyout&&(this.commonPropertiesParent||(this.commonPropertiesParent=this.findPropertyWrapper(this.wideFlyout)),this.commonPropertiesParent)){var e=w.default.findDOMNode(this.commonPropertiesParent).getBoundingClientRect();this.setState({style:{height:e.height+"px",top:e.top+"px"}})}}},{key:"findPropertyWrapper",value:function(e){return e&&e.parentNode&&e.parentNode.className&&e.parentNode.className.includes("properties-right-flyout")?e.parentNode:e&&e.parentNode?this.findPropertyWrapper(e.parentNode):null}},{key:"render",value:function(){var e,t,r,n=this,a=O.default.createElement("div",{className:u.classNames("properties-wf-overlay",{show:this.props.show})});return this.props.show&&(this.props.title&&(e=O.default.createElement("div",{className:"properties-wf-title"},this.props.title)),t=O.default.createElement(o.PropertiesButtons,{okHandler:this.props.okHandler,cancelHandler:this.props.cancelHandler,showPropertiesButtons:this.props.showPropertiesButtons,applyLabel:this.props.applyLabel,rejectLabel:this.props.rejectLabel,applyButtonEnabled:this.props.okButtonEnabled}),r=O.default.createElement("div",{className:"properties-wf-children"}," ",this.props.children," ")),O.default.createElement("div",{className:"properties-wf-modal",ref:function(e){return n.wideFlyout=e}},O.default.createElement(p.Portal,{node:this.commonPropertiesParent},a,O.default.createElement("div",{className:u.classNames("properties-wf-content",{show:this.props.show,"properties-light-disabled":!this.props.light}),style:this.state.style},e,r,t)))}}]),a}(r.Component);ct.defaultProps={show:!1,okButtonEnabled:!0};var dt=ct;function ft(e,t){var r=t||m.v4();return"".concat(ht(e),"-").concat(r)}function ht(e){var t=e.name;return void 0!==e.row?(t+="_"+e.row,void 0!==e.col&&(t+="_"+e.col)):void 0!==e.col&&(t+="_"+e.col),"properties-"+t}function mt(e,t){var r=t;return e.charLimit&&(r=e.charLimit),r}function yt(e,t){if(e.length>0){var r=e.split(t);return Array.isArray(r)?r:[r]}return[]}function vt(e,t){var r=!1;if(Array.isArray(e)){if(0===e.length)return{value:"",truncated:r};var o="";return e.forEach((function(n,a){var i=gt(n),s=a===e.length-1?"":t;o+=i+s,r||(r=i.length!==n.length)})),{value:o,truncated:r}}return{value:e,truncated:r}}function gt(e){return e.length>u.TRUNCATE_LIMIT?e.substring(0,u.TRUNCATE_LIMIT)+"...":e}function bt(e,t){var r={};return!e||t||("error"===e.type?(r.invalid=!0,r.invalidText=e.text):"warning"===e.type&&(r.warn=!0,r.warnText=e.text)),r}function Et(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return _t(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _t(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function _t(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function St(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var Tt=function(r){t._inherits(i,r);var n=St(i);function i(r){var o;return e._classCallCheck(this,i),(o=n.call(this,r)).state={showWideFlyout:!1},o.handleLinkClicked=o.handleLinkClicked.bind(t._assertThisInitialized(o)),o.hideWideFlyout=o.hideWideFlyout.bind(t._assertThisInitialized(o)),o.cancelWideFlyout=o.cancelWideFlyout.bind(t._assertThisInitialized(o)),o._getSummaryTables=o._getSummaryTables.bind(t._assertThisInitialized(o)),o}return e._createClass(i,[{key:"_onMouseMove",value:function(e){this.setState({mousePos:{x:e.clientX,y:e.clientY}})}},{key:"hideWideFlyout",value:function(){this.props.controller.setIsSummaryPanelShowing(!1),this.setState({showWideFlyout:!1}),this.props.controller.clearSelectedRows()}},{key:"cancelWideFlyout",value:function(){this.props.controller.setPropertyValues(this.initialControlValues),this.props.controller.setErrorMessages(this.initialMessages),this.props.controller.setControlStates(this.initialStates),this.hideWideFlyout()}},{key:"handleLinkClicked",value:function(){this.props.children&&(this.props.controller.setIsSummaryPanelShowing(!0),this.setState({showWideFlyout:!0})),this.initialControlValues=this.props.controller.getPropertyValues(),this.initialMessages=this.props.controller.getAllErrorMessages(),this.initialStates=this.props.controller.getControlStates()}},{key:"_getSummaryTables",value:function(){var e=[],t=this.props.controller.getSummaryPanelControls(this.props.panel.id);if(!Array.isArray(t))return e;var r,n=Et(t);try{for(n.s();!(r=n.n()).done;){var a=r.value,i={name:a},s=this.props.controller.getControl(i),l=this.props.controller.getPropertyValue(i,{filterHiddenDisabled:!0}),p=this.props.controller.getCustPropSumPanelValue(i),c=!1;null!=p&&(l=p.value,s.summaryLabel=p.label,c=!0);var d=[];if(Array.isArray(l)){var f=0;if(s.subControls)for(var h=0;h<s.subControls.length;h++){var v={name:i.name,col:h};(this.props.controller.isSummary(v)||c)&&f++}else s.summary&&(f=1);for(var g=0!==f?"calc((100% / "+f+") - 2px)":"100%",b=0;b<l.length;b++){var E=l[b],_=[];if(Array.isArray(E))for(var S=0;S<E.length;S++){var T={name:i.name,col:S};if(this.props.controller.isSummary(T)||c){var I=this._getSummaryDisplayValue(E[S],T),C=void 0===I?"":JSON.stringify(I).replace('"',"").replace(new RegExp('"',"g"),"")+" ";_.push(O.default.createElement("td",{key:"summary-table-data-"+S,className:"properties-summary-row-data ",style:{width:g},onMouseMove:this._onMouseMove.bind(this)},O.default.createElement(y,{id:m.v4(),tip:C,mousePos:this.state.mousePos,showToolTipIfTruncated:!0},O.default.createElement("span",{id:"span_"+m.v4()},C))))}}else if(this.props.controller.isSummary(i)||c){var R=this._getSummaryDisplayValue(E,i);_.push(O.default.createElement("td",{key:"summary-table-row-data-"+b,className:"properties-summary-row-data "},O.default.createElement(y,{id:m.v4(),tip:R,mousePos:this.state.mousePos,showToolTipIfTruncated:!0},O.default.createElement("span",{id:"span_"+m.v4()},R))))}_.length>0&&d.push(O.default.createElement("tr",{key:"summary-table-row-"+b,className:"properties-summary-row"},_))}}else if(l&&(this.props.controller.isSummary(i)||c)){var A=this._getSummaryDisplayValue(l,i);d.push(O.default.createElement("tr",{key:"summary-row-"+a,className:"properties-summary-row"},O.default.createElement("td",{key:"summary-table-row-data-"+a,className:"properties-summary-rows-data"},A)))}if(d.length>0){var k=O.default.createElement("table",{role:"presentation",key:"summary-table-"+a,className:"properties-summary-table"},O.default.createElement("tbody",{key:"summary-body-"+a},d));if(d.length>10){var w=o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.LONG_TABLE_SUMMARY_PLACEHOLDER);k=O.default.createElement("div",{className:"properties-summary-table"},O.default.createElement("span",null,w))}e.push(O.default.createElement("div",{key:"summary-container-"+a,className:"properties-summary-values"},O.default.createElement("span",{key:"summary-text-"+a,className:"properties-summary-label"},s.summaryLabel),k))}}}catch(e){n.e(e)}finally{n.f()}return e}},{key:"_getSummaryDisplayValue",value:function(e,t){var r=e,n=this.props.controller.getControl(t);if(n.values&&n.valueLabels){var a=n.values.indexOf(e);a>-1&&n.valueLabels[a]&&(r=n.valueLabels[a])}return"object"===o.toType(r)&&(r=n.valueDef.propType===o.Type.STRUCTURE&&n.role===o.ParamRole.COLUMN?o.stringifyFieldValue(e,n):JSON.stringify(r)),r}},{key:"_getSummaryIconState",value:function(){var e=this,t=this.props.controller.getSummaryPanelControls(this.props.panel.id),r={},n=0,i=0;if(Array.isArray(t)&&t.forEach((function(t){var o=e.props.controller.getErrorMessage({name:t},!0);a.isEmpty_1(o)||(o.type===u.CONDITION_MESSAGE_TYPE.WARNING&&(i+=1),o.type===u.CONDITION_MESSAGE_TYPE.ERROR&&(n+=1)),a.isEmpty_1(o)||a.isEmpty_1(r)&&"error"===r.type||(r=o)})),!a.isEmpty_1(r)){var s="";return n>0&&0===i?s=o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.CONTROL_SUMMARY_ERROR,{errorMsgCount:n}):n>0&&i>0?s=o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.CONTROL_SUMMARY_ERROR_WARNING,{errorMsgCount:n,warningMsgCount:i}):0===n&&i>0&&(s=o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.CONTROL_SUMMARY_WARNING,{warningMsgCount:i})),O.default.createElement(y,{id:m.v4()+"summary-icon",tip:s,className:"properties-tooltips"},O.default.createElement(h.Icon,{type:r.type,className:"properties-summary-link-icon ".concat(r.type)}))}return null}},{key:"render",value:function(){var e=this._getSummaryIconState(),t=O.default.createElement("div",{className:"properties-summary-link-container"},O.default.createElement(l.Button,{className:"properties-summary-link-button",onClick:this.handleLinkClicked,size:"small",kind:"ghost",renderIcon:d.Add16},this.props.panel.label),e),r=o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.APPLYBUTTON_LABEL),n=o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.REJECTBUTTON_LABEL),a=this.state.showWideFlyout?O.default.createElement(dt,{cancelHandler:this.cancelWideFlyout,okHandler:this.hideWideFlyout,show:!0,applyLabel:r,rejectLabel:n,title:this.props.panel.label,light:this.props.controller.getLight(),okButtonEnabled:this.props.okButtonEnabled},O.default.createElement("div",null,this.props.children)):O.default.createElement("div",null),i=this.props.panel.className?this.props.panel.className:"",s=u.classNames("properties-summary-panel","properties-control-panel",{hide:this.props.panelState===u.STATES.HIDDEN},{"properties-control-nested-panel":this.props.panel.nestedPanel},i);return O.default.createElement("div",{className:s,disabled:this.props.panelState===u.STATES.DISABLED,"data-id":ht({name:this.props.panel.id})},a,t,this._getSummaryTables())}}]),i}(O.default.Component),It=c.connect((function(e,t){return{panelState:t.controller.getPanelState({name:t.panel.id}),okButtonEnabled:!t.controller.getWideFlyoutPrimaryButtonDisabled({name:t.panel.id})}}),null)(Tt);function Ct(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var Rt=function(r){t._inherits(n,r);var o=Ct(n);function n(){return e._classCallCheck(this,n),o.apply(this,arguments)}return e._createClass(n,[{key:"render",value:function(){var e=this.props.panel.className?this.props.panel.className:"",t=this.props.panelState===u.STATES.DISABLED;return O.default.createElement("div",{className:u.classNames("properties-twisty-panel",{hide:this.props.panelState===u.STATES.HIDDEN},{"properties-control-nested-panel":this.props.panel.nestedPanel},e),"data-id":ht({name:this.props.panel.id})},O.default.createElement(l.Accordion,{disabled:t},O.default.createElement(l.AccordionItem,{disabled:t,open:this.props.panel.open,title:this.props.panel.label},this.props.children)))}}]),n}(O.default.Component),At=c.connect((function(e,t){return{panelState:t.controller.getPanelState({name:t.panel.id})}}),null)(Rt);function kt(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var Ot=function(r){t._inherits(n,r);var o=kt(n);function n(r){var a;return e._classCallCheck(this,n),(a=o.call(this,r)).state={panel:null,title:null,hideHandler:null,subPanelVisible:!1},a.showSubDialog=a.showSubDialog.bind(t._assertThisInitialized(a)),a.hideSubDialog=a.hideSubDialog.bind(t._assertThisInitialized(a)),a}return e._createClass(n,[{key:"showSubDialog",value:function(e,t,r){this.props.controller.increaseVisibleSubPanelCounter(),this.setState({panel:t,title:e,hideHandler:r,subPanelVisible:!0})}},{key:"hideSubDialog",value:function(e){this.props.controller.decreaseVisibleSubPanelCounter(),this.state.hideHandler(e),this.setState({panel:null,title:null,hideHandler:null,subPanelVisible:!1})}},{key:"render",value:function(){var e=[];if(this.state.subPanelVisible&&!this.props.rightFlyout){var t=this.props.controller.isTearsheetContainer()?"properties-subpanel-modal-in-tearsheet":"";e=O.default.createElement(Te,{title:this.state.title,okHandler:this.hideSubDialog.bind(this,!0),cancelHandler:this.hideSubDialog.bind(this,!1),applyLabel:this.props.applyLabel,rejectLabel:this.props.rejectLabel,classNames:t},this.state.panel)}else this.props.rightFlyout&&this.state.subPanelVisible&&(e=O.default.createElement(dt,{cancelHandler:this.hideSubDialog.bind(this,!1),okHandler:this.hideSubDialog.bind(this,!0),show:!0,applyLabel:this.props.applyLabel,rejectLabel:this.props.rejectLabel,title:this.state.title,light:this.props.controller.getLight()},O.default.createElement("div",null,this.state.panel)));return O.default.createElement("div",null,e,this.props.children)}}]),n}(O.default.Component);function wt(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}Ot.defaultProps={rightFlyout:!1};var Nt=function(r){t._inherits(a,r);var n=wt(a);function a(r){var o;return e._classCallCheck(this,a),(o=n.call(this,r)).showSubPanel=o.showSubPanel.bind(t._assertThisInitialized(o)),o.onSubPanelHidden=o.onSubPanelHidden.bind(t._assertThisInitialized(o)),o}return e._createClass(a,[{key:"onSubPanelHidden",value:function(e){o.logger.info("onSubPanelHidden(): applyChanges="+e)}},{key:"showSubPanel",value:function(){this.subPanelInvoker.showSubDialog(this.props.title,this.props.panel,this.onSubPanelHidden)}},{key:"render",value:function(){var e=this,t=o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.APPLYBUTTON_LABEL),r=o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.REJECTBUTTON_LABEL),n=O.default.createElement(l.Button,{className:"properties-subpanel-button",type:"button",small:!0,kind:"secondary",onClick:this.showSubPanel},this.props.label||"");return O.default.createElement(Ot,{ref:function(t){return e.subPanelInvoker=t},rightFlyout:this.props.rightFlyout,applyLabel:t,rejectLabel:r,controller:this.props.controller},n)}}]),a}(O.default.Component);function Pt(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var Lt=function(r){t._inherits(n,r);var o=Pt(n);function n(t){var r;e._classCallCheck(this,n),r=o.call(this,t);var a="";return t.children.forEach((function(e,t){0===t?a="1fr":a+=" 1fr"})),r.style={gridTemplateColumns:a},r}return e._createClass(n,[{key:"render",value:function(){var e=this.props.panel.className?this.props.panel.className:"";return O.default.createElement("div",{className:u.classNames("properties-column-panel",{hide:this.props.panelState===u.STATES.HIDDEN},{"properties-control-nested-panel":this.props.panel.nestedPanel},e),disabled:this.props.panelState===u.STATES.DISABLED,"data-id":ht({name:this.props.panel.id}),style:this.style},this.props.children)}}]),n}(O.default.Component),Dt=c.connect((function(e,t){return{panelState:t.controller.getPanelState({name:t.panel.id})}}),null)(Lt);function Mt(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var xt=function(r){t._inherits(n,r);var o=Mt(n);function n(){return e._classCallCheck(this,n),o.apply(this,arguments)}return e._createClass(n,[{key:"render",value:function(){var e=this.props.panel.className?this.props.panel.className:"";return this.props.children.length>0?O.default.createElement("div",{className:u.classNames("properties-control-panel",{hide:this.props.panelState===u.STATES.HIDDEN},{"properties-control-nested-panel":this.props.panel.nestedPanel},{"tearsheet-container":this.props.controller.isTearsheetContainer()},e),disabled:this.props.panelState===u.STATES.DISABLED,"data-id":ht({name:this.props.panel.id})},this.props.children):null}}]),n}(O.default.Component),Bt=c.connect((function(e,t){return{panelState:t.controller.getPanelState({name:t.panel.id})}}),null)(xt);function Ft(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var Vt=function(r){t._inherits(n,r);var o=Ft(n);function n(t){var r;return e._classCallCheck(this,n),(r=o.call(this,t)).state={activeTabId:""},r}return e._createClass(n,[{key:"onClick",value:function(e){this.setState({activeTabId:e})}},{key:"render",value:function(){for(var e=[],t=0,r=0,o=this.props.className?this.props.className:"",n=0;n<this.props.tabs.length;n++){var a=this.props.tabs[n],i=this.props.controller.getPanelState({name:a.group});if(i!==u.STATES.HIDDEN){var s=this.props.genUIItem(n,a.content);this.state.activeTabId===a.group&&i!==u.STATES.DISABLED&&(t=r),e.push(O.default.createElement(l.Tab,{key:"subtabs.tab."+n,disabled:i===u.STATES.DISABLED,className:u.classNames("properties-subtab",{"properties-leftnav-subtab-item":this.props.leftnav}),tabIndex:r,label:a.text,title:a.text,onClick:this.onClick.bind(this,a.group),"data-id":ht({name:a.group})},s)),r++}}return O.default.createElement("div",{className:u.classNames("properties-sub-tab-container",{vertical:!this.props.rightFlyout},{"properties-control-nested-panel":this.props.nestedPanel},{"properties-leftnav-container":this.props.leftnav},o)},O.default.createElement(l.Tabs,{className:u.classNames("properties-subtabs",{"properties-leftnav-subtabs":this.props.leftnav}),selected:t,light:this.props.controller.getLight()},e))}}]),n}(O.default.Component);Vt.defaultProps={leftnav:!1};var Ut=Vt;function zt(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var Ht=function(r){t._inherits(i,r);var n=zt(i);function i(){return e._classCallCheck(this,i),n.apply(this,arguments)}return e._createClass(i,[{key:"render",value:function(){var e,t=this.props.panel.className?this.props.panel.className:"",r=this.props.panelState===u.STATES.HIDDEN,n=this.props.panelState===u.STATES.DISABLED,i=this.props.panel.label?O.default.createElement("div",{className:"panel-label"},this.props.panel.label):null;if(this.props.panel.description&&!a.isEmpty_1(this.props.panel.description.text)){var s=o.evaluateText(this.props.panel.description.text,this.props.controller);if("as_tooltip"===this.props.panel.description.placement){this.props.panel.description.link&&(this.props.panel.description.link.propertyId={name:this.props.panel.id});var l=O.default.createElement(y,{id:"tooltip-label-".concat(this.props.panel.id),tip:s,link:this.props.panel.description.link?this.props.panel.description.link:null,tooltipLinkHandler:this.props.controller.getHandlers().tooltipLinkHandler,direction:"bottom",disable:r||n,showToolTipOnClick:!0},O.default.createElement(h.Icon,{type:u.CARBON_ICONS.INFORMATION,className:"properties-control-description-icon-info"}));i=O.default.createElement("div",{className:u.classNames("properties-label-container")},i,l)}else e=O.default.createElement("div",{className:"panel-description"},s)}return O.default.createElement("div",{className:u.classNames("properties-text-panel",{hide:r},{"properties-control-nested-panel":this.props.panel.nestedPanel},t),disabled:n},i,e)}}]),i}(r.Component),jt=c.connect((function(e,t){return{panelState:t.controller.getPanelState({name:t.panel.id}),propertyValues:t.controller.getPropertyValues()}}),null)(Ht);function Gt(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var qt=function(r){t._inherits(i,r);var n=Gt(i);function i(){return e._classCallCheck(this,i),n.apply(this,arguments)}return e._createClass(i,[{key:"render",value:function(){var e,t=this.props.panel.className?this.props.panel.className:"",r=this.props.panelState===u.STATES.HIDDEN,n=this.props.panelState===u.STATES.DISABLED;if(this.props.panel.label){var i;if(this.props.panel.description&&!a.isEmpty_1(this.props.panel.description.text)){var s=o.evaluateText(this.props.panel.description.text,this.props.controller);this.props.panel.description.link&&(this.props.panel.description.link.propertyId={name:this.props.panel.id}),i=O.default.createElement(y,{id:"tooltip-label-".concat(this.props.panel.id),tip:s,link:this.props.panel.description.link?this.props.panel.description.link:null,tooltipLinkHandler:this.props.controller.getHandlers().tooltipLinkHandler,direction:"bottom",disable:r||n,showToolTipOnClick:!0},O.default.createElement(h.Icon,{type:u.CARBON_ICONS.INFORMATION,className:"properties-control-description-icon-info"}))}e=O.default.createElement("div",{className:u.classNames("properties-label-container")},O.default.createElement("label",{className:"properties-control-label"},this.props.panel.label),i)}return O.default.createElement("div",{className:u.classNames("properties-action-panel",{hide:r},{"properties-control-nested-panel":this.props.panel.nestedPanel},t),"data-id":ht({name:this.props.panel.id}),disabled:n},e,this.props.children)}}]),i}(r.Component),Yt=c.connect((function(e,t){return{panelState:t.controller.getPanelState({name:t.panel.id})}}),null)(qt);function Kt(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var Wt=function(r){t._inherits(n,r);var o=Kt(n);function n(r){var a;return e._classCallCheck(this,n),(a=o.call(this,r)).state={},a.applyAction=a.applyAction.bind(t._assertThisInitialized(a)),a.uuid=m.v4(),a}return e._createClass(n,[{key:"getActionButtonKind",value:function(){if(!a.has_1(this.props,"action.button.kind"))return u.CARBON_BUTTON_KIND.TERTIARY;switch(this.props.action.button.kind){case u.CARBON_BUTTON_KIND.PRIMARY:return u.CARBON_BUTTON_KIND.PRIMARY;case u.CARBON_BUTTON_KIND.SECONDARY:return u.CARBON_BUTTON_KIND.SECONDARY;case u.CARBON_BUTTON_KIND.TERTIARY:return u.CARBON_BUTTON_KIND.TERTIARY;case u.CARBON_BUTTON_KIND.GHOST:return u.CARBON_BUTTON_KIND.GHOST;case u.CARBON_BUTTON_KIND.DANGER:return u.CARBON_BUTTON_KIND.DANGER;case u.CARBON_BUTTON_KIND.DANGER_TERTIARY:return u.CARBON_BUTTON_KIND.DANGER_TERTIARY;case u.CARBON_BUTTON_KIND.DANGER_GHOST:return u.CARBON_BUTTON_KIND.DANGER_GHOST;default:return u.CARBON_BUTTON_KIND.TERTIARY}}},{key:"getActionButtonSize",value:function(){if(!a.has_1(this.props,"action.button.size"))return u.CARBON_BUTTON_SIZE.SMALL;switch(this.props.action.button.size){case u.CARBON_BUTTON_SIZE.SMALL:return u.CARBON_BUTTON_SIZE.SMALL;case u.CARBON_BUTTON_SIZE.MEDIUM:return u.CARBON_BUTTON_SIZE.DEFAULT;case u.CARBON_BUTTON_SIZE.LARGE:return u.CARBON_BUTTON_SIZE.LARGE;case u.CARBON_BUTTON_SIZE.EXTRA_LARGE:return u.CARBON_BUTTON_SIZE.EXTRA_LARGE;default:return u.CARBON_BUTTON_SIZE.SMALL}}},{key:"applyAction",value:function(){var e=this.props.controller.getHandlers().actionHandler;"function"==typeof e&&e(this.props.action.name,this.props.controller.getAppData(),this.props.action.data)}},{key:"render",value:function(){var e=u.classNames("properties-action-button",{hide:this.props.state===u.STATES.HIDDEN}),t=this.props.state===u.STATES.DISABLED,r=this.getActionButtonKind(),o=this.getActionButtonSize(),n=O.default.createElement(l.Button,{type:"button",size:o,kind:r,onClick:this.applyAction,disabled:t},this.props.action.label.text),a=n;if(this.props.action.description){var i=this.uuid+"-tooltip-action-"+this.props.action.name,s=O.default.createElement("div",{className:"properties-tooltips"},this.props.action.description.text);a=O.default.createElement(y,{id:i,tip:s,direction:"bottom",className:"properties-tooltips",disable:t},n)}return O.default.createElement("div",{className:e,"data-id":this.props.action.name},a)}}]),n}(O.default.Component),Xt=c.connect((function(e,t){return{state:t.controller.getActionState(t.controller.convertPropertyId(t.action.name))}}),null)(Wt);function $t(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var Jt=function(r){t._inherits(n,r);var o=$t(n);function n(r){var a;return e._classCallCheck(this,n),(a=o.call(this,r)).state={},a.applyAction=a.applyAction.bind(t._assertThisInitialized(a)),a.uuid=m.v4(),a}return e._createClass(n,[{key:"applyAction",value:function(){if(this.props.state!==u.STATES.DISABLED){var e=this.props.controller.getHandlers().actionHandler;"function"==typeof e&&e(this.props.action.name,this.props.controller.getAppData(),this.props.action.data)}}},{key:"render",value:function(){var e={},t={};this.props.action.image.size&&(e=this.props.action.image.size.height?{height:this.props.action.image.size.height}:{},t=this.props.action.image.size.width?{width:this.props.action.image.size.width}:{});var r=this.props.state===u.STATES.DISABLED,o=u.classNames("properties-action-image",{left:"left"===this.props.action.image.placement},{right:"right"===this.props.action.image.placement},{hide:this.props.state===u.STATES.HIDDEN},{disabled:r}),n=O.default.createElement("div",{"data-id":this.props.action.name},O.default.createElement("img",u._extends({src:this.props.action.image.url,onClick:this.applyAction},e,t))),a=n;if(this.props.action.description){var i=this.uuid+"-tooltip-action-"+this.props.action.name,s=O.default.createElement("div",{className:"properties-tooltips"},this.props.action.description.text),l=this.props.action.image.tooltip_direction&&["left","right","top","bottom"].includes(this.props.action.image.tooltip_direction.toLowerCase())?this.props.action.image.tooltip_direction.toLowerCase():"bottom";a=O.default.createElement(y,{id:i,tip:s,direction:l,className:"properties-tooltips",disable:r},n)}return O.default.createElement("div",{className:o},a)}}]),n}(O.default.Component),Zt=c.connect((function(e,t){return{state:t.controller.getActionState(t.controller.convertPropertyId(t.action.name))}}),null)(Jt),Qt=function(){function t(r){e._classCallCheck(this,t),this.controller=r}return e._createClass(t,[{key:"generateAction",value:function(e,t){if(t){if("button"===t.actionType)return O.default.createElement(Xt,{key:"action."+e,action:t,controller:this.controller});if("image"===t.actionType)return O.default.createElement(Zt,{key:"action."+e,action:t,controller:this.controller})}return null}}]),t}();function er(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return tr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tr(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function tr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function rr(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var or="alertMsgs",nr=function(r){t._inherits(s,r);var i=rr(s);function s(r){var o;return e._classCallCheck(this,s),(o=i.call(this,r)).state={showFieldPicker:!1},o.genPanel=o.genPanel.bind(t._assertThisInitialized(o)),o.genUIContent=o.genUIContent.bind(t._assertThisInitialized(o)),o.genUIItem=o.genUIItem.bind(t._assertThisInitialized(o)),o._getGroupedMessages=o._getGroupedMessages.bind(t._assertThisInitialized(o)),o.closeFieldPicker=o.closeFieldPicker.bind(t._assertThisInitialized(o)),o.openFieldPicker=o.openFieldPicker.bind(t._assertThisInitialized(o)),o.generateSharedControlNames=o.generateSharedControlNames.bind(t._assertThisInitialized(o)),o.messages=o._getGroupedMessages(r.messages),o.ControlFactory=r.controller.getControlFactory(),o.ControlFactory.setFunctions(o.openFieldPicker,o.genUIItem),o.ControlFactory.setRightFlyout(r.rightFlyout),o.actionFactory=new Qt(o.props.controller),o.FIRST_TEARSHEET_ID=null,o.TEARSHEETS={},o.visibleTearsheet=null,o}return e._createClass(s,[{key:"shouldComponentUpdate",value:function(e,t){return this.props.controller.isSummaryPanelShowing()||this.props.controller.isSubPanelsShowing()||(this.messages=this._getGroupedMessages(e.messages)),!0}},{key:"_getMessageCountForCategory",value:function(e){var t=this;if(e.group===or)return" ("+this.messages.length+")";var r=0;return this.messages.forEach((function(o){var n=t.props.controller.getControl({name:o.id_ref});n&&n.parentCategoryId===e.group&&r++})),r>0?" ("+r+")":null}},{key:"_getGroupedMessages",value:function(e){return a.isEmpty_1(e)?[]:o.sortBy_1(e,["type"])}},{key:"_getTabId",value:function(e){return e.group}},{key:"_showCategoryPanel",value:function(e){var t=e;this.props.activeTab===e&&(t=""),this.props.setActiveTab(t)}},{key:"_handleMessageClick",value:function(e,t){var r=this.props.controller.getControl(e);this.props.setActiveTab(r.parentCategoryId)}},{key:"_modalTabsOnClick",value:function(e){this.props.setActiveTab(e)}},{key:"genPrimaryTabs",value:function(e,t,r,n){for(var a=[],i=!1,s=0,p=t.filter((function(e){return e.content.itemType!==o.ItemType.TEARSHEET})),c=t.filter((function(e){return e.content.itemType===o.ItemType.TEARSHEET})).concat(p),d=0;d<c.length;d++){var f=c[d];if(this.props.controller.getPanelState({name:f.group})!==u.STATES.HIDDEN){0===d&&f.group===or&&(i=!0);var m=this.genUIItem(this._getContainerIndex(i,d),f.content,r,n),y=null;if(this.props.additionalComponents&&(y=this.props.additionalComponents[f.group]),1===c.length&&1===p.length)return O.default.createElement("div",{key:"cat."+e,className:"properties-single-category"},m,y);if(this.props.rightFlyout){var v=O.default.createElement(h.Icon,{type:u.CARBON_ICONS.CHEVRONARROWS.DOWN,className:"properties-category-caret-down"}),g=!1;this.props.activeTab===f.group&&(v=O.default.createElement(h.Icon,{type:u.CARBON_ICONS.CHEVRONARROWS.UP,className:"properties-category-caret-up"}),g=!0),f.content.itemType!==o.ItemType.TEARSHEET&&1===p.length?a.push(O.default.createElement("div",{key:"cat."+e,className:"properties-single-category"},m,y)):a.push(O.default.createElement("div",{key:this._getContainerIndex(i,d)+"-"+e,className:u.classNames("properties-category-container",{"properties-hidden-container":f.content.itemType===o.ItemType.TEARSHEET})},O.default.createElement("button",{type:"button",onClick:this._showCategoryPanel.bind(this,f.group),className:u.classNames("properties-category-title",{"properties-light-enabled":this.props.controller.getLight()})},f.text,this._getMessageCountForCategory(f),v),O.default.createElement("div",{className:u.classNames("properties-category-content",{show:g})},m,y)))}else this.props.activeTab===f.group&&(s=d),a.push(O.default.createElement(l.Tab,{key:this._getContainerIndex(i,d)+"-"+e,tabIndex:d,label:f.text,title:f.text,className:u.classNames({"properties-hidden-container":f.content.itemType===o.ItemType.TEARSHEET}),onClick:this._modalTabsOnClick.bind(this,f.group)},m,y))}}return this.props.rightFlyout?O.default.createElement("div",{key:"cat."+e,className:"properties-categories"},a):O.default.createElement(l.Tabs,{key:"tab."+e,className:"properties-primaryTabs",selected:s,light:this.props.controller.getLight(),tabContentClassName:u.classNames("properties-primary-tab-panel",{"tearsheet-container":this.props.controller.isTearsheetContainer()})},a)}},{key:"_getContainerIndex",value:function(e,t){return e&&0===t?"alerts":e?t-1:t}},{key:"genPanelSelector",value:function(e,t,r,o,n,a,i){var s=this.generateAdditionalPanels(t,e,o,n,!1,i);return O.default.createElement(ut,{key:"selectorPanel"+e,panels:s,dependsOn:r,controller:this.props.controller})}},{key:"generateAdditionalPanels",value:function(e,t,r,o,n,a){for(var i={},s=0;s<e.length;s++){var l=e[s],p="properties-control-panel";l.content&&"textPanel"===l.content.itemType&&(p=""),n&&(p+=" properties-control-nested-panel"),i[l.group]=O.default.createElement("div",{className:u.classNames(p,a),key:l.group+t},this.genUIItem(s,l.content,r,o))}return i}},{key:"genUIContent",value:function(e,t,r){for(var o=[],n=0;n<e.length;n++)o.push(this.genUIItem(n,e[n],t,r));return o}},{key:"genUIItem",value:function(e,t,r,a){var i="",s=null,p="";switch(t.itemType){case"control":t.additionalItems&&t.additionalItems.length>0&&(t.control.additionalItems=t.additionalItems,t.control.optionalPanels=this.generateAdditionalPanels(t.additionalItems,e,null,a,!0));var c={name:t.control.name};if(r){var d=n.cloneDeep_1(r);return this.props.controller.updateLastChildPropertyId(d,{col:a(t.control.name)}),this.ControlFactory.createControlItem(t.control,d)}return this.ControlFactory.createControlItem(t.control,c);case"additionalLink":var f=this.genPanel(e,t.panel,r,a);return O.default.createElement(Nt,{key:"sub-panel-button."+e,label:t.text,title:t.secondaryText,panel:f,controller:this.props.controller,rightFlyout:this.props.rightFlyout});case"staticText":return i=u.classNames("properties-static-text",t.textType),s="info"===t.textType?O.default.createElement("div",null,O.default.createElement(h.Icon,{type:u.CARBON_ICONS.INFORMATION,className:"properties-static-text-icon-info"})):null,p=O.default.createElement("div",{className:i},o.evaluateText(t.text,this.props.controller)),O.default.createElement("div",{key:"static-text."+e,className:"properties-static-text-container"},s,p);case"linkText":return i=u.classNames("properties-link-text-container",t.textType),"warning"===t.textType?s=O.default.createElement(h.Icon,{type:u.CONDITION_MESSAGE_TYPE.WARNING}):"error"===t.textType&&(s=O.default.createElement(h.Icon,{type:u.CONDITION_MESSAGE_TYPE.ERROR})),p=O.default.createElement(l.Link,{className:"properties-link-text",onClick:this._handleMessageClick.bind(this,t.controlId)},o.evaluateText(t.text,this.props.controller)),O.default.createElement("div",{key:"link-text."+e,className:i},s,p);case"hSeparator":return O.default.createElement("hr",{key:"h-separator."+e,className:"properties-h-separator"});case"panel":case"tearsheet":case"checkboxSelector":return this.genPanel(e,t.panel,r,a);case"subTabs":return O.default.createElement(Ut,{key:"subtabs."+e,tabs:t.tabs,className:t.className,controller:this.props.controller,rightFlyout:this.props.rightFlyout,genUIItem:this.genUIItem,nestedPanel:t.nestedPanel,leftnav:this.props.controller.isTearsheetContainer()});case"primaryTabs":return this.genPrimaryTabs(e,t.tabs,r,a);case"panelSelector":return this.genPanelSelector(e,t.tabs,t.dependsOn,r,a,t.id,t.className);case"customPanel":return this.generateCustomPanel(e,t.panel);case"action":return this.actionFactory.generateAction(e,t.action);case"textPanel":return t.panel?O.default.createElement(jt,{key:"text-panel-"+e,panel:t.panel,controller:this.props.controller}):O.default.createElement("div",{key:"unknown."+e},"Unknown: ",t.itemType);default:return O.default.createElement("div",{key:"unknown."+e},"Unknown: ",t.itemType)}}},{key:"generateCustomPanel",value:function(e,t){if(this.props.customPanels){var r,n=er(this.props.customPanels);try{for(n.s();!(r=n.n()).done;){var i=r.value;if(i.id()===t.id)try{return O.default.createElement("div",{className:u.classNames("properties-custom-panel",{"properties-control-nested-panel":a.get_1(t,"nestedPanel",!1)}),key:"custom."+e},new i(t.parameters,this.props.controller,t.data).renderPanel())}catch(e){return o.logger.warn("Error thrown creating custom panel: "+e),null}}}catch(e){n.e(e)}finally{n.f()}}return O.default.createElement("div",{key:"custom."+e},"Panel Not Found: ",t.id)}},{key:"generateSharedControlNames",value:function(e){var t,r=er(this.props.controller.getSharedCtrlInfo());try{for(r.s();!(t=r.n()).done;){var o=t.value;if(void 0!==o.id&&o.id===e.id)return}}catch(e){r.e(e)}finally{r.f()}var n,a=[],i=er(e.uiItems);try{for(i.s();!(n=i.n()).done;){var s=n.value;if(s.control&&s.control.name){var l=s.control.name;a.push({controlName:l})}}}catch(e){i.e(e)}finally{i.f()}this.props.controller.addSharedControls(e.id,a)}},{key:"genPanel",value:function(e,t,r,o){var n=this,a=this.genUIContent(t.uiItems,r,o),i="panel."+e;switch(t.panelType){case"columnSelection":return this.generateSharedControlNames(t),a=this.genUIContent(t.uiItems,r,o),O.default.createElement(Bt,{key:i,controller:this.props.controller,panel:t},a);case"summary":return this.props.rightFlyout?O.default.createElement(It,{key:"summary-panel-"+i,controller:this.props.controller,panel:t},a):a;case"actionPanel":return O.default.createElement(Yt,{key:"action-panel-"+e,controller:this.props.controller,panel:t},a);case"twisty":return O.default.createElement(At,{key:i,controller:this.props.controller,panel:t},a);case"tearsheet":if(this.TEARSHEETS[t.id]={panel:t,title:t.label,description:t.description?t.description.text:null,content:a},null!==this.props.controller.getActiveTearsheet()?this.visibleTearsheet=this.TEARSHEETS[this.props.controller.getActiveTearsheet()]:this.visibleTearsheet=null,!this.FIRST_TEARSHEET_ID||this.FIRST_TEARSHEET_ID===t.id){this.FIRST_TEARSHEET_ID=t.id;return O.default.createElement(Oe,{open:null!==this.props.controller.getActiveTearsheet(),onCloseCallback:function(){n.props.controller.clearActiveTearsheet()},key:t.id,tearsheet:this.visibleTearsheet})}return null;case"column":return O.default.createElement(Dt,{key:i,controller:this.props.controller,panel:t},a);default:return O.default.createElement(Bt,{key:i,controller:this.props.controller,panel:t},a)}}},{key:"closeFieldPicker",value:function(e,t){this.closeFieldPickerCallback&&(this.closeFieldPickerCallback(e,t),this.closeFieldPickerCallback=null),this.props.showPropertiesButtons(!0),this.fieldPickerPropertyId=null,this.setState({showFieldPicker:!1})}},{key:"openFieldPicker",value:function(e,t){this.props.showPropertiesButtons(!1),this.fieldPickerPropertyId=e,this.closeFieldPickerCallback=t,this.setState({showFieldPicker:!0})}},{key:"fieldPicker",value:function(e){if(this.fieldPickerPropertyId&&this.fieldPickerPropertyId.name){var t,r=this.props.controller.getPropertyValue(this.fieldPickerPropertyId),n=this.props.controller.getFilteredDatasetMetadata(this.fieldPickerPropertyId),a=this.props.controller.getControl(this.fieldPickerPropertyId),i=o.getTableFieldIndex(a),s=a.subControls;-1!==i&&(t=s?s[i].dmImage:a.dmImage);var l=o.getFieldsFromControlValues(a,r);return O.default.createElement("div",{className:"properties-fp-table"},O.default.createElement(o.FieldPicker,{key:"field-picker-control",controller:this.props.controller,closeFieldPicker:this.closeFieldPicker,currentFields:l,fields:n,title:e,rightFlyout:this.props.rightFlyout,dmIcon:t}))}return O.default.createElement("div",null)}},{key:"genAlertsTab",value:function(e){var t=e.map((function(e){return{itemType:"linkText",text:e.text,textType:e.type,controlId:{name:e.id_ref}}}));return{text:o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.ALERTS_TAB_TITLE),group:or,content:{itemType:"panel",panel:{id:"alerts-panel",panelType:"general",uiItems:t}}}}},{key:"render",value:function(){var e=this.props.controller.getUiItems();!a.isEmpty_1(this.messages)&&"primaryTabs"===e[0].itemType&&e[0].tabs&&e[0].tabs.length>1&&(e=n.cloneDeep_1(e))[0].tabs.unshift(this.genAlertsTab(this.messages));var t,r=this.genUIContent(e),i=O.default.createElement("div",null),s=this.props.controller.getForm(),l=o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.FIELDPICKER_SAVEBUTTON_LABEL)+" "+s.label;return this.state.showFieldPicker&&(this.props.rightFlyout?i=O.default.createElement(dt,{showPropertiesButtons:!1,show:!0,title:l,light:this.props.controller.getLight()},this.fieldPicker(l)):this.props.controller.isTearsheetContainer()?t=O.default.createElement(Oe,{open:!0,stacked:!0,tearsheet:{title:l,content:this.fieldPicker()}}):r=this.fieldPicker(l)),O.default.createElement("div",{className:u.classNames("properties-editor-form",{"tearsheet-container":this.props.controller.isTearsheetContainer()},{"field-picker":this.state.showFieldPicker})},r,i,t)}}]),s}(O.default.Component),ar=c.connect((function(e,t){return{activeTab:e.componentMetadataReducer.activeTab,messages:t.controller.getErrorMessages(!0,!0,!0)}}),(function(e,t){return{setActiveTab:function(t){e(it(t))}}}))(nr),ir=a._baseGet;var sr=function(e){return function(t){return null==e?void 0:ir(e,t)}},lr=function(){function t(r){e._classCallCheck(this,t),this.resources=r}return e._createClass(t,[{key:"l10n",value:function(e,t){if(this.resources){var r=sr(this.resources)(e);if(r||""===r)return r}return t||e}},{key:"l10nResource",value:function(e){var t;return e&&(e.resource_key?(t=this.l10n(e.resource_key))&&t!==e.resource_key||!e.default||(t=e.default):e.default&&(t=e.default)),t}},{key:"l10nLabel",value:function(e,t){return this.l10nResource(e.label)?this.l10nResource(e.label):this.l10n(t+".label",t)}},{key:"l10nDesc",value:function(e,t){return this.l10nResource(e.description)?this.l10nResource(e.description):this.l10n(t+".desc",t)}},{key:"l10nValueLabel",value:function(e,t){var r=e+"."+t+".label";return this.l10n(r,t)}},{key:"l10nValueDesc",value:function(e,t){var r=e+"."+t+".desc",o=this.l10n(r,t);return o!==t?o:null}}]),t}(),ur=function(){function t(){e._classCallCheck(this,t)}return e._createClass(t,null,[{key:"make",value:function(e){var r;return e&&((r=new t).default=e.default,r.resource_key=e.resource_key,e.placement&&(r.placement=e.placement),e.type&&(r.type=e.type),e.link&&(r.link=e.link)),r}}]),t}();function pr(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return cr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return cr(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function cr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}var dr=function(){function t(r,o,n,a,i,s,l,u,p,c,d,f,h){e._classCallCheck(this,t),this.name=r,this.parameters=o,this.actions=n,this.type=a,this.label=ur.make(i),this.dependsOn=s,this.insertPanels=l,this.nestedPanel=u,this.subGroups=p,this.description=ur.make(c),this.data=d,this.className=f,this.open=h}return e._createClass(t,[{key:"parameterNames",value:function(){return this.parameters}},{key:"actionIds",value:function(){return this.actions}},{key:"groupType",value:function(){return this.type?this.type:o.GroupType.CONTROLS}}],[{key:"makeGroup",value:function(e){if(e){var r;if(a.has_1(e,"group_info")){r=[];var o,n=pr(e.group_info);try{for(n.s();!(o=n.n()).done;){var i=o.value,s=t.makeGroup(i);null!==s&&r.push(s)}}catch(e){n.e(e)}finally{n.f()}}return new t(sr(e)("id"),sr(e)("parameter_refs"),sr(e)("action_refs"),sr(e)("type"),sr(e)("label"),sr(e)("depends_on_ref"),sr(e)("insert_panels"),sr(e)("nested_panel"),r,sr(e)("description"),sr(e)("data"),sr(e)("class_name"),sr(e)("open"))}return null}}]),t}(),fr=function(){function t(r){e._classCallCheck(this,t),this.groups=r}return e._createClass(t,null,[{key:"makeGroupMetadata",value:function(e,r){var n=[];if(e){var a,i=pr(e);try{for(i.s();!(a=i.n()).done;){var s=a.value,l=dr.makeGroup(s);null!==l&&n.push(l)}}catch(e){i.e(e)}finally{i.f()}}else n.push(new dr(m.v4(),r,null,o.GroupType.CONTROLS));return new t(n)}}]),t}();function hr(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return mr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mr(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function mr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}var yr=e._createClass((function t(r,o,n,a,i,s,l){e._classCallCheck(this,t),this.name=r,this.label=o,this.description=n,this.actionType=a,this.data=i,this.image=s,this.button=l})),vr=function(){function t(){e._classCallCheck(this,t)}return e._createClass(t,null,[{key:"makeActionDef",value:function(e){if(e){var r=new t;return r.id=e.id,r.label=ur.make(e.label),r.description=ur.make(e.description),r.control=e.control,r.data=e.data,r.image=e.image,r.button=e.button,r}return null}}]),t}(),gr=function(){function t(r){e._classCallCheck(this,t),this.actionDefs=r}return e._createClass(t,[{key:"getAction",value:function(e){var t;return this.actionDefs.forEach((function(r){r.id===e&&(t=r)})),t}}],[{key:"makeActionMetadata",value:function(e){if(e){var r,o=[],n=hr(e);try{for(n.s();!(r=n.n()).done;){var a=r.value,i=vr.makeActionDef(a);i&&o.push(i)}}catch(e){n.e(e)}finally{n.f()}return new t(o)}return null}}]),t}();function br(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Er(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Er(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function Er(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}var _r=function(){function t(r){e._classCallCheck(this,t),r.id&&(this.name=r.id),r.label&&(this.label=ur.make(r.label)),r.description&&(this.description=ur.make(r.description)),r.type&&(this.type=r.type),r.role&&(this.role=r.role),r.valueRestriction&&(this.valueRestriction=r.valueRestriction),null!==r.defaultValue&&"undefined"!==o.toType(r.defaultValue)?r.defaultValue.parameter_ref?(this.defaultValue={},this.defaultValue.parameterRef=r.defaultValue.parameter_ref):this.defaultValue=r.defaultValue:void 0===r.defaultValue&&(this.isList()||this.isMapValue())&&(this.defaultValue=[]),"boolean"==typeof r.labelVisible&&(this.labelVisible=r.labelVisible),r.control&&(this.control=r.control),r.orientation&&(this.orientation=r.orientation),r.width&&(this.width=r.width),r.charLimit&&(this.charLimit=r.charLimit),r.placeHolderText&&(this.placeHolderText=ur.make(r.placeHolderText)),r.separator&&(this.separator=r.separator),r.resource_key&&(this.resource_key=r.resource_key),"boolean"===o.toType(r.visible)?this.visible=r.visible:this.visible=!0,r.valueIcons&&(this.valueIcons=r.valueIcons),"boolean"===o.toType(r.sortable)&&(this.sortable=r.sortable),"boolean"===o.toType(r.filterable)&&(this.filterable=r.filterable),"boolean"===o.toType(r.resizable)&&(this.resizable=r.resizable),r.editStyle&&(this.editStyle=r.editStyle),"boolean"===o.toType(r.required)&&(this.required=r.required),r.numberGenerator&&(r.numberGenerator.label=ur.make(r.numberGenerator.label),this.numberGenerator=r.numberGenerator),r.isKey&&(this.isKey=r.isKey),r.dmDefault&&(this.dmDefault=r.dmDefault),r.dmImage&&(this.dmImage=r.dmImage),r.language&&(this.language=r.language),r.enableMaximize&&(this.enableMaximize=r.enableMaximize),"boolean"===o.toType(r.summary)&&(this.summary=r.summary),r.increment&&(this.increment=r.increment),r.textAfter&&(this.textAfter=ur.make(r.textAfter)),r.textBefore&&(this.textBefore=ur.make(r.textBefore)),"boolean"===o.toType(r.moveableRows)&&(this.moveableRows=r.moveableRows),r.generatedValues&&(this.generatedValues=r.generatedValues),r.dateFormat&&(this.dateFormat=r.dateFormat),r.timeFormat&&(this.timeFormat=r.timeFormat),r.customControlId&&(this.customControlId=r.customControlId),r.data&&(this.data=r.data),r.rows&&(this.rows=r.rows),r.displayChars&&(this.displayChars=r.displayChars),r.uionly&&(this.uionly=r.uionly),r.actionRef&&(this.actionRef=r.actionRef),"boolean"===o.toType(r.customValueAllowed)&&(this.customValueAllowed=r.customValueAllowed),r.className&&(this.className=r.className),r.showRequiredLabel&&(this.showRequiredLabel=r.showRequiredLabel)}return e._createClass(t,[{key:"isList",value:function(){return!!this.type&&this.type.startsWith("array[")}},{key:"isMapValue",value:function(){return!!this.type&&this.type.startsWith("map[")}},{key:"isSubPanelEdit",value:function(){return this.editStyle===o.EditStyle.SUBPANEL}},{key:"isCompoundField",value:function(){return!(!this.role||!this.type)&&((this.type===o.Type.OBJECT||this.baseType()===o.Type.OBJECT)&&this.role===o.ParamRole.COLUMN)}},{key:"propType",value:function(){var e;for(var t in o.Type)this.baseType()===o.Type[t]&&(e=o.Type[t]);return e||(e=o.Type.STRUCTURE),e}},{key:"getRole",value:function(){return this.role?this.role:this.getValidValues()?o.ParamRole.ENUM:o.ParamRole.UNSPECIFIED}},{key:"baseType",value:function(){var e=this.type;return this.isList()?e.substring(6,this.type.length-1):this.isMapValue()?e.substring(e.indexOf(",")+1,this.type.length-1).trim():this.valueRestriction&&!this.type?o.Type.STRING:e}},{key:"getValidValues",value:function(){return this.valueRestriction?this.valueRestriction:this.type===o.Type.BOOLEAN?[!0,!1]:void 0}},{key:"getValidValueCount",value:function(){return this.getValidValues()?this.getValidValues().length:0}},{key:"getAdditionalText",value:function(e){return e.l10nResource(this.placeHolderText)}},{key:"getTextAfter",value:function(e){return e.l10nResource(this.textAfter)}},{key:"getTextAfterType",value:function(){return this.textAfter?this.textAfter.type:null}},{key:"getTextBefore",value:function(e){return e.l10nResource(this.textBefore)}},{key:"getTextBeforeType",value:function(){return this.textBefore?this.textBefore.type:null}},{key:"getControl",value:function(e){return this.control?this.control:e}},{key:"columns",value:function(e){return this.width?this.width:e}},{key:"separatorAfter",value:function(){return this.separator===o.Separator.AFTER}},{key:"separatorBefore",value:function(){return this.separator===o.Separator.BEFORE}}],[{key:"makeParameterDef",value:function(e,r,o){return e?new t({id:sr(e)("id"),enableMaximize:sr(r)("enable_maximize"),label:sr(r)("label"),description:sr(r)("description"),type:sr(e)("type"),role:sr(e)("role"),valueRestriction:sr(e)("enum"),defaultValue:sr(e)("default"),labelVisible:sr(r)("label_visible"),control:sr(r)("control"),orientation:sr(r)("orientation"),width:sr(r)("width"),charLimit:sr(r)("char_limit"),placeHolderText:sr(r)("place_holder_text"),separator:sr(r)("separator"),resource_key:sr(r)("resource_key"),visible:sr(r)("visible"),valueIcons:sr(r)("value_icons"),sortable:sr(r)("sortable"),filterable:sr(r)("filterable"),resizable:sr(r)("resizable"),editStyle:sr(r)("edit_style"),required:sr(e)("required"),numberGenerator:sr(r)("number_generator"),isKey:o,dmDefault:sr(r)("dm_default"),dmImage:sr(r)("dm_image"),language:sr(r)("language"),summary:sr(r)("summary"),increment:sr(r)("increment"),textAfter:sr(r)("text_after"),textBefore:sr(r)("text_before"),moveableRows:sr(r)("moveable_rows"),generatedValues:sr(r)("generated_values"),dateFormat:sr(r)("date_format"),timeFormat:sr(r)("time_format"),customControlId:sr(r)("custom_control_id"),data:sr(r)("data"),rows:sr(r)("rows"),displayChars:sr(r)("display_chars"),uionly:sr(e)("uionly"),actionRef:sr(r)("action_ref"),customValueAllowed:sr(r)("custom_value_allowed"),className:sr(r)("class_name"),showRequiredLabel:sr(e)("showRequiredLabel")}):null}}]),t}();function Sr(e,t){if(t){var r,o=br(t);try{for(o.s();!(r=o.n()).done;){var n=r.value;if(e===n.parameter_ref)return n}}catch(e){o.e(e)}finally{o.f()}}return null}var Tr=function(){function t(r){e._classCallCheck(this,t),this.paramDefs=r}return e._createClass(t,[{key:"getParameter",value:function(e){var t;return this.paramDefs.forEach((function(r){r.name===e&&(t=r)})),t}},{key:"getParameters",value:function(){return this.paramDefs.map((function(e){return e.name}))}}],[{key:"makeParameterMetadata",value:function(e,r,o){var n=[];if(e){var a=e.filter((function(e){return!0===e.required})),i=e.length/2;e.forEach((function(e){a.length<=i?e.showRequiredLabel=!0:e.showRequiredLabel=!1}))}if(Array.isArray(e)){var s,l=br(e);try{for(l.s();!(s=l.n()).done;){var u=s.value,p=_r.makeParameterDef(u,Sr(u.id,r));p&&n.push(p)}}catch(e){l.e(e)}finally{l.f()}}if(Array.isArray(o)){var c,d=br(o);try{for(d.s();!(c=d.n()).done;){var f=c.value,h=_r.makeParameterDef(f,Sr(f.id,r));h&&(h.uionly=!0,n.push(h))}}catch(e){d.e(e)}finally{d.f()}}return new t(n)}}]),t}();function Ir(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Cr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Cr(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function Cr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}var Rr=e._createClass((function t(r,o,n,a,i,s,l){e._classCallCheck(this,t),this.id=r,this.label=o,this.description=n,this.icon=a,this.carbonIcon=i,this.enabled=s,this.divider=l})),Ar=function(){function t(){e._classCallCheck(this,t)}return e._createClass(t,null,[{key:"makeButtonDef",value:function(e){if(e){var r=new t;return r.id=e.id,r.label=ur.make(e.label),r.description=ur.make(e.description),r.icon=e.icon,r.carbonIcon=e.carbon_icon,r.enabled=e.enabled,r.divider=e.divider,r}return null}}]),t}(),kr=function(){function t(r){e._classCallCheck(this,t),this.buttonDefs=r}return e._createClass(t,[{key:"getButton",value:function(e){var t;return this.buttonDefs.forEach((function(r){r.id===e&&(t=r)})),t}}],[{key:"makeButtonMetadata",value:function(e){if(e){var r,o=[],n=Ir(e);try{for(n.s();!(r=n.n()).done;){var a=r.value,i=Ar.makeButtonDef(a);i&&o.push(i)}}catch(e){n.e(e)}finally{n.f()}return new t(o)}return null}}]),t}();function Or(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return wr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wr(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function wr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}var Nr=function(){function t(r,o,n,a,i,s,l,u,p,c,d,f){e._classCallCheck(this,t),this.name=r,this.keyDefinition=o,this.parameterMetadata=n,this.moveableRows=a,this.label=ur.make(i),this.rowSelection=s,this.buttons=d,this.addRemoveRows="boolean"!=typeof l||l,this.header="boolean"!=typeof u||u,"boolean"==typeof p&&(this.includeAllFields=p),Array.isArray(c)&&(this.layout=c),this.type=void 0===f?"array":f}return e._createClass(t,[{key:"parameterNames",value:function(){var e=[];if(this.parameterMetadata){var t,r=Or(this.parameterMetadata.paramDefs);try{for(r.s();!(t=r.n()).done;){var o=t.value;e.push(o.name)}}catch(e){r.e(e)}finally{r.f()}}return e}},{key:"hasSubPanel",value:function(){if(this.parameterMetadata){var e,t=Or(this.parameterMetadata.paramDefs);try{for(t.s();!(e=t.n()).done;){if(e.value.isSubPanelEdit())return!0}}catch(e){t.e(e)}finally{t.f()}}return!1}},{key:"keyAttributeIndex",value:function(){return this.keyDefinition?0:-1}},{key:"defaultStructure",value:function(){var e=[];return this.parameterMetadata.paramDefs.forEach((function(t){e.push(t.defaultValue)})),this.keyDefinition&&e.unshift(this.keyDefinition.defaultValue),e}}],[{key:"makeStructure",value:function(e,r){return e?new t(sr(e)("id"),_r.makeParameterDef(sr(e)("key_definition"),sr(r)("key_definition"),!0),Tr.makeParameterMetadata(sr(e)("parameters"),sr(r)("parameters")),sr(r)("moveable_rows"),sr(r)("label"),sr(r)("row_selection"),sr(r)("add_remove_rows"),sr(r)("header"),sr(r)("include_all_fields"),sr(r)("layout"),kr.makeButtonMetadata(sr(r)("buttons")),sr(e)("type")):null}}]),t}();function Pr(e,t){if(t){var r,o=Or(t);try{for(o.s();!(r=o.n()).done;){var n=r.value;if(e===n.complex_type_ref)return n}}catch(e){o.e(e)}finally{o.f()}}return null}var Lr=function(){function t(r){e._classCallCheck(this,t),this.structures=r}return e._createClass(t,[{key:"getStructure",value:function(e){var t;return this.structures.forEach((function(r){r.name===e&&(t=r)})),t}}],[{key:"makeStructureMetadata",value:function(e,r){if(e){var o,n=[],a=Or(e);try{for(a.s();!(o=a.n()).done;){var i=o.value,s=Nr.makeStructure(i,Pr(i.id,r));null!==s&&n.push(s)}}catch(e){a.e(e)}finally{a.f()}return new t(n)}return null}}]),t}(),Dr=function(){function t(r,o,n,a,i,s,l,u,p,c,d,f,h){e._classCallCheck(this,t),this.name=r,this.icon=o,this.editorSize=n,this.pixelWidth=a,this.label=i,this.labelEditable=s,this.help=l,this.description=ur.make(u),this.structureMetadata=p,this.parameterMetadata=c,this.groupMetadata=d,this.actionMetadata=f,this.heading=h}return e._createClass(t,[{key:"editorSizeHint",value:function(e){return this.editorSize?this.editorSize:e||o.Size.SMALL}}],[{key:"makePropertyDef",value:function(e,r,o,n){var a=Lr.makeStructureMetadata(o,sr(n)("complex_type_info")),i=Tr.makeParameterMetadata(r,sr(n)("parameter_info"),sr(n)("ui_parameters")),s=gr.makeActionMetadata(sr(n)("action_info")),l=fr.makeGroupMetadata(sr(n)("group_info"),i.getParameters()),p=e&&e.title?e.title:"",c=e&&void 0!==e.editable?e.editable:u.DEFAULT_LABEL_EDITABLE;return new t(sr(n)("id"),sr(n)("icon"),sr(n)("editor_size"),sr(n)("pixel_width"),p,c,sr(n)("help"),sr(n)("description"),a,i,l,s,sr(n)("label"))}}]),t}(),Mr=e._createClass((function t(r){e._classCallCheck(this,t),this.name=r.name,r.label&&(this.label=r.label),r.description&&(this.description=r.description),"boolean"==typeof r.labelVisible&&(this.labelVisible=r.labelVisible),r.controlType&&(this.controlType=r.controlType),r.valueDef&&(this.valueDef=r.valueDef),r.role&&(this.role=r.role),r.additionalText&&(this.additionalText=r.additionalText),r.orientation&&(this.orientation=r.orientation),r.values&&(this.values=r.values),r.valueLabels&&(this.valueLabels=r.valueLabels),r.valueDescs&&(this.valueDescs=r.valueDescs),r.valueIcons&&(this.valueIcons=r.valueIcons),"boolean"==typeof r.sortable&&(this.sortable=r.sortable),"boolean"==typeof r.filterable&&(this.filterable=r.filterable),"boolean"==typeof r.resizable&&(this.resizable=r.resizable),r.language&&(this.language=r.language),r.enableMaximize&&(this.enableMaximize=r.enableMaximize),r.charLimit&&(this.charLimit=r.charLimit),r.summary&&(this.summary=r.summary),r.increment&&(this.increment=r.increment),r.generatedValues&&(this.generatedValues={},r.generatedValues.operation&&(this.generatedValues.operation=r.generatedValues.operation),r.generatedValues.start_value&&(this.generatedValues.startValue=r.generatedValues.start_value)),r.dateFormat&&(this.dateFormat=r.dateFormat),r.timeFormat&&(this.timeFormat=r.timeFormat),r.customControlId&&(this.customControlId=r.customControlId),r.data&&(this.data=r.data),r.rows&&(this.rows=r.rows),r.displayChars&&(this.displayChars=r.displayChars),r.action&&(this.action=r.action),r.structureType&&(this.structureType=r.structureType),r.subControls&&(this.subControls=r.subControls),r.childItem&&(this.childItem=r.childItem),r.layout&&(this.layout=r.layout),"number"==typeof r.keyIndex&&(this.keyIndex=r.keyIndex),r.defaultRow&&(this.defaultRow=r.defaultRow),"boolean"==typeof r.moveableRows&&(this.moveableRows=r.moveableRows),"boolean"==typeof r.required&&(this.required=r.required),r.rowSelection&&(this.rowSelection=r.rowSelection),"boolean"==typeof r.addRemoveRows&&(this.addRemoveRows=r.addRemoveRows),"boolean"==typeof r.hideEditButton&&(this.hideEditButton=r.hideEditButton),"boolean"==typeof r.header&&(this.header=r.header),"boolean"==typeof r.uionly&&(this.uionly=r.uionly),"boolean"==typeof r.includeAllFields&&(this.includeAllFields=r.includeAllFields),r.dmImage&&(this.dmImage=r.dmImage),"boolean"==typeof r.visible&&(this.visible=r.visible),"number"==typeof r.width&&(this.width=r.width),r.editStyle?this.editStyle=r.editStyle:r.isKeyField||void 0===r.structureType||(this.editStyle=o.EditStyle.INLINE),r.dmDefault&&(this.dmDefault=r.dmDefault),r.dmImage&&(this.dmImage=r.dmImage),r.customValueAllowed&&(this.customValueAllowed=r.customValueAllowed),r.className&&(this.className=r.className),r.showRequiredLabel&&(this.showRequiredLabel=r.showRequiredLabel),r.buttons&&(this.buttons=r.buttons),this.light=a.get_1(r,"light",!0)}));function xr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function Br(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?xr(Object(r),!0).forEach((function(t){v._defineProperty(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Fr=function(){function t(r){e._classCallCheck(this,t),this.id=sr(r)("id"),this.itemType=sr(r)("itemType"),this.tabs=sr(r)("tabs"),this.panel=sr(r)("panel"),this.control=sr(r)("control"),this.text=sr(r)("text"),this.textType=sr(r)("textType"),this.secondaryText=sr(r)("secondaryText"),this.dependsOn=sr(r)("dependsOn"),this.action=sr(r)("action"),this.className=sr(r)("className"),this.nestedPanel=sr(r)("nestedPanel")}return e._createClass(t,null,[{key:"makePrimaryTabs",value:function(e){return new t({itemType:o.ItemType.PRIMARY_TABS,tabs:e})}},{key:"makeSubTabs",value:function(e,r,n){return new t({itemType:o.ItemType.SUB_TABS,tabs:e,className:r,nestedPanel:n})}},{key:"makePanelSelector",value:function(e,r,n,a){return new t({id:e,itemType:o.ItemType.PANEL_SELECTOR,tabs:r,dependsOn:n,className:a})}},{key:"makePanel",value:function(e){return new t({itemType:o.ItemType.PANEL,panel:e})}},{key:"makeAdditionalLink",value:function(e,r,n){return new t({itemType:o.ItemType.ADDITIONAL_LINK,panel:n,text:e,secondaryText:r})}},{key:"makeControl",value:function(e){return new t({itemType:o.ItemType.CONTROL,control:e})}},{key:"makeAction",value:function(e){return new t({itemType:o.ItemType.ACTION,action:e})}},{key:"makeHSeparator",value:function(){return new t({itemType:o.ItemType.HORIZONTAL_SEPARATOR})}},{key:"makeStaticText",value:function(e,r){return new t({itemType:o.ItemType.STATIC_TEXT,text:e,textType:r})}},{key:"makeTextPanel",value:function(e,r,n,a,i){return new t({itemType:o.ItemType.TEXT_PANEL,panel:{id:e,label:r,description:n,className:a,nestedPanel:i}})}},{key:"makeCustomPanel",value:function(e,r){return new t({itemType:o.ItemType.CUSTOM_PANEL,panel:e,className:r})}},{key:"makeTearsheetPanel",value:function(e,r){return new t({itemType:o.ItemType.TEARSHEET,panel:Br(Br({},e),{},{description:r})})}}]),t}(),Vr=e._createClass((function t(r,o,n){e._classCallCheck(this,t),this.text=r,this.group=o,this.content=n})),Ur=function(){function t(r,n,a,i){e._classCallCheck(this,t),this.propType=r===o.Type.OBJECT?o.Type.STRUCTURE:r,this.isList=n,this.isMap=a,this.defaultValue=i}return e._createClass(t,null,[{key:"make",value:function(e){return new t(e.propType(),e.isList(),e.isMapValue(),e.defaultValue)}}]),t}(),zr=e._createClass((function t(r,o){e._classCallCheck(this,t),this.text=r,o&&(this.numberGenerator=o)})),Hr=e._createClass((function t(r,o,n){e._classCallCheck(this,t),this.text=r,o&&(this.placement=o),n&&(this.link=n)})),jr=e._createClass((function t(r,o,n,a,i,s){var l=arguments.length>6&&void 0!==arguments[6]&&arguments[6];e._classCallCheck(this,t),this.id=r,this.panelType=o,this.nestedPanel=a,this.uiItems=i,this.open=l,s&&(this.label=s),n&&(this.className=n)})),Gr=e._createClass((function t(r,o,n,a,i,s,l){e._classCallCheck(this,t),this.id=r,this.panelType=o,this.nestedPanel=a,this.uiItems=i,n&&(this.className=n),s&&(this.label=s),l&&(this.description=l)})),qr=e._createClass((function t(r,o,n,a,i,s){e._classCallCheck(this,t),this.id=r,this.panelType=o,this.nestedPanel=a,this.parameters=i,this.data=s,n&&(this.className=n)})),Yr=e._createClass((function t(r,o){e._classCallCheck(this,t),this.text=r,o.range&&(this.range=o.range)}));function Kr(e,t,r,o){var n=r.l10nLabel(t,t.name),a={light:!0,containerType:o};return new Vr(n,t.name,Wr(e.parameterMetadata,e.actionMetadata,t,e.structureMetadata,r,a))}function Wr(e,t,r,n,i,s){var l=r.name,u=null,p=null,c=r.className,d=a.get_1(r,"nestedPanel",!1);switch(r.groupType()){case o.GroupType.CONTROLS:return Fr.makePanel(new jr(l,o.PanelType.GENERAL,c,d,Xr(e,t,r,n,i,s)));case o.GroupType.COLUMN_SELECTION:return Fr.makePanel(new jr(l,o.PanelType.COLUMN_SELECTION,c,d,Xr(e,t,r,n,i,s)));case o.GroupType.ADDITIONAL:var f=new jr(l,o.PanelType.GENERAL,c,d,Xr(e,t,r,n,i,s));return p=i.l10nLabel(r,r.name),Fr.makeAdditionalLink(p,p,f);case o.GroupType.SUB_TABS:var h=[];return Array.isArray(r.subGroups)&&r.subGroups.forEach((function(r){var o=r.name;u=Wr(e,t,r,n,i,s),p=i.l10nLabel(r,r.name),h.push(new Vr(p,o,u))})),Fr.makeSubTabs(h,c,d);case o.GroupType.PANEL_SELECTOR:var m=$r(r,e,t,n,i,s);return Fr.makePanelSelector(l,m,r.dependsOn,c);case o.GroupType.PANELS:var y=[];return Array.isArray(r.subGroups)&&r.subGroups.forEach((function(r){u=Wr(e,t,r,n,i,s),y.push(u)})),Fr.makePanel(new jr(l,o.PanelType.GENERAL,c,d,y));case o.GroupType.COLUMN_PANEL:var v=[];return Array.isArray(r.subGroups)&&r.subGroups.forEach((function(r){u=Wr(e,t,r,n,i,s),v.push(u)})),Fr.makePanel(new jr(l,o.PanelType.COLUMN_PANEL,c,d,v));case o.GroupType.CUSTOM_PANEL:return Fr.makeCustomPanel(new qr(l,o.PanelType.CUSTOM,c,d,r.parameterNames(),r.data));case o.GroupType.SUMMARY_PANEL:p=i.l10nLabel(r,r.name);var g=[];return Array.isArray(r.subGroups)&&r.subGroups.forEach((function(r){u=Wr(e,t,r,n,i,s),g.push(u)})),Fr.makePanel(new jr(l,o.PanelType.SUMMARY,c,d,g,p));case o.GroupType.ACTION_PANEL:var b;return p=i.l10nResource(r.label),r.description&&(b=new Hr(i.l10nResource(r.description),null,r.description?r.description.link:null)),Fr.makePanel(new Gr(l,o.PanelType.ACTION_PANEL,c,d,function(e,t,r,o,n){var a=[];Array.isArray(r.actionIds())&&r.actionIds().forEach((function(e){var r=Fr.makeAction(to(t.getAction(e),n));a.push(r)}));return a}(0,t,r,0,i),p,b));case o.GroupType.TEXT_PANEL:var E;return p=i.l10nResource(r.label),r.description&&(E=new Hr(i.l10nResource(r.description),r.description?r.description.placement:null,r.description?r.description.link:null)),Fr.makeTextPanel(l,p,E,c,d);case o.GroupType.TWISTY_PANEL:p=i.l10nLabel(r,r.name);var _=[];return Array.isArray(r.subGroups)&&r.subGroups.forEach((function(r){u=Wr(e,t,r,n,i,s),_.push(u)})),Fr.makePanel(new jr(l,o.PanelType.TWISTY_PANEL,c,d,_,p,r.open));case o.GroupType.TEARSHEET_PANEL:var S;p=i.l10nLabel(r,r.name),r.description&&(S=new Hr(i.l10nResource(r.description)));var T=[];return Array.isArray(r.subGroups)&&r.subGroups.forEach((function(r){var o=Object.assign({},s,{light:!1});u=Wr(e,t,r,n,i,o),T.push(u)})),Fr.makeTearsheetPanel(new jr(l,o.PanelType.TEARSHEET,c,d,T,p,!1),S);default:return o.logger.warn("(Unknown group type '"+r.groupType()+"')"),null}}function Xr(e,t,r,n,a,i){var s=[],l=[];return Array.isArray(r.parameterNames())?(r.parameterNames().forEach((function(u){var p,c=e.getParameter(u);if(c.propType()===o.Type.STRUCTURE&&n&&(p=n.getStructure(c.baseType())),!(r instanceof Nr)||r instanceof Nr&&c.isSubPanelEdit()){var d=Zr(e,u,r,p,a,t,n,null,i),f=Fr.makeControl(d);if(c.separatorBefore()&&s.push(Fr.makeHSeparator()),c.textBefore&&s.push(Fr.makeStaticText(c.getTextBefore(a),c.getTextBeforeType())),s.push(f),c.textAfter&&s.push(Fr.makeStaticText(c.getTextAfter(a),c.getTextAfterType())),c.separatorAfter()&&s.push(Fr.makeHSeparator()),r.subGroups&&r.subGroups.length>0)for(var h=0;h<r.subGroups.length;h++)f.control.controlType===o.ControlType.RADIOSET&&f.control.orientation===o.ORIENTATIONS.VERTICAL&&r.subGroups[h].type===o.GroupType.PANEL_SELECTOR&&!0===r.subGroups[h].insertPanels&&r.subGroups[h].dependsOn===f.control.name&&(l.push(r.subGroups[h].dependsOn),f.additionalItems=$r(r.subGroups[h],e,t,n,a,i))}})),Array.isArray(r.subGroups)&&r.subGroups.forEach((function(r){if(!function(e,t){if(t)for(var r=0;r<e.length;r++)if(e[r]===t)return!0;return!1}(l,r.dependsOn)){var o=Wr(e,t,r,n,a,i);s.push(o)}})),s):s}function $r(e,t,r,o,n,a){var i=[];return Array.isArray(e.subGroups)&&e.subGroups.forEach((function(e){var s=e.name,l=Wr(t,r,e,o,n,a),u=n.l10nLabel(e,e.name);i.push(new Vr(u,s,l))})),i}function Jr(e,t){var r,n=e.getRole();if(e.isList()){var a=function(e){var t={};switch(e.getRole()){case o.ParamRole.TEXT:t.controlType=o.ControlType.TEXTAREA;break;case o.ParamRole.ENUM:e.getValidValueCount()<5?t.controlType=o.ControlType.CHECKBOXSET:t.controlType=o.ControlType.SOMEOFSELECT;break;case o.ParamRole.COLUMN:t.role=o.ParamRole.COLUMN,t.controlType=o.ControlType.SELECTCOLUMNS;break;default:t.controlType=o.ControlType.TEXTAREA}return t}(e);r=a.controlType,a.role&&(n=a.role)}else switch(e.getRole()){case o.ParamRole.TEXT:r=o.ControlType.TEXTAREA;break;case o.ParamRole.ENUM:r=e.getValidValueCount()>4||t&&!eo(e)?o.ControlType.ONEOFSELECT:o.ControlType.RADIOSET;break;case o.ParamRole.COLUMN:n=o.ParamRole.COLUMN,r=t&&function(e){if(e.isList()||e.isMapValue())return eo(e);return!1}(e)?o.ControlType.SELECTCOLUMNS:o.ControlType.SELECTCOLUMN;break;case o.ParamRole.EXPRESSION:r=o.ControlType.EXPRESSION;break;case o.ParamRole.EMAIL:n=o.ParamRole.EMAIL,r=o.ControlType.TEXTFIELD;break;case o.ParamRole.URL:n=o.ParamRole.URL,r=o.ControlType.TEXTFIELD;break;case o.ParamRole.COLOR:n=o.ParamRole.COLOR,r=o.ControlType.TEXTFIELD;break;default:r=o.ControlType.TEXTFIELD}return{controlType:r,role:n}}function Zr(e,t,r,n,a,i,s,l,p){var c=void 0!==l&&l,d=c?l:e.getParameter(t),f=d.getAdditionalText(a),h=d.orientation,m=d.required;d.numberGenerator&&(d.numberGenerator=new Yr(a.l10nLabel(d.numberGenerator,d.name),d.numberGenerator));var y,v=new zr(a.l10nLabel(d,d.name),d.numberGenerator);d.description&&(y=new Hr(a.l10nDesc(d,d.name),d.description?d.description.placement:null,d.description?d.description.link:null));var g,b,E,_,S,T,I,C,R,A,k,O,w,N,P,L=!0,D=d.moveableRows,M=d.structureType;if(c||d.getRole()!==o.ParamRole.CUSTOM)switch(d.propType()){case o.Type.STRING:var x=Jr(d,c);b=x.controlType,g=x.role;break;case o.Type.PASSWORD:b=o.ControlType.PASSWORDFIELD;break;case o.Type.BOOLEAN:d.control&&d.control!==o.ControlType.CHECKBOX||(L=!1,b=o.ControlType.CHECKBOX);break;case o.Type.INTEGER:case o.Type.LONG:case o.Type.DOUBLE:b=d.isList()?o.ControlType.TEXTAREA:o.ControlType.NUMBERFIELD;break;case o.Type.DATE:g=o.Type.DATE,b=d.isList()?o.ControlType.TEXTAREA:o.ControlType.DATEFIELD;break;case o.Type.TIME:g=o.Type.TIME,b=d.isList()?o.ControlType.TEXTAREA:o.ControlType.TIMEFIELD;break;case o.Type.TIMESTAMP:b=o.ControlType.TIMESTAMP;break;case o.Type.STRUCTURE:var B=c?s.getStructure(d.baseType()):n;if(B){if(B.hasSubPanel()&&(T=function(e,t,r,n){var a=new jr(e.name,o.PanelType.GENERAL,"properties-editstyle-sub-panel",!1,Xr(e.parameterMetadata,e.actionMetadata,e,r,t,n)),i=t.l10nLabel(e,e.name);return Fr.makeAdditionalLink("...",i,a)}(B,a,s,p)),_=B.keyAttributeIndex(),S=B.defaultStructure(),E=[],B.parameterMetadata&&Array.isArray(B.parameterMetadata.paramDefs)&&B.parameterMetadata.paramDefs.forEach((function(e){var t=Qr(e,a,s,p);E.push(t)})),(d.isMapValue()||d.isList())&&B.keyDefinition){var F=Qr(B.keyDefinition,a,s,p);E.unshift(F)}d.isList()||d.isMapValue()?(!c&&r&&void 0!==r.groupType&&r.groupType()===o.GroupType.COLUMN_SELECTION||d.control===o.ControlType.STRUCTURETABLE||d.getRole()===o.ParamRole.COLUMN?(b=o.ControlType.STRUCTURETABLE,D=B.moveableRows,I=B.rowSelection,C=B.addRemoveRows,R=B.header,A=B.includeAllFields):(b=o.ControlType.STRUCTURELISTEDITOR,D=B.moveableRows,I=B.rowSelection,C=B.addRemoveRows,R=B.header),B.buttons&&(O=function(e,t){var r=[];return e.buttonDefs.forEach((function(o){r.push(function(e,t){var r,o;e.label&&(r=new zr(t.l10nLabel(e,e.id)));e.description&&(o=new Hr(t.l10nDesc(e,e.description)));return new Rr(e.id,r,o,e.icon,e.carbonIcon,e.enabled,e.divider)}(e.getButton(o.id),t))})),r}(B.buttons,a))):(b=o.ControlType.STRUCTUREEDITOR,B.layout&&(k=B.layout)),M=B.type}else b=o.ControlType.TEXTFIELD;break;case o.Type.OBJECT:if(c)(g=d.getRole())===o.ParamRole.COLUMN?b=o.ControlType.SELECTCOLUMN:(o.logger.warn("Complex subControl type that is not a field! Name: "+d.name),b=o.ControlType.READONLY);else if(d.isCompoundField()){var V=Jr(d,c);b=V.controlType,g=V.role}else o.logger.warn("Complex parameter type that is not a field! Name: "+d.name),b=o.ControlType.READONLY;break;default:g="???"+d.propType()+"???",b=o.ControlType.TEXTAREA}else b=o.ControlType.CUSTOM;d.getRole()===o.ParamRole.ENUM&&(w=function(e,t){if(Array.isArray(e.getValidValues())){var r;r=e.resource_key?e.resource_key:e.name;var o=[];return e.getValidValues().forEach((function(e){o.push(t.l10nValueLabel(r,String(e)))})),o}return[]}(d,a)),d.getRole()===o.ParamRole.ENUM&&(N=function(e,t){if(Array.isArray(e.getValidValues())){var r;r=e.resource_key?e.resource_key:e.name;var o=[];return e.getValidValues().forEach((function(e){o.push(t.l10nValueDesc(r,String(e)))})),o}return[]}(d,a)),!c&&d.actionRef&&(P=to(i.getAction(d.actionRef),a));var U,z,H,j={};return j.name=d.name,j.label=v,j.description=y,j.labelVisible="boolean"==typeof d.labelVisible?d.labelVisible:L,j.controlType=d.getControl(b),j.valueDef=Ur.make(d),j.structureType=M,j.role=g,j.additionalText=f,j.orientation=h,j.values=d.getValidValues(),j.valueLabels=w,j.valueDescs=N,j.valueIcons=d.valueIcons,j.sortable=d.sortable,j.filterable=d.filterable,j.resizable=d.resizable,j.charLimit=d.charLimit,j.subControls=E,j.keyIndex=_,j.defaultRow=S,j.childItem=T,j.moveableRows=D,j.required=m,j.language=d.language,j.enableMaximize=d.enableMaximize,j.summary=d.summary,j.increment=d.increment,j.rowSelection=I,j.generatedValues=d.generatedValues,j.addRemoveRows=C,j.dateFormat=d.dateFormat,j.timeFormat=d.timeFormat,j.customControlId=d.customControlId,j.data=d.data,j.rows=d.rows,j.displayChars=d.displayChars,j.header=R,j.uionly=d.uionly,j.includeAllFields=A,j.layout=k,j.dmImage=d.dmImage,j.action=P,j.customValueAllowed=d.customValueAllowed,j.className=d.className,j.showRequiredLabel=d.showRequiredLabel,j.buttons=O,j.light=(U=p.light,z=p.containerType,H=d.isSubPanelEdit(),U&&(z!==u.CONTAINER_TYPE.TEARSHEET||z===u.CONTAINER_TYPE.TEARSHEET&&H)),c&&(j.visible=d.visible,j.width=d.columns(8),j.editStyle=d.editStyle,j.isKeyField=d.isKey,j.dmDefault=d.dmDefault),new Mr(j)}function Qr(e,t,r,n){return Zr(null,null,null,e.propType()===o.Type.STRUCTURE?r.getStructure(e.baseType()):null,t,null,r,e,n)}function eo(e){return"on_panel"===e.editStyle||"subpanel"===e.editStyle}function to(e,t){var r,o=new zr(t.l10nLabel(e,e.id));return e.description&&(r=new Hr(t.l10nDesc(e,e.id))),new yr(e.id,o,r,e.control,e.data,e.image,e.button)}function ro(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return oo(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return oo(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function oo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function no(t,r){for(var o in t)a.has_1(t,o)&&"object"===e._typeof(t[o])&&null!==t[o]&&(t[o].message?t[o].message.default=r.l10nResource(t[o].message):no(t[o],r))}function ao(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return io(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return io(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function io(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}var so=function(){function t(r,o,n,a,i,s,l,u,p,c,d,f,h){e._classCallCheck(this,t),this.componentId=r,this.label=o,this.labelEditable=n,this.help=a,this.editorSize=i,this.pixelWidth=s,this.uiItems=l,this.buttons=u,this.data=p,this.conditions=c,this.resources=d,this.icon=f,this.heading=h}return e._createClass(t,null,[{key:"makeForm",value:function(e,r,n){var a,i,s=Dr.makePropertyDef(sr(e)("titleDefinition"),sr(e)("parameters"),sr(e)("complex_types"),sr(e)("uihints")),l=sr(e)("resources"),p=sr(e)("conditions");if(s){var c=new lr(l),d=[];if(s.groupMetadata&&s.groupMetadata.groups){var f,h=ao(s.groupMetadata.groups);try{for(h.s();!(f=h.n()).done;){var m=f.value;d.push(Kr(s,m,c,r))}}catch(e){h.e(e)}finally{h.f()}}var y=sr(e)("current_parameters");n&&(y=o.convertValueDataTypes(y,s.parameterMetadata.paramDefs));var v={currentParameters:y,uiCurrentParameters:sr(e)("current_ui_parameters"),datasetMetadata:sr(e)("dataset_metadata")},g=r===u.CONTAINER_TYPE.TEARSHEET||r===u.CONTAINER_TYPE.MODAL?o.Size.LARGE:o.Size.SMALL;return new t(s.name,s.label,s.labelEditable,s.help,s.editorSizeHint(g),s.pixelWidth,[Fr.makePrimaryTabs(d)],(a=new lo("ok","OK",!0,""),i=new lo("cancel","Cancel",!1,""),[a,i]),v,function(e,t){if(e&&Array.isArray(e)){var r,o=ro(e);try{for(o.s();!(r=o.n()).done;)no(r.value,t)}catch(e){o.e(e)}finally{o.f()}}return e}(p,c),l,s.icon,c.l10nResource(s.heading))}return null}}]),t}();var lo=e._createClass((function t(r,o,n,a){e._classCallCheck(this,t),this.id=r,this.text=o,this.isPrimary=n,this.url=a}));function uo(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var po=function(r){t._inherits(n,r);var o=uo(n);function n(t,r,a,i,s){var l;return e._classCallCheck(this,n),(l=o.call(this,t)).newValues=t,l.initialValues=r,l.appData=a,l.applyPropertyChanges=i,l.propertiesActionLabel=s,l}return e._createClass(n,[{key:"do",value:function(){this.applyPropertyChanges(this.newValues.properties,this.appData,this.newValues.additionalInfo,this.newValues.undoInfo,this.newValues.uiProperties)}},{key:"undo",value:function(){this.applyPropertyChanges(this.initialValues.properties,this.appData,this.initialValues.additionalInfo,this.initialValues.undoInfo,this.initialValues.uiProperties)}},{key:"redo",value:function(){this.applyPropertyChanges(this.newValues.properties,this.appData,this.newValues.additionalInfo,this.newValues.undoInfo,this.newValues.uiProperties)}},{key:"getLabel",value:function(){return this.propertiesActionLabel}}]),n}(i.Action),co=a._baseRest,fo=o._isIterateeCall;var ho=function(e){return co((function(t,r){var o=-1,n=r.length,a=n>1?r[n-1]:void 0,i=n>2?r[2]:void 0;for(a=e.length>3&&"function"==typeof a?(n--,a):void 0,i&&fo(r[0],r[1],i)&&(a=n<3?void 0:a,n=1),t=Object(t);++o<n;){var s=r[o];s&&e(t,s,o,a)}return t}))},mo=n._assignValue,yo=n._copyObject,vo=ho,go=a.isArrayLike_1,bo=a._isPrototype,Eo=a.keys_1,_o=Object.prototype.hasOwnProperty,So=vo((function(e,t){if(bo(t)||go(t))yo(t,Eo(t),e);else for(var r in t)_o.call(t,r)&&mo(e,r,t[r])}));function To(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=t.property&&t.property.propertyId?t.property.propertyId:null;switch(t.type){case De:if(null===r)return e;var o=e;return void 0!==r.row?(void 0===o[r.name]&&(o[r.name]=[]),void 0!==r.col?(void 0===o[r.name][r.row]&&(o[r.name][r.row]=[]),void 0!==r.propertyId?Io(r.propertyId,o[r.name][r.row][r.col],t.property.value):o[r.name][r.row][r.col]=t.property.value):void 0!==r.propertyId?Io(r.propertyId,o[r.name][r.row],t.property.value):o[r.name][r.row]=t.property.value):o[r.name]=t.property.value,Object.assign({},e,o);case Le:return Object.assign({},t.properties);case Me:var n=e;return null!==r&&void 0!==r.name&&delete n[r.name],Object.assign({},e,n);default:return e}}function Io(e,t,r){void 0!==e.row&&(void 0!==e.col?(void 0===t[e.row]&&(t[e.row]=[]),void 0!==e.propertyId?Io(e.propertyId,t[e.row][e.col],r):t[e.row][e.col]=r):t[e.row]=r)}function Co(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Be:var r=e,o=t.state.propertyId;if(void 0===r[o.name]&&(r[o.name]={}),void 0!==o.row){var n=o.row.toString();if(void 0===r[o.name][n]&&(r[o.name][n]={}),void 0!==o.col){var a=o.col.toString();void 0===r[o.name][n][a]&&(r[o.name][n][a]={}),r[o.name][n][a]={value:t.state.value}}else r[o.name][n]={value:t.state.value}}else r[o.name]={value:t.state.value};return Object.assign({},e,r);case xe:return Object.assign({},t.states);default:return e}}function Ro(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ve:var r=e;return r[t.state.panelId.name]={value:t.state.value},Object.assign({},e,r);case Fe:return Object.assign({},t.states);default:return e}}function Ao(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ze:var r=e;return r[t.state.actionId.name]={value:t.state.value},Object.assign({},e,r);case Ue:return Object.assign({},t.states);default:return e}}function ko(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case je:var r=e,o=t.message.propertyId;if(void 0===r[o.name]&&(r[o.name]={}),void 0!==o.row){var n=o.row.toString();if(void 0===r[o.name][n]&&(r[o.name][n]={}),void 0!==o.col){var i=o.col.toString();void 0===r[o.name][n][i]&&(r[o.name][n][i]={}),r[o.name][n][i]=t.message.value}else r[o.name][n]=Object.assign({},t.message.value)}else r[o.name]=Object.assign({},t.message.value);return Object.assign({},e,r);case Ge:var s=e;return s[t.message.propertyId.name]&&(void 0!==t.message.propertyId.row?void 0!==t.message.propertyId.col?delete s[t.message.propertyId.name][t.message.propertyId.row][t.message.propertyId.col]:delete s[t.message.propertyId.name][t.message.propertyId.row]:(delete s[t.message.propertyId.name].type,delete s[t.message.propertyId.name].text,delete s[t.message.propertyId.name].validation_id,delete s[t.message.propertyId.name].required,delete s[t.message.propertyId.name].propertyId,delete s[t.message.propertyId.name].displayError,a.isEmpty_1(s[t.message.propertyId.name])&&delete s[t.message.propertyId.name])),Object.assign({},e,s);case He:return Object.assign({},t.messages);default:return e}}function Oo(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return t.type===qe?Object.assign({},e,t.datasetMetadata):e}function wo(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ye:var r=e,o=t.info.propertyId;if(r[o.name]||(r[o.name]={}),Number.isInteger(o.row)){var n=String(o.row);if(r[o.name][n]||(r[o.name][n]={}),Number.isInteger(o.col)){var a=String(o.col);r[o.name][n][a]||(r[o.name][n][a]={}),r[o.name][n][a].selectedRows=t.info.selectedRows}else r[o.name][n].selectedRows=t.info.selectedRows}else r[o.name].selectedRows=t.info.selectedRows;return Object.assign({},e,r);case Ke:var i=e,s=t.info.propertyId;if(t.info.propertyId){if(i[s.name])if(Number.isInteger(s.row)&&i[s.name][String(s.row)]){var l=String(s.row);Number.isInteger(s.col)&&i[s.name][l][String(s.col)]?i[s.name][l][String(s.col)].selectedRows=[]:i[s.name][l].selectedRows=[]}else i[s.name].selectedRows=[];return Object.assign({},e,i)}return{};default:return e}}function No(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case et:var r=e,o=t.info.propertyId;if(r[o.name]||(r[o.name]={}),Number.isInteger(o.row)){var n=String(o.row);if(r[o.name][n]||(r[o.name][n]={}),Number.isInteger(o.col)){var a=String(o.col);r[o.name][n][a]||(r[o.name][n][a]={}),r[o.name][n][a].staticRows=t.info.staticRows}else r[o.name][n].staticRows=t.info.staticRows}else r[o.name].staticRows=t.info.staticRows;return Object.assign({},e,r);case tt:var i=e,s=t.info.propertyId;if(t.info.propertyId){if(i[s.name])if(Number.isInteger(s.row)&&i[s.name][String(s.row)]){var l=String(s.row);Number.isInteger(s.col)&&i[s.name][l][String(s.col)]?i[s.name][l][String(s.col)].staticRows=[]:i[s.name][l].staticRows=[]}else i[s.name].staticRows=[];return Object.assign({},e,i)}return{};default:return e}}function Po(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case We:var r=e;return r.title=t.title,Object.assign({},e,r);case Xe:var o=e;return o.activeTab=t.activeTab,Object.assign({},e,o);default:return e}}function Lo(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(t.type===$e){var r=e;return r.propertyIds=t.propertyIds,Object.assign({},e,r)}return e}function Do(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(t.type===Je){var r=e;return r.disable=t.disableState,Object.assign({},e,r)}return e}function Mo(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;if(t.type===Ze){var r=e;return r[t.info.panelId.name]=t.info.disableState,Object.assign({},e,r)}return e}function xo(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=t.info&&t.info.propertyId?t.info.propertyId:null;switch(t.type){case Qe:if(null===r)return e;var o=e;return void 0===o[r.name]&&(o[r.name]={}),void 0!==r.row?Bo(r,o[r.name],"addRemoveRows",t.info.value):o[r.name].addRemoveRows=t.info.value,Object.assign({},e,o);case rt:if(null===r)return e;var n=e;return void 0===n[r.name]&&(n[r.name]={}),void 0!==r.row?Bo(r,n[r.name],"tableButtons.".concat(t.info.buttonId),t.info.value):i.set_1(n[r.name],"tableButtons.".concat(t.info.buttonId),t.info.value),Object.assign({},e,n);case ot:if(null===r)return e;var a=e;return void 0===a[r.name]&&(a[r.name]={}),void 0!==r.row?Bo(r,a[r.name],"hideEditButton",t.info.value):a[r.name].hideEditButton=t.info.value,Object.assign({},e,a);default:return e}}function Bo(e,t,r,o){void 0!==e.row&&(void 0===t[e.row]&&(t[e.row]={}),void 0!==e.col?(void 0===t[e.row][e.col]&&(t[e.row][e.col]={}),void 0!==e.propertyId?Bo(e.propertyId,t[e.row][e.col],r,o):i.set_1(t[e.row][e.col],r,o)):void 0!==e.propertyId?Bo(e.propertyId,t[e.row],r,o):i.set_1(t[e.row],r,o))}function Fo(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return t.type===nt?Object.assign({},e,t.tearsheetId):e}var Vo=function(){function t(){e._classCallCheck(this,t),this.combinedReducer=g.combineReducers({propertiesReducer:To,controlStatesReducer:Co,panelStatesReducer:Ro,errorMessagesReducer:ko,datasetMetadataReducer:Oo,rowSelectionsReducer:wo,componentMetadataReducer:Po,disableRowMoveButtonsReducer:Lo,actionStatesReducer:Ao,wideFlyoutPrimaryButtonDisableReducer:Mo,tearsheetStatesReducer:Fo,saveButtonDisableReducer:Do,propertiesSettingsReducer:xo,rowFreezeReducer:No});var r=!1;"undefined"!=typeof window&&(r=window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),this.store=g.createStore(this.combinedReducer,r)}return e._createClass(t,[{key:"dispatch",value:function(e){this.store.dispatch(e)}},{key:"getStore",value:function(){return this.store}},{key:"subscribe",value:function(e){this.store.subscribe(e)}},{key:"getPropertyValue",value:function(e){var t=this.store.getState().propertiesReducer[e.name];return this.getNestedPropertyValue(e,t)}},{key:"getNestedPropertyValue",value:function(e,t){if(void 0!==e.row&&null!=t){var r=t[e.row];return void 0!==e.col&&null!=r&&Array.isArray(r)?void 0!==e.index?r[e.col][e.index]:void 0!==e.propertyId?this.getNestedPropertyValue(e.propertyId,r[e.col]):r[e.col]:void 0!==e.propertyId?this.getNestedPropertyValue(e.propertyId,r):r}return t}},{key:"getPropertyValues",value:function(){var e=this.store.getState();return o.copy(e.propertiesReducer)}},{key:"setPropertyValues",value:function(e){this.store.dispatch(function(e){return{type:Le,properties:e}}(e))}},{key:"updatePropertyValue",value:function(e,t){this.store.dispatch({type:De,property:{propertyId:e,value:t}})}},{key:"removePropertyValue",value:function(e){this.store.dispatch({type:Me,property:{propertyId:e}})}},{key:"getControlState",value:function(e){if(void 0===e)return null;var t=this.store.getState().controlStatesReducer[e.name];if(t&&("hidden"===t.value||"disabled"===t.value))return t;var r=void 0!==e.col?e.col.toString():null,o=void 0!==e.row?e.row.toString():null;return null!==r&&t&&t[r]&&(void 0!==t[r].value||t[r][o]&&(void 0!==t[r][o].value||void 0!==t[r][o].values))&&(t=t[r],null!==o&&t&&t[o]&&(void 0!==t[o].value||void 0!==t[o].values)&&(t=t[o])),t||null}},{key:"getControlStates",value:function(){var e=this.store.getState();return o.copy(e.controlStatesReducer)}},{key:"setControlStates",value:function(e){o.isEqual_1(this.getControlStates(),e)||this.store.dispatch(function(e){return{type:xe,states:e}}(e))}},{key:"updateControlState",value:function(e,t){this.store.dispatch({type:Be,state:{propertyId:e,value:t}})}},{key:"getPanelState",value:function(e){if(void 0===e)return null;var t=this.store.getState().panelStatesReducer[e.name];return t&&t.value?t.value:null}},{key:"getPanelStates",value:function(){var e=this.store.getState();return o.copy(e.panelStatesReducer)}},{key:"setPanelStates",value:function(e){o.isEqual_1(this.getPanelStates(),e)||this.store.dispatch(function(e){return{type:Fe,states:e}}(e))}},{key:"updatePanelState",value:function(e,t){this.store.dispatch({type:Ve,state:{panelId:e,value:t}})}},{key:"getActionState",value:function(e){if(void 0===e)return null;var t=this.store.getState().actionStatesReducer[e.name];return t&&t.value?t.value:null}},{key:"getActionStates",value:function(){var e=this.store.getState();return o.copy(e.actionStatesReducer)}},{key:"setActionStates",value:function(e){o.isEqual_1(this.getActionStates(),e)||this.store.dispatch(function(e){return{type:Ue,states:e}}(e))}},{key:"updateActionState",value:function(e,t){this.store.dispatch({type:ze,state:{actionId:e,value:t}})}},{key:"setSaveButtonDisable",value:function(e){this.store.dispatch(function(e){return{type:Je,disableState:e}}(e))}},{key:"getSaveButtonDisable",value:function(){return this.store.getState().saveButtonDisableReducer.disable}},{key:"setWideFlyoutPrimaryButtonDisabled",value:function(e,t){this.store.dispatch({type:Ze,info:{panelId:e,disableState:t}})}},{key:"getWideFlyoutPrimaryButtonDisabled",value:function(e){if(void 0===e)return null;var t=this.store.getState().wideFlyoutPrimaryButtonDisableReducer[e.name];return void 0!==t?t:null}},{key:"getFilteredEnumItems",value:function(e){if(void 0===e)return null;var t=this.store.getState().controlStatesReducer[e.name];return void 0!==e.col&&t&&t[e.col.toString()]&&(t=t[e.col.toString()],void 0!==e.row&&t[e.row.toString()]&&(t=t[e.row.toString()])),t?t.enumFilter:null}},{key:"getErrorMessage",value:function(e,t){if(void 0===e)return null;var r=this.store.getState().errorMessagesReducer[e.name];if(void 0!==e.row&&r){if(r=r[e.row.toString()],void 0!==e.col&&r)return r[e.col.toString()];if(r&&r.text)return r}var o=null,a=null;if(r&&r.text&&(o=r),r){var i=n.cloneDeep_1(r);a=this._getTableCellErrors(i,t)}return null!==o&&null!==a?o.text=o.text+" "+a.text:null===o&&(o=a),o}},{key:"_getTableCellErrors",value:function(e,t){var r=null,n=0,i=0;for(var s in e)if(a.has_1(e,s)&&"text"!==s){var l=e[s];if(l&&l.text&&(r=l,n+=l.type===u.CONDITION_MESSAGE_TYPE.ERROR?1:0,i+=l.type===u.CONDITION_MESSAGE_TYPE.WARNING?1:0),l)for(var p in l)if(a.has_1(l,p)&&"text"!==p){var c=l[p];c&&c.text&&(r=c,n+=c.type===u.CONDITION_MESSAGE_TYPE.ERROR?1:0,i+=c.type===u.CONDITION_MESSAGE_TYPE.WARNING?1:0)}}return n+i!==1&&r&&(r.type=n>0?u.CONDITION_MESSAGE_TYPE.ERROR:u.CONDITION_MESSAGE_TYPE.WARNING,r.text=n>0?o.formatMessage(t,u.MESSAGE_KEYS.TABLE_SUMMARY_ERROR,{errorMsgCount:n}):"",r.text+=i>0?o.formatMessage(t,u.MESSAGE_KEYS.TABLE_SUMMARY_WARNING,{warningMsgCount:i}):""),r}},{key:"getErrorMessages",value:function(){var e=this.store.getState();return o.copy(e.errorMessagesReducer)}},{key:"setErrorMessages",value:function(e){o.isEqual_1(this.getErrorMessages(),e)||this.store.dispatch(function(e){return{type:He,messages:e}}(e))}},{key:"updateErrorMessage",value:function(e,t){o.isEqual_1(this.getErrorMessage(e),t)||this.store.dispatch({type:je,message:{propertyId:e,value:t}})}},{key:"clearErrorMessage",value:function(e){null!==this.getErrorMessage(e)&&this.store.dispatch({type:Ge,message:{propertyId:e}})}},{key:"setDatasetMetadata",value:function(e){this.store.dispatch(function(e){return{type:qe,datasetMetadata:e}}(e))}},{key:"getDatasetMetadata",value:function(){return this.store.getState().datasetMetadataReducer}},{key:"getSelectedRows",value:function(e){if(void 0===e)return[];var t=this.store.getState().rowSelectionsReducer[e.name];return Number.isInteger(e.row)&&t&&(t=t[String(e.row)],Number.isInteger(e.col)&&t&&(t=t[String(e.col)])),t&&t.selectedRows?t.selectedRows:[]}},{key:"updateSelectedRows",value:function(e,t){this.store.dispatch({type:Ye,info:{propertyId:e,selectedRows:t}})}},{key:"clearSelectedRows",value:function(e){this.store.dispatch({type:Ke,info:{propertyId:e}})}},{key:"getStaticRows",value:function(e){if(void 0===e)return[];var t=this.store.getState().rowFreezeReducer[e.name];return Number.isInteger(e.row)&&t&&(t=t[String(e.row)],Number.isInteger(e.col)&&t&&(t=t[String(e.col)])),t&&t.staticRows?t.staticRows:[]}},{key:"updateStaticRows",value:function(e,t){this.store.dispatch({type:et,info:{propertyId:e,staticRows:t}})}},{key:"clearStaticRows",value:function(e){this.store.dispatch({type:tt,info:{propertyId:e}})}},{key:"setDisableRowMoveButtons",value:function(e){this.store.dispatch(function(e){return{type:$e,propertyIds:e}}(e))}},{key:"getDisableRowMoveButtons",value:function(){return this.store.getState().disableRowMoveButtonsReducer.propertyIds}},{key:"setTitle",value:function(e){this.store.dispatch(at(e))}},{key:"getTitle",value:function(){return this.store.getState().componentMetadataReducer.title}},{key:"setActiveTab",value:function(e){this.store.dispatch(it(e))}},{key:"getActiveTab",value:function(){return this.store.getState().componentMetadataReducer.activeTab}},{key:"setAddRemoveRows",value:function(e,t){this.store.dispatch({type:Qe,info:{propertyId:e,value:t}})}},{key:"getAddRemoveRows",value:function(e){var t=this.store.getState();return!t.propertiesSettingsReducer[e.name]||(void 0!==e.row?Uo(e,t.propertiesSettingsReducer[e.name],"addRemoveRows",true):t.propertiesSettingsReducer[e.name].addRemoveRows)}},{key:"setTableButtonEnabled",value:function(e,t,r){this.store.dispatch({type:rt,info:{propertyId:e,buttonId:t,value:r}})}},{key:"getTableButtons",value:function(e){var t=this.store.getState(),r={};return t.propertiesSettingsReducer[e.name]?void 0!==e.row?Uo(e,t.propertiesSettingsReducer[e.name],"tableButtons",r):t.propertiesSettingsReducer[e.name].tableButtons||r:r}},{key:"getTableButtonEnabled",value:function(e,t){var r=this.store.getState();return!!r.propertiesSettingsReducer[e.name]&&(void 0!==e.row?Uo(e,r.propertiesSettingsReducer[e.name],"tableButtons.".concat(t),false):r.propertiesSettingsReducer[e.name].tableButtons[t])}},{key:"setHideEditButton",value:function(e,t){this.store.dispatch({type:ot,info:{propertyId:e,value:t}})}},{key:"getHideEditButton",value:function(e){var t=this.store.getState();return!!t.propertiesSettingsReducer[e.name]&&(void 0!==e.row?Uo(e,t.propertiesSettingsReducer[e.name],"hideEditButton",false):t.propertiesSettingsReducer[e.name].hideEditButton)}},{key:"setActiveTearsheetId",value:function(e){this.store.dispatch(function(e){return{type:nt,tearsheetId:e}}({tearsheetId:e}))}},{key:"getActiveTearsheetId",value:function(){var e=this.store.getState().tearsheetStatesReducer.tearsheetId;return void 0!==e?e:null}}]),t}();function Uo(e,t,r,o){return void 0!==e.row&&t[e.row]?void 0!==e.col&&t[e.row][e.col]?void 0!==e.propertyId?Uo(e.propertyId,t[e.row][e.col],r,o):a.get_1(t[e.row][e.col],r):void 0!==e.propertyId?Uo(e.propertyId,t[e.row],r,o):a.get_1(t[e.row],r):o}function zo(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Ho(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ho(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function Ho(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function jo(e,t,r){if(e.or)!function(e,t,r){for(var o=0;o<e.length;o++)jo(e[o],t,r)}(e.or,t,r);else if(e.and)!function(e,t,r){for(var o=0;o<e.length;o++)jo(e[o],t,r)}(e.and,t,r);else{if(!e.condition)throw new Error("Failed to parse definition");!function(e,t,r){e.parameter_ref?(t.push(e.parameter_ref),e.parameter_2_ref&&t.push(e.parameter_2_ref)):t.push(r)}(e.condition,t,r)}}function Go(e,t,r){if(t.label&&(t.summaryLabel=t.label.text),r&&(t.parentCategoryId=r),e.push(t),t.subControls)for(var o=0;o<t.subControls.length;o++){var n=t.subControls[o];n.parameterName=t.name,n.columnIndex=o,r&&(n.parentCategoryId=r),e.push(n)}}function qo(e,t,r,n,a){switch(r.itemType){case o.ItemType.CONTROL:var i=r.control;if(n&&(i.summaryPanelId=n),a&&(i.parentCategoryId=a),Go(e,i,a),r.additionalItems){var s,l=zo(r.additionalItems);try{for(l.s();!(s=l.n()).done;){qo(e,t,s.value.content,n,a)}}catch(e){l.e(e)}finally{l.f()}}break;case o.ItemType.ADDITIONAL_LINK:case o.ItemType.CHECKBOX_SELECTOR:case o.ItemType.TEARSHEET:case o.ItemType.PANEL:if(r.panel&&r.panel.uiItems){var u=n;r.panel.panelType===o.PanelType.SUMMARY&&(u=r.panel.id);var p,c=zo(r.panel.uiItems);try{for(c.s();!(p=c.n()).done;){qo(e,t,p.value,u,a)}}catch(e){c.e(e)}finally{c.f()}}break;case o.ItemType.PRIMARY_TABS:case o.ItemType.PANEL_SELECTOR:case o.ItemType.SUB_TABS:if(r.tabs){var d,f=zo(r.tabs);try{for(f.s();!(d=f.n()).done;){var h=d.value;qo(e,t,h.content,n,r.itemType===o.ItemType.PANEL_SELECTOR||r.itemType===o.ItemType.SUB_TABS?a:h.group)}}catch(e){f.e(e)}finally{f.f()}}break;case o.ItemType.CUSTOM_PANEL:if(r.panel&&r.panel.parameters){var m,y=zo(r.panel.parameters);try{for(y.s();!(m=y.n()).done;){var v={name:m.value,controlType:"custom"};n&&(v.summaryPanelId=n),a&&(v.parentCategoryId=a),e.push(v)}}catch(e){y.e(e)}finally{y.f()}}break;case o.ItemType.ACTION:r.action&&r.action.name&&(t[r.action.name]=r.action);break;case o.ItemType.STATIC_TEXT:case o.ItemType.TEXT_PANEL:case o.ItemType.HORIZONTAL_SEPARATOR:break;default:o.logger.warn("Unknown UiItem type when parsing ui conditions: "+r.itemType)}return e}function Yo(e,t,r){try{var n=function(e){var t=e;if(t.evaluate){var r=[];t.parameter_refs?jo(t.evaluate,r,t.parameter_refs):jo(t.evaluate,r,t.parameter_ref);var o=Array.from(new Set(r));return o.length>1?o:o[0]}throw new Error("Invalid validation schema")}(t[r]),a={params:n,definition:t};Ko(e.controls,n,a);var i=t[r].parameter_refs;t[r].group_refs?i=t[r].group_refs:t[r].action_refs?i=t[r].action_refs:t[r].target&&t[r].target.parameter_ref&&(i=[t[r].target.parameter_ref]),i&&Ko(e.refs,i,a)}catch(e){o.logger.info("Error parsing ui conditions: "+e)}return e}function Ko(e,t,r){if(!0===Array.isArray(t))for(var o=0;o<t.length;o++)void 0===e[t[o]]&&(e[t[o]]=[]),e[t[o]].push(r);else void 0===e[t]&&(e[t]=[]),e[t].push(r)}function Wo(e){var t={};if(e&&e.functions){var r=new lr(sr(e)("resources")),o=n.cloneDeep_1(e.functions);if(Array.isArray(o.function_info)&&Array.isArray(o.function_categories)){var a=o.parmsSet?o.function_info:function(e,t){return e.map((function(e){var r=e;if(r.locLabel=t.l10nLabel(r,r.id),r.help=t.l10nDesc(r,r.locLabel),r.value=r.locLabel,r.return_type_label){var o=ur.make(r.return_type_label);r.locReturnType=t.l10nResource(o)}return Array.isArray(e.parameters)&&(r.locLabel&&-1!==r.locLabel.indexOf("?")?e.parameters.forEach((function(e){-1!==r.locLabel.indexOf("?")&&(r.locLabel=r.locLabel.replace("?"," "+t.l10nLabel(e,e.id)+" "))})):(r.value+="(",r.locLabel+="(",e.parameters.forEach((function(e,o){var n=o>0?", ":"";r.locLabel+=n+t.l10nLabel(e,e.id),r.value+=n+"?"})),r.locLabel+=")",r.value+=")")),r}))}(o.function_info,r);o.parmsSet=!0,t.functionCategories=[],o.function_categories.forEach((function(e){t.functionCategories[e.id]={},t.functionCategories[e.id].locLabel=r.l10nLabel(e,e.id),t.functionCategories[e.id].functionList=[],e.function_refs.forEach((function(r){var o=Xo(r,a);o&&t.functionCategories[e.id].functionList.push(o)}))})),t.operators=[],o.operator_refs&&o.operator_refs.forEach((function(e){var r=Xo(e,a);r&&t.operators.push(r)})),t.fields={field_categories:[],field_table_info:[]},e.fields&&(e.fields.field_categories&&e.fields.field_categories.forEach((function(e){e.locLabel=r.l10nLabel(e,e.id),e.field_columns.field_column_info.locLabel=r.l10nLabel(e.field_columns.field_column_info,e.id+".field_column_info"),e.field_columns.value_column_info.locLabel=r.l10nLabel(e.field_columns.value_column_info,e.id+".value_column_info");var o=r.l10nDesc(e.field_columns.field_column_info,e.id+".field_column_info");o!==e.id+".field_column_info"&&(e.field_columns.field_column_info.descLabel=o);var n=r.l10nDesc(e.field_columns.value_column_info,e.id+".value_column_info");n!==e.id+".value_column_info"&&(e.field_columns.value_column_info.descLabel=n),e.field_columns.additional_column_info&&e.field_columns.additional_column_info.forEach((function(t){t.locLabel=r.l10nLabel(t,e.id+".additional_column_info."+t.id)})),t.fields.field_categories.push(e)})),e.fields.field_table_info&&e.fields.field_table_info.forEach((function(e){t.fields.field_table_info.push(e)})))}}return e&&e.resources&&(t.resources=e.resources),t}function Xo(e,t){var r=t.find((function(t){return t.id===e}));return r||(o.logger.warn("Expression function information list, no function information found for "+e),null)}function $o(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Jo(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Jo(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function Jo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function Zo(e,t,r){switch(t.itemType){case o.ItemType.PRIMARY_TABS:case o.ItemType.SUB_TABS:if(t.tabs){var n,a=$o(t.tabs);try{for(a.s();!(n=a.n()).done;){Zo(e,n.value.content,r)}}catch(e){a.e(e)}finally{a.f()}}break;case o.ItemType.TEXT_PANEL:case o.ItemType.PANEL:case o.ItemType.CUSTOM_PANEL:case o.ItemType.ADDITIONAL_LINK:case o.ItemType.TEARSHEET:case o.ItemType.CHECKBOX_SELECTOR:if(t.panel&&t.panel.id&&(e[r].panels.push(t.panel.id),Qo(e,t.panel.id),t.panel.uiItems)){var i,s=$o(t.panel.uiItems);try{for(s.s();!(i=s.n()).done;){Zo(e,i.value,t.panel.id)}}catch(e){s.e(e)}finally{s.f()}}break;case o.ItemType.CONTROL:if(e[r].controls.push(t.control.name),t.control.action&&e[r].actions.push(t.control.action.name),t.control.additionalItems){var l,u=$o(t.control.additionalItems);try{for(u.s();!(l=u.n()).done;){Zo(e,l.value.content,r)}}catch(e){u.e(e)}finally{u.f()}}break;case o.ItemType.PANEL_SELECTOR:if(e[r].panels.push(t.id),Qo(e,t.id),t.dependsOn&&e[t.id].controls.push(t.dependsOn),t.tabs){var p,c=$o(t.tabs);try{for(c.s();!(p=c.n()).done;){Zo(e,p.value.content,t.id)}}catch(e){c.e(e)}finally{c.f()}}break;case o.ItemType.ACTION:e[r].actions.push(t.action.name);break;case o.ItemType.STATIC_TEXT:case o.ItemType.HORIZONTAL_SEPARATOR:break;default:o.logger.warn("Unknown UiItem type when parsing ui conditions: "+t.itemType)}}function Qo(e,t){a.has_1(e,t)&&o.logger.warn("Duplicate panel ids, each panel id must be unique.  Panel id = "+t),e[t]={controls:[],panels:[],actions:[]}}var en=a._baseFlatten,tn=a._baseRest,rn=i._baseUniq,on=a.isArrayLikeObject_1,nn=a.last_1,an=tn((function(e){var t=nn(e);return t="function"==typeof t?t:void 0,rn(en(e,1,on,!0),void 0,t)})),sn=a._SetCache,ln=a._arrayIncludes,un=a._arrayIncludesWith,pn=a._arrayMap,cn=a._baseUnary,dn=a._cacheHas,fn=Math.min;var hn=function(e,t,r){for(var o=r?un:ln,n=e[0].length,a=e.length,i=a,s=Array(a),l=1/0,u=[];i--;){var p=e[i];i&&t&&(p=pn(p,cn(t))),l=fn(p.length,l),s[i]=!r&&(t||n>=120&&p.length>=120)?new sn(i&&p):void 0}p=e[0];var c=-1,d=s[0];e:for(;++c<n&&u.length<l;){var f=p[c],h=t?t(f):f;if(f=r||0!==f?f:0,!(d?dn(d,h):o(u,h,r))){for(i=a;--i;){var m=s[i];if(!(m?dn(m,h):o(e[i],h,r)))continue e}d&&d.push(h),u.push(f)}}return u},mn=a.isArrayLikeObject_1;var yn=function(e){return mn(e)?e:[]},vn=a._arrayMap,gn=hn,bn=a._baseRest,En=yn,_n=a.last_1,Sn=bn((function(e){var t=_n(e),r=vn(e,En);return(t="function"==typeof t?t:void 0)&&r.pop(),r.length&&r[0]===e[0]?gn(r,void 0,t):[]}));function Tn(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return In(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return In(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function In(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function Cn(t,r,o){var n=t;if(n.validation)return function(t,r,o){if(t.fail_message&&t.evaluate){var n=t.evaluate;n.isValidation=!0;var a=An(n,r,o);return"object"===e._typeof(a)?a:a||function(e){if(e.focus_parameter_ref&&e.message)return{text:e.message.default,type:e.type};return"Failed to parse failedMessage"}(t.fail_message)}throw new Error("Invalid validation schema")}(n.validation,r,o);if(n.enabled)return function(e,t,r){if((e.parameter_refs||e.group_refs||e.action_refs)&&e.evaluate)return An(e.evaluate,t,r);throw new Error("Invalid enabled schema")}(n.enabled,r,o);if(n.visible)return function(e,t,r){if((e.parameter_refs||e.group_refs||e.action_refs)&&e.evaluate)return An(e.evaluate,t,r);throw new Error("Invalid visible schema")}(n.visible,r,o);if(n.enum_filter)return function(e,t,r){if(e.target&&e.evaluate)return An(e.evaluate,t,r);throw new Error("Invalid filteredEnum schema")}(n.enum_filter,r,o);if(n.allow_change)return function(e,t,r){if((e.parameter_refs||e.group_refs)&&e.evaluate)return An(e.evaluate,t,r);throw new Error("Invalid allow change schema")}(n.allow_change,r,o);if(n.default_value)return function(e,t,r){if(e.parameter_ref&&e.value&&e.evaluate)return An(e.evaluate,t,r);throw new Error("Invalid conditional default schema")}(n.default_value,r,o);throw new Error("Invalid user input validation definition schema")}function Rn(e,t,r,o){return t&&t.filter&&t.filter.evaluate?kn(e,t.filter,t.filter.evaluate,r,o):o}function An(t,r,n){if(t.or)return function(e,t,r){for(var o=0;o<e.length;o++){if(!0===An(e[o],t,r))return!0}return!1}(t.or,r,n);if(t.and)return function(t,r,o){for(var n=0;n<t.length;n++){var a=An(t[n],r,o);if(!1===a)return!1;if("object"===e._typeof(a))return a}return!0}(t.and,r,n);if(t.condition)return function(e,t,r,n){var a=e.op,i=e.parameter_ref,s=e.parameter_2_ref,l=e.value,u={},p=r.getPropertiesConfig();n||"null"!==p.conditionDisabledPropertyHandling||(u.filterDisabled=!0);n||"null"!==p.conditionHiddenPropertyHandling||(u.filterHidden=!0);var c,d={param:i,id:On(t,i)};d.value=r.getPropertyValue(d.id,u,null),d.control=r.getControl(d.id),void 0===d.control&&o.logger.warn("Control not found when validating condition for "+i);void 0!==s&&((c={param:s,id:On(t,s)}).value=r.getPropertyValue(c.id,u,null),c.control=r.getControl(c.id));var f=r.getConditionOp(a);if(f)return f(d,c,l,r);return o.logger.warn("Ignoring unknown condition operation '"+a+"' for parameter_ref "+i),!0}(t.condition,r,n,t.isValidation);throw new Error("Failed to parse definition")}function kn(e,t,r,a,s){if(r.or)return function(e,t,r,n,a){var i,s=[],l=Tn(r);try{for(l.s();!(i=l.n()).done;){var u=kn(e,t,i.value,n,a);s=an(s,u,o.isEqual_1)}}catch(e){l.e(e)}finally{l.f()}return s}(e,t,r.or,a,s);if(r.and)return function(e,t,r,a,i){var s,l=n.cloneDeep_1(i),u=Tn(r);try{for(u.s();!(s=u.n()).done;){var p=kn(e,t,s.value,a,l);l=Sn(l,p,o.isEqual_1)}}catch(e){u.e(e)}finally{u.f()}return l}(e,t,r.and,a,s);if(r.condition)return function(e,t,r,a,s){var l=r.op,u=[];void 0!==r.value&&null!==r.value?u.push(r.value):Array.isArray(r.values)&&u.push.apply(u,i._toConsumableArray(r.values));switch(l){case"dmMeasurement":return function(e,t){var r=n.cloneDeep_1(e);r&&(r=r.filter((function(e){var r,o=Tn(t);try{for(o.s();!(r=o.n()).done;){var n=r.value;if(e.metadata&&e.metadata.measure===n)return!0}}catch(e){o.e(e)}finally{o.f()}return!1})));return r}(s,u);case"dmType":return function(e,t){var r=n.cloneDeep_1(e);r&&(r=r.filter((function(e){var r,o=Tn(t);try{for(o.s();!(r=o.n()).done;){var n=r.value;if(e.type===n)return!0}}catch(e){o.e(e)}finally{o.f()}return!1})));return r}(s,u);case"dmModelingRole":return function(e,t){var r=n.cloneDeep_1(e);r&&(r=r.filter((function(e){var r,o=Tn(t);try{for(o.s();!(r=o.n()).done;){var n=r.value;if(e.metadata&&e.metadata.modeling_role===n)return!0}}catch(e){o.e(e)}finally{o.f()}return!1})));return r}(s,u);case"dmSharedFields":return function(e,t,r,o){var n=o;t.parameter_refs&&(n=r.filterFieldsFromSharedProps(o,t.parameter_refs,e.name));return n}(e,t,a,s);default:return o.logger.warn("Ignoring unknown condition operation '"+l+"'"),s}}(e,t,r.condition,a,s);throw new Error("Failed to parse filter definition")}function On(e,t){var r={},o=t.indexOf("[");return o>-1?((r=n.cloneDeep_1(e)).name=t.substring(0,o),r.col=function(e){var t=e.indexOf("[");if(t>-1){var r=e.indexOf("]");return r>-1?parseInt(e.substring(t+1,r),10):-1}return-1}(t)):r.name=t,r}function wn(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Nn(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Nn(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function Nn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function Pn(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.getControls();!function(e,t,r){if(Object.keys(t).length>0)for(var o in t)if(a.has_1(t,o)){var n=t[o];if(!n.parameterName)Dn(n.name?{name:n.name}:{name:n},e,r)}}(e,r,t)}function Ln(e){var t={controls:e.getControlStates(),panels:e.getPanelStates(),actions:e.getActionStates()},r=e.getControls();!function(e,t,r){if(Object.keys(t).length>0)for(var o in t)if(a.has_1(t,o)){var n=t[o];if(!n.parameterName){var i=n.name?{name:n.name}:{name:n},s=e.getPropertyValue(i);if(n.subControls)if(n.valueDef.isList||n.valueDef.isMap){if(Gn(i,r,e),Array.isArray(s))for(var l=0;l<s.length;l++)for(var u=0;u<n.subControls.length;u++)i.row=l,i.col=u,Gn(i,r,e)}else for(var p={name:i.name},c=0;c<n.subControls.length;c++)p.col=c,Gn(p,r,e);else Gn(i,r,e)}}}(e,r,t),Hn(e.panelTree,t,u.PANEL_TREE_ROOT);var o=Bn(e);e.setControlStates(t.controls),e.setPanelStates(t.panels),e.setActionStates(t.actions);var n,i=wn(xn(o,Bn(e)));try{for(i.s();!(n=i.n()).done;){Mn(n.value,e,1)}}catch(e){i.e(e)}finally{i.f()}}function Dn(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=t.getControl(e);if(a){var i=n.cloneDeep_1(e),s=t.getPropertyValue(i);if(Array.isArray(s)){if(jn(i,t,a,r),a.subControls)if(a.valueDef.isList||a.valueDef.isMap)for(var l=0;l<s.length;l++)for(var u=0;u<a.subControls.length;u++)i.row=l,i.col=u,jn(i,t,a.subControls[u],r);else for(var p=0;p<a.subControls.length;p++){jn({name:e.name,col:p},t,a.subControls[p],r)}else if(void 0===i.row)for(var c=0;c<s.length;c++)i.row=c,i.col=0,jn(i,t,a,r)}else jn(i,t,a,r)}else o.logger.warn("Control not found for "+e.name)}function Mn(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=t.getControl(e);if(a){var i={controls:t.getControlStates(),panels:t.getPanelStates(),actions:t.getActionStates()},s=n.cloneDeep_1(e),l=t.getPropertyValue(s);if(Array.isArray(l)&&a.subControls)if(a.valueDef.isList||a.valueDef.isMap){Gn(s,i,t);for(var p=0;p<l.length;p++)for(var c=0;c<a.subControls.length;c++)s.row=p,s.col=c,Gn(s,i,t)}else for(var d=0;d<a.subControls.length;d++)s.col=d,Gn(s,i,t);else Gn(s,i,t);var f=Bn(t);t.setControlStates(i.controls),t.setPanelStates(i.panels),t.setActionStates(i.actions);var h,m=wn(xn(f,Bn(t),r));try{for(m.s();!(h=m.n()).done;){Mn(h.value,t,r+1)}}catch(e){m.e(e)}finally{m.f()}r>0&&Hn(t.panelTree,i,u.PANEL_TREE_ROOT)}else o.logger.warn("Control not found for "+e.name)}function xn(e,t,r){var n=[];if(r>10)return o.logger.warn("More than 10 iteration of processing conditions found. Check your conditions for loops. Updated properties: "+JSON.stringify(t)),[];var a,s=wn(i.union_1(Object.keys(e),Object.keys(t)));try{for(s.s();!(a=s.n()).done;){var l=a.value,u=e[l],p=t[l];o.isEqual_1(u,p)||n.push({name:l})}}catch(e){s.e(e)}finally{s.f()}return n}function Bn(e){var t=e.getPropertiesConfig(),r={};return"null"===t.conditionDisabledPropertyHandling&&(r.filterDisabled=!0),"null"===t.conditionHiddenPropertyHandling&&(r.filterHidden=!0),a.isEmpty_1(r)?{}:e.getPropertyValues(r)}function Fn(e,t,r,o){var n=e[t.name];n||(n={});var a=Object.assign({},n);if(!(void 0===t.row&&void 0===t.col)||a.value!==u.STATES.HIDDEN||r!==u.STATES.DISABLED&&r!==u.STATES.ENABLED?a.value=r:a.value=u.STATES.HIDDEN,void 0!==t.col){var i=t.col.toString();if(n[i]||(n[i]={}),void 0!==t.row){var s=t.row.toString();n[i][s]||(n[i][s]={}),n[i][s].value=a.value}else{n[i].value=a.value;var l="hidden"===r,p=o.getColumnVisibility(t,t.col)!==!l;void 0!==o&&p&&o.toggleColumnVisibility(t,t.col,!l)}}else n.value=a.value;e[t.name]=n}function Vn(e,t,r,o){var n=e[t.name];n||(n={}),n.values||(n.values={}),n.values[r]||(n.values[r]={});var a=Object.assign({},n);if(!(void 0===t.row&&void 0===t.col)||a.values[r].value!==u.STATES.HIDDEN||o!==u.STATES.DISABLED&&o!==u.STATES.ENABLED?a.values[r].value=o:a.values[r].value=u.STATES.HIDDEN,void 0!==t.col){var i=t.col.toString();if(n[i]||(n[i]={}),void 0!==t.row){var s=t.row.toString();n[i][s]||(n[i][s]={}),n[i][s].values||(n[i][s].values={}),n[i][s].values[r]||(n[i][s].values[r]={}),n[i][s].values[r].value=a.values[r].value}else n[i].values||(n[i].values={}),n[i].values[r]||(n[i].values[r]={}),n[i].values[r].value=a.values[r].value}else n.values[r]=a.values[r];e[t.name]=n}function Un(e,t){var r={name:e},o=e.indexOf("[");return o>-1&&(r.name=e.substring(0,o),r.col=parseInt(e.substring(o+1,e.indexOf("]")),10)),t&&(r.row=t.row),r}function zn(e,t,r,o){for(var n in e)if(a.has_1(e,n)){var i=e[n],s=1e3*N.default(n)();if(!0===i.required&&ra(i,t,r,n,s,o),"date"!==i.role&&"time"!==i.role||oa(i,t,n,s,o),"column"===i.role){var l=n;i.valueDef.isList&&(l+="[0]"),na(i,t,l,s,o)}if(i.subControls){for(var u={},p=0;p<i.subControls.length;p++){u[n+"["+p+"]"]=i.subControls[p]}zn(u,t,r,o)}}}function Hn(e,t,r,o){var n=t.panels[r],a=o?n&&n.value===u.STATES.DISABLED:n&&(n.value===u.STATES.HIDDEN||n.value===u.STATES.DISABLED);if(a&&e[r]){if(e[r].controls){var i,s=wn(e[r].controls);try{for(s.s();!(i=s.n()).done;){var l=i.value;o?t.controls[l].value!==u.STATES.HIDDEN&&Fn(t.controls,{name:l},n.value):Fn(t.controls,{name:l},n.value)}}catch(e){s.e(e)}finally{s.f()}}if(e[r].actions){var p,c=wn(e[r].actions);try{for(c.s();!(p=c.n()).done;){var d=p.value;o?t.actions[d].value!==u.STATES.HIDDEN&&Fn(t.actions,{name:d},n.value):Fn(t.actions,{name:d},n.value)}}catch(e){c.e(e)}finally{c.f()}}}if(e[r]&&e[r].panels){var f,h=wn(e[r].panels);try{for(h.s();!(f=h.n()).done;){var m=f.value;a&&(o?t.panels[m].value!==u.STATES.HIDDEN&&Fn(t.panels,{name:m},n.value):Fn(t.panels,{name:m},n.value)),Hn(e,t,m,o)}}catch(e){h.e(e)}finally{h.f()}}}function jn(t,r,i,s){var l=!1,p=r.getDefinitions(t,u.CONDITION_TYPE.VALIDATION,u.CONDITION_DEFINITION_INDEX.CONTROLS);if(p.length>0){var c=r.getRequiredDefinitionIds();try{var d,f=!1,h=wn(p);try{for(h.s();!(d=h.n()).done;){var m=d.value,y=u.DEFAULT_VALIDATION_MESSAGE;f=Cn(m.definition,t,r);var v=!1;"object"===e._typeof(f)&&(v=!0,y={type:f.type,text:f.text});var g=n.cloneDeep_1(t);if(m.definition.validation&&m.definition.validation.fail_message&&m.definition.validation.fail_message.focus_parameter_ref&&(g=Un(m.definition.validation.fail_message.focus_parameter_ref,g)),void 0!==g.col&&void 0===i.columnIndex&&delete g.col,y.validation_id=g.name,m.definition.validation&&m.definition.validation.id&&(y.validation_id=m.definition.validation.id),void 0===g.row&&delete g.row,y.propertyId=g,y.required=c.indexOf(m.definition.validation.id)>-1,s||m.alwaysShow||(y.displayError=!1),r.getErrorMessage(g,!0,!0,!1)||(l=!1),v&&!l)r.updateErrorMessage(g,y),v&&(l=!0);else if(!v&&!l){var b=r.getErrorMessage(g,!1,!1,!1);a.isEmpty_1(b)||b.validation_id!==y.validation_id||r.updateErrorMessage(g,u.DEFAULT_VALIDATION_MESSAGE)}}}catch(e){h.e(e)}finally{h.f()}}catch(e){o.logger.warn("Error thrown in validation: "+e)}}}function Gn(e,t,r){qn(e,t,r,u.CONDITION_TYPE.VISIBLE),qn(e,t,r,u.CONDITION_TYPE.ENABLED),qn(e,t,r,u.CONDITION_TYPE.FILTEREDENUM)}function qn(e,t,r,o){Yn(r.getDefinitions(e,o,u.CONDITION_DEFINITION_INDEX.CONTROLS),e,t,r,o)}function Yn(e,t,r,n,a){if(e.length>0)try{e.forEach((function(o,i){var s=Cn(o.definition,t,n);switch(a){case u.CONDITION_TYPE.VISIBLE:Kn(s,o.definition.visible,t,r,n,!0);break;case u.CONDITION_TYPE.ENABLED:Kn(s,o.definition.enabled,t,r,n,!1);break;case u.CONDITION_TYPE.FILTEREDENUM:var l=function(e,t){var r=e[t],o=r.definition.enum_filter.target.parameter_ref,n=!0;return e.forEach((function(e,r){r>t&&e.definition.enum_filter.target.parameter_ref===o&&(n=!1)})),n}(e,i);!function(e,t,r,o,n){if(e.enum_filter.target&&e.enum_filter.target.parameter_ref){var a=r.controls,i=Un(e.enum_filter.target.parameter_ref,t),s=a[i.name];if(s||(s={}),void 0!==i.col){var l=i.col.toString();if(s[l]||(s[l]={}),void 0!==i.row){var u=i.row.toString();s[l][u]||(s[l][u]={});var p=ea(e,o,s[l][u].enumFilter,s[l][u].enumFilterApplied,n);s[l][u].enumFilter=p.values,s[l][u].enumFilterApplied=p.filterApplied}else{var c=ea(e,o,s[l].enumFilter,s[l].enumFilterApplied,n);s[l].enumFilter=c.values,s[l].enumFilterApplied=c.filterApplied}}else{var d=ea(e,o,s.enumFilter,s.enumFilterApplied,n);s.enumFilter=d.values,s.enumFilterApplied=d.filterApplied}a[i.name]=s}}(o.definition,t,r,s,l)}}))}catch(e){o.logger.warn("Error thrown in validation: "+e)}}function Kn(e,t,r,o,n,a){t.parameter_refs&&Wn(e,t,r,o,n,a,t.parameter_refs,"control"),t.action_refs&&Wn(e,t,r,o,n,a,t.action_refs,"action"),t.group_refs&&function(e,t,r,o,n,a){var i,s=a?u.STATES.VISIBLE:u.STATES.ENABLED,l=a?u.STATES.HIDDEN:u.STATES.DISABLED,p=a?u.STATES.ENABLED:u.STATES.HIDDEN,c=wn(t.group_refs);try{for(c.s();!(i=c.n()).done;){var d=Un(i.value),f=ta(o.panels,d);if(!0===e){if(d&&f!==s&&f!==p)Zn(o,d,s,n)&&Xn(o,d,s,n)}else if(d&&(a||!a&&f!==p)){Zn(o,d,l,n)&&Xn(o,d,l,n)}}}catch(e){c.e(e)}finally{c.f()}}(e,t,0,o,n,a)}function Wn(e,t,r,o,n,a,i,s){var l,p=a?u.STATES.VISIBLE:u.STATES.ENABLED,c=a?u.STATES.HIDDEN:u.STATES.DISABLED,d=a?u.STATES.ENABLED:u.STATES.HIDDEN,f="control"===s?o.controls:o.actions,h=wn(i);try{for(h.s();!(l=h.n()).done;){var m=Un(l.value,r),y=ta(f,m);if(Array.isArray(t.values)){var v,g=wn(t.values);try{for(g.s();!(v=g.n()).done;){var b=v.value;Vn(f,m,b,!0===e?p:c)}}catch(e){g.e(e)}finally{g.f()}}else!0===e?m&&y!==p&&y!==d&&Fn(f,m,p,n):m&&(a||!a&&y!==d)&&Qn(o,m,c,f,n)}}catch(e){h.e(e)}finally{h.f()}}function Xn(e,t,r,o){if(o.panelTree[t.name]){var n,a=o.panelTree[t.name],i=wn(a.panels);try{for(i.s();!(n=i.n()).done;){var s={name:n.value};Fn(e.panels,s,r),Xn(e,s,r,o),r===u.STATES.ENABLED?Jn(s,o,u.CONDITION_TYPE.ENABLED,e):r===u.STATES.VISIBLE&&(e.panels[t.name].disabled&&Hn(o.panelTree,e,t.name,!0),Jn(s,o,u.CONDITION_TYPE.ENABLED,e),Jn(s,o,u.CONDITION_TYPE.VISIBLE,e))}}catch(e){i.e(e)}finally{i.f()}var l,p=wn(a.controls);try{for(p.s();!(l=p.n()).done;){$n(e,t,r,o,{name:l.value},e.controls)}}catch(e){p.e(e)}finally{p.f()}var c,d=wn(a.actions);try{for(d.s();!(c=d.n()).done;){$n(e,t,r,o,{name:c.value},e.actions)}}catch(e){d.e(e)}finally{d.f()}}}function $n(e,t,r,o,n,a){Fn(a,n,r),r===u.STATES.ENABLED?(Jn(n,o,u.CONDITION_TYPE.ENABLED,e),Jn(n,o,u.CONDITION_TYPE.VISIBLE,e)):r===u.STATES.VISIBLE&&(qn(n,e,o,u.CONDITION_TYPE.VISIBLE),Jn(n,o,u.CONDITION_TYPE.VISIBLE,e),e.panels[t.name].value===u.STATES.DISABLED?Fn(a,n,u.STATES.DISABLED):Jn(n,o,u.CONDITION_TYPE.ENABLED,e))}function Jn(e,t,r,o){var n=t.getDefinitions(e,r,u.CONDITION_DEFINITION_INDEX.REFS);n.length>0&&Yn(n,e,o,t,r)}function Zn(e,t,r,o,n){var a=t.name;if(!e.panels[a])return Fn(e.panels,t,r),!0;var i=e.panels[a].value;return((i===u.STATES.ENABLED||i===u.STATES.VISIBLE)&&(r===u.STATES.DISABLED||r===u.STATES.HIDDEN)||i===u.STATES.DISABLED&&r===u.STATES.ENABLED||i===u.STATES.HIDDEN&&r===u.STATES.VISIBLE)&&(Fn(e.panels,t,r),!0)}function Qn(e,t,r,o,n){var a=t.name;if(o[a]){var i=o[a].value;void 0!==t.col&&(o[a][t.col]&&void 0!==t.row&&o[a][t.col][t.row]?i=o[a][t.col][t.row].value:Fn(o,t,r,n)),((i===u.STATES.ENABLED||i===u.STATES.VISIBLE)&&(r===u.STATES.DISABLED||r===u.STATES.HIDDEN)||i===u.STATES.DISABLED&&r===u.STATES.ENABLED||i===u.STATES.DISABLED&&r===u.STATES.HIDDEN||i===u.STATES.HIDDEN&&r===u.STATES.VISIBLE)&&Fn(o,t,r,n)}else Fn(o,t,r,n)}function ea(e,t,r,o,n){var a={values:r,filterApplied:!n&&(o||!0)},i=null;return t&&(i=e.enum_filter.target.values),!i&&o||(a.values=i,a.filterApplied=!0),n&&(a.filterApplied=!1),a}function ta(e,t){var r=e[t.name];return void 0!==t.col&&r&&(r=r[t.col.toString()],void 0!==t.row&&r&&(r=r[t.row.toString()])),r?r.value:null}function ra(e,t,r,n,a,i){var s=e.label&&e.label.text?e.label.text:n,l="required_"+n+"_"+a,p={params:n,definition:{validation:{id:l,fail_message:{type:"error",message:{default:o.formatMessage(i,u.MESSAGE_KEYS.REQUIRED_ERROR,{label:s})},focus_parameter_ref:n},evaluate:{condition:{parameter_ref:n,op:"isNotEmpty"}}}}};t.controls[n]?t.controls[n].push(p):t.controls[n]=[p],r.push(l)}function oa(e,t,r,n,a){var i=e.dateFormat?e.dateFormat:e.timeFormat,s=e.dateFormat?u.DEFAULT_DATE_FORMAT:u.DEFAULT_TIME_FORMAT,l=i||s,p={params:r,definition:{validation:{id:"Format_"+r+"_"+n,fail_message:{type:"error",message:{default:o.formatMessage(a,u.MESSAGE_KEYS.DATETIME_FORMAT_ERROR,{role:e.role,format:l})},focus_parameter_ref:r},evaluate:{condition:{parameter_ref:r,op:"isDateTime",value:e.role}}}}};t.controls[r]?t.controls[r].push(p):t.controls[r]=[p]}function na(e,t,r,n,a){var i=e.label&&e.label.text?e.label.text:r,s={params:r,definition:{validation:{id:"validField_"+r+"_"+n,fail_message:{type:"warning",message:{default:o.formatMessage(a,u.MESSAGE_KEYS.INVALID_FIELD_ERROR,{label:i})},focus_parameter_ref:r},evaluate:{condition:{parameter_ref:r,op:"colDoesExists"}}}},alwaysShow:!0};t.controls[r]?t.controls[r].push(s):t.controls[r]=[s]}function aa(t,r,o){if(t.value)if("string"==typeof t.value)for(var n=0;n<r.length;n++){var a=r[n];if(a.name===t.value)return"type"===o?a.type:a.metadata[o]}else if("object"===e._typeof(t.value))for(var i=0;i<r.length;i++){var s=r[i];if(s.origName===t.value.field_name&&s.schema===t.value.link_ref)return"type"===o?s.type:s.metadata[o]}return null}var ia=a._arrayMap,sa=hn,la=a._baseRest,ua=yn,pa=la((function(e){var t=ia(e,ua);return t.length&&t[0]===e[0]?sa(t):[]}));function ca(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var da=function(r){t._inherits(n,r);var o=ca(n);function n(){return e._classCallCheck(this,n),o.apply(this,arguments)}return e._createClass(n,[{key:"render",value:function(){if(!this.props.messageInfo||this.props.tableOnly&&!this.props.inTable)return null;var e=this.props.inTable?null:O.default.createElement("span",null,this.props.messageInfo.text),t=O.default.createElement("div",{className:"icon"},O.default.createElement(h.Icon,{type:this.props.messageInfo.type})),r=this.props.inTable?O.default.createElement("div",{className:"properties-tooltips-container table-cell-msg-icon"},O.default.createElement(y,{id:m.v4()+"-table-cell-msg-icon",tip:this.props.messageInfo.text,direction:"bottom",className:"properties-tooltips"},t)):null,o=u.classNames("properties-validation-message",this.props.messageInfo.type,{hide:this.props.state===u.STATES.HIDDEN||this.props.state===u.STATES.DISABLED,inTable:this.props.inTable});return O.default.createElement("div",{className:o},r,e)}}]),n}(O.default.Component),fa=da;function ha(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var ma=function(r){t._inherits(a,r);var n=ha(a);function a(r){var o;return e._classCallCheck(this,a),(o=n.call(this,r)).updateValueFromFilterEnum=o.updateValueFromFilterEnum.bind(t._assertThisInitialized(o)),o}return e._createClass(a,[{key:"componentDidMount",value:function(){this.updateValueFromFilterEnum(!0)}},{key:"componentDidUpdate",value:function(e){o.isEqual_1(this.props.controlOpts,e.controlOpts)||this.updateValueFromFilterEnum()}},{key:"updateValueFromFilterEnum",value:function(e){if(Array.isArray(this.props.value)&&Array.isArray(this.props.controlOpts.values)&&this.props.control.controlType!==o.ControlType.CUSTOM){var t=pa(this.props.value,this.props.controlOpts.values);o.isEqual_1(this.props.value,t)||this.props.controller.updatePropertyValue(this.props.propertyId,t,e)}}},{key:"render",value:function(){var t=this.props.value;if(this.props.control.values&&this.props.control.valueLabels){var r=this.props.control.values.indexOf(this.props.value);r>-1&&this.props.control.valueLabels[r]&&(t=this.props.control.valueLabels[r])}if(null==t?t="":"object"===e._typeof(t)&&t.link_ref?t=o.stringifyFieldValue(t,this.props.control):Array.isArray(t)?t=t.join(", "):"boolean"==typeof t&&(t=t.toString()),t=gt(t),this.props.control.controlType===o.ControlType.CUSTOM)t=this.props.controller.getCustomControl(this.props.propertyId,this.props.control,{table:!0,editStyle:"summary"});else if(this.props.control.controlType===o.ControlType.TIMESTAMP||this.props.control.valueDef&&this.props.control.valueDef.propType===u.DATA_TYPE.TIMESTAMP){var n=new Date(t);t=S.isValid(n)?this.props.tableControl?O.default.createElement(_.FormattedDate,{value:n,day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric"}):O.default.createElement(_.FormattedDate,{value:n,day:"numeric",month:"long",year:"numeric",hour:"numeric",minute:"numeric",weekday:"long"}):""}var a=O.default.createElement("span",{className:"properties-field-type",disabled:this.props.state===u.STATES.DISABLED},t),i=a;if(this.props.tableControl){var s=!0;t&&(s=!1);var l=a;this.props.control.icon&&(l=O.default.createElement("div",{className:"properties-field-readonly"},O.default.createElement("div",{className:"properties-field-type-icon"},O.default.createElement(h.Icon,{type:this.props.control.icon})),a)),i=O.default.createElement(o.TruncatedContentTooltip,{content:l,tooltipText:t,disabled:s})}return O.default.createElement("div",{className:u.classNames("properties-readonly",{hide:this.props.state===u.STATES.HIDDEN}),"data-id":ht(this.props.propertyId)},this.props.tableControl?null:this.props.controlItem,i,O.default.createElement(fa,{inTable:this.props.tableControl,state:this.props.state,messageInfo:this.props.messageInfo}))}}]),a}(O.default.Component),ya=c.connect((function(e,t){var r={value:t.controller.getPropertyValue(t.propertyId),state:t.controller.getControlState(t.propertyId),messageInfo:t.controller.getErrorMessage(t.propertyId)};return r.controlOpts=t.controller.getFilteredEnumItems(t.propertyId,t.control),r}),null)(ma);function va(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var ga=function(r){t._inherits(a,r);var n=va(a);function a(t){var r;return e._classCallCheck(this,a),(r=n.call(this,t)).reactIntl=t.controller.getReactIntl(),r.charLimit=mt(t.control,t.controller.getMaxLengthForSingleLineControls()),r.id=ft(t.propertyId),r.isList=!1,r.props.control.valueDef&&(r.props.control.valueDef.isList&&(r.isList=!0),r.defaultValue=r.props.control.valueDef.defaultValue),r}return e._createClass(a,[{key:"handleChange",value:function(e){var t=e.target.value;-1!==this.charLimit&&t&&(t=t.substring(0,this.charLimit)),this.isList&&(t=yt(t,", ")),0!==t.length||void 0!==this.defaultValue&&null!==this.defaultValue||(t=null),this.props.controller.updatePropertyValue(this.props.propertyId,t)}},{key:"render",value:function(){var e=this.props.value?this.props.value:"",t=!1;if(this.isList){var r=vt(e,", ");e=r.value,t=r.truncated}else t=0!==(e=gt(e)).length&&e.length!==this.props.value.length;var n=u.classNames("properties-textfield","properties-input-control",{hide:this.props.state===u.STATES.HIDDEN},this.props.messageInfo?this.props.messageInfo.type:null),a=null;if(t){var i={text:o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.TRUNCATE_LONG_STRING_ERROR,{truncate_limit:u.TRUNCATE_LIMIT}),type:u.CONDITION_MESSAGE_TYPE.ERROR,validation_id:this.props.control.name};a=O.default.createElement("div",{className:"properties-textinput-readonly"},this.props.tableControl?null:this.props.controlItem,O.default.createElement(ya,{control:this.props.control,propertyId:this.props.propertyId,controller:this.props.controller,tableControl:this.props.tableControl}),"// TODO this could conflict with the below ValidationMessage.",O.default.createElement(fa,{inTable:this.props.tableControl,state:"",messageInfo:i}))}else{var s=bt(this.props.messageInfo,this.props.tableControl);a=O.default.createElement(l.TextInput,u._extends({},s,{autoComplete:!0===this.props.tableControl?"off":"on",id:this.id,disabled:this.props.state===u.STATES.DISABLED,placeholder:this.props.control.additionalText,onChange:this.handleChange.bind(this),value:e,labelText:this.props.controlItem,hideLabel:this.props.tableControl,light:this.props.controller.getLight()&&this.props.control.light}))}var p=a;if(this.props.tableControl){var c=m.v4()+"-tooltip-column-"+this.props.propertyId.toString(),d=!0;e&&this.props.state!==u.STATES.DISABLED&&(d=!1);var f=O.default.createElement("div",{className:"properties-tooltips"},String(e));p=O.default.createElement(y,{id:c,tip:f,direction:"bottom",className:"properties-tooltips",disable:d},a)}return O.default.createElement("div",{className:n,"data-id":ht(this.props.propertyId)},p,O.default.createElement(fa,{inTable:this.props.tableControl,tableOnly:!0,state:this.props.state,messageInfo:this.props.messageInfo}))}}]),a}(O.default.Component),ba=c.connect((function(e,t){return{value:t.controller.getPropertyValue(t.propertyId),state:t.controller.getControlState(t.propertyId),messageInfo:t.controller.getErrorMessage(t.propertyId)}}),null)(ga);function Ea(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var _a=function(r){t._inherits(a,r);var n=Ea(a);function a(t){var r;e._classCallCheck(this,a),(r=n.call(this,t)).reactIntl=t.controller.getReactIntl(),r.valuesMap={},r.iconsMap={};for(var o=0;o<t.control.values.length;++o)r.valuesMap[t.control.values[o]]=t.control.valueLabels[o],void 0!==t.control.valueIcons&&(r.iconsMap[t.control.values[o]]=t.control.valueIcons[o]);return r}return e._createClass(a,[{key:"onClick",value:function(e){var t=this.props.controller.getPropertyValue(this.props.propertyId)===this.props.control.values[0]?this.props.control.values[1]:this.props.control.values[0];this.props.controller.updatePropertyValue(this.props.propertyId,t)}},{key:"renderIcon",value:function(){var e=null;if(void 0!==this.iconsMap[this.props.value]){var t=this.iconsMap[this.props.value];e="string"==typeof t&&".svg"===t.slice(t.length-4)?O.default.createElement(P.default,{className:"bx--btn__icon",src:t}):O.default.createElement("img",{className:"bx--btn__icon",src:t,alt:""})}return e}},{key:"render",value:function(){var e=this.valuesMap[this.props.value];void 0===e&&(e=this.props.value);var t=null,r=this.props.tableControl?"ghost":"tertiary";void 0!==e&&(t=O.default.createElement(l.Button,{kind:r,size:"small",onClick:this.onClick.bind(this),renderIcon:this.renderIcon.bind(this),iconDescription:o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.TOGGLETEXT_ICON_DESCRIPTION,{toggletext_label:this.props.value}),disabled:this.props.state===u.STATES.DISABLED},e));var n=u.classNames("properties-toggletext",{hide:this.props.state===u.STATES.HIDDEN},this.props.messageInfo?this.props.messageInfo.type:null);return O.default.createElement("div",{"aria-label":this.props.control.label&&this.props.control.label.text?this.props.control.label.text:"",className:n,disabled:this.props.state===u.STATES.DISABLED,"data-id":ht(this.props.propertyId)},this.props.tableControl?null:this.props.controlItem,t,O.default.createElement(fa,{inTable:this.props.tableControl,state:this.props.state,messageInfo:this.props.messageInfo}))}}]),a}(O.default.Component),Sa=c.connect((function(e,t){return{value:t.controller.getPropertyValue(t.propertyId),state:t.controller.getControlState(t.propertyId),messageInfo:t.controller.getErrorMessage(t.propertyId)}}),null)(_a);function Ta(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var Ia=function(r){t._inherits(a,r);var n=Ta(a);function a(t){var r;return e._classCallCheck(this,a),(r=n.call(this,t)).reactIntl=t.controller.getReactIntl(),r.charLimit=mt(t.control,t.controller.getMaxLengthForMultiLineControls()),r.id=ft(r.props.propertyId),r}return e._createClass(a,[{key:"handleChange",value:function(e){var t=e.target.value;-1!==this.charLimit&&t&&(t=t.substring(0,this.charLimit)),this.props.control.valueDef&&this.props.control.valueDef.isList&&(t=yt(t,"\n")),this.props.controller.updatePropertyValue(this.props.propertyId,t)}},{key:"render",value:function(){var e=this.props.value?this.props.value:"",t=vt(e,"\n");e=t.value;var r=t.truncated,n=null,a=bt(this.props.messageInfo,this.props.tableControl),i=!1;if(a.warn&&(i=!0,a={}),r){var s={text:o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.TRUNCATE_LONG_STRING_ERROR,{truncate_limit:u.TRUNCATE_LIMIT}),type:u.CONDITION_MESSAGE_TYPE.ERROR,validation_id:this.props.control.name};a=bt(s,this.props.tableControl),n=O.default.createElement("div",null,O.default.createElement(l.TextArea,u._extends({},a,{id:this.id,disabled:!0,placeholder:this.props.control.additionalText,value:e,labelText:this.props.controlItem,hideLabel:this.props.tableControl,light:this.props.controller.getLight()&&this.props.control.light})),O.default.createElement(fa,{inTable:this.props.tableControl,tableOnly:!i,state:"",messageInfo:s}))}else n=O.default.createElement(l.TextArea,u._extends({},a,{id:this.id,disabled:this.props.state===u.STATES.DISABLED,placeholder:this.props.control.additionalText,onChange:this.handleChange.bind(this),value:e,labelText:this.props.controlItem,hideLabel:this.props.tableControl,light:this.props.controller.getLight()&&this.props.control.light}));var p=n;if(this.props.tableControl){var c=m.v4()+"-tooltip-column-"+this.props.propertyId.toString(),d=!0;e&&this.props.state!==u.STATES.DISABLED&&(d=!1);var f=O.default.createElement("div",{className:"properties-tooltips"},String(e));p=O.default.createElement(y,{id:c,tip:f,direction:"bottom",className:"properties-tooltips",disable:d},n)}var h=u.classNames("properties-textarea",{hide:this.props.state===u.STATES.HIDDEN},this.props.messageInfo?this.props.messageInfo.type:null);return O.default.createElement("div",{className:h,"data-id":ht(this.props.propertyId)},p,O.default.createElement(fa,{inTable:this.props.tableControl,tableOnly:!i,state:this.props.state,messageInfo:this.props.messageInfo}))}}]),a}(O.default.Component),Ca=c.connect((function(e,t){return{value:t.controller.getPropertyValue(t.propertyId),state:t.controller.getControlState(t.propertyId),messageInfo:t.controller.getErrorMessage(t.propertyId)}}),null)(Ia);function Ra(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var Aa=function(r){t._inherits(i,r);var n=Ra(i);function i(r){var o;return e._classCallCheck(this,i),(o=n.call(this,r)).onDirection=o.onDirection.bind(t._assertThisInitialized(o)),o.generateNumber=o.generateNumber.bind(t._assertThisInitialized(o)),o.id=ft(o.props.propertyId),o.reactIntl=r.controller.getReactIntl(),o}return e._createClass(i,[{key:"onDirection",value:function(e){var t=this.props.controller.getPropertyValue(this.props.propertyId);null==t&&(t=0);var r=t.toString().split(".")[1];this.props.control.increment=this.props.control.increment?this.props.control.increment:1;var o=this.props.control.increment.toString().split(".")[1],n="up"===e?Number(t)+this.props.control.increment:Number(t)-this.props.control.increment;if(o){var a=o.length;r&&(a=r.length>=o.length?r.length:o.length),this.props.controller.updatePropertyValue(this.props.propertyId,Number(n.toFixed(a)))}else this.props.controller.updatePropertyValue(this.props.propertyId,n)}},{key:"handleChange",value:function(e,t){if("string"!=typeof t)if(e.target.validity&&e.target.validity.badInput||!isFinite(e.target.value)){if(null===this.props.controller.getErrorMessage(this.props.propertyId)){var r={type:"error",text:o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.INVALID_NUMBER_ERROR),propertyId:this.props.propertyId,validation_id:"invalid_number"};this.props.controller.updateErrorMessage(this.props.propertyId,r)}}else{null!==this.props.controller.getErrorMessage(this.props.propertyId)&&"invalid_number"===this.props.controller.getErrorMessage(this.props.propertyId).validation_id&&this.props.controller.updateErrorMessage(this.props.propertyId,null);var n=e.target.value;null==n||""===n?this.props.controller.updatePropertyValue(this.props.propertyId,null):this.props.controller.updatePropertyValue(this.props.propertyId,Number(n))}else this.onDirection(t)}},{key:"generateNumber",value:function(){var e=this.props.control.label.numberGenerator,t=e.range&&e.range.min?e.range.min:1e4,r=e.range&&e.range.max?e.range.max:99999,o=Math.floor(Math.random()*(r-t+1)+t);this.props.controller.updatePropertyValue(this.props.propertyId,o)}},{key:"render",value:function(){var e=this,t="";null!==this.props.value&&void 0!==this.props.value&&(t=this.props.value);var r,n=this.props.state===u.STATES.DISABLED,i=this.props.state===u.STATES.HIDDEN;a.has_1(this.props.control,"label.numberGenerator")&&(r=O.default.createElement(l.Button,{className:u.classNames("properties-number-generator",{hide:i}),onClick:this.generateNumber,disabled:n,kind:"tertiary",renderIcon:d.Shuffle16,tooltipPosition:"bottom",tooltipAlignment:"end",iconDescription:this.props.control.label.numberGenerator.text,hasIconOnly:!0}));var s=u.classNames("properties-numberfield",{"numberfield-with-number-generator":a.has_1(this.props.control,"label.numberGenerator")?this.props.control.label.numberGenerator:null},{hide:i},this.props.messageInfo?this.props.messageInfo.type:null),p=bt(this.props.messageInfo,this.props.tableControl);return O.default.createElement("div",{className:s,"data-id":ht(this.props.propertyId)},O.default.createElement(l.NumberInput,u._extends({},p,{ref:function(t){return e.numberInput=t},id:this.id,onChange:this.handleChange.bind(this),disabled:n,step:this.props.control.increment,value:t,placeholder:this.props.control.additionalText,label:this.props.controlItem,hideLabel:this.props.tableControl,allowEmpty:!0,light:this.props.controller.getLight()&&this.props.control.light,hideSteppers:this.props.tableControl||this.props.control.controlType===o.ControlType.NUMBERFIELD})),r,O.default.createElement(fa,{inTable:this.props.tableControl,tableOnly:!0,state:this.props.state,messageInfo:this.props.messageInfo}))}}]),i}(O.default.Component),ka=c.connect((function(e,t){return{value:t.controller.getPropertyValue(t.propertyId),state:t.controller.getControlState(t.propertyId),messageInfo:t.controller.getErrorMessage(t.propertyId)}}),null)(Aa),Oa=C.toNumber_1,wa=1/0;var Na=function(e){return e?(e=Oa(e))===wa||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0};var Pa=function(e){var t=Na(e),r=t%1;return t==t?r?t-r:t:0},La=a._baseFindIndex,Da=s._baseIteratee,Ma=Pa,xa=Math.max;var Ba=function(e,t,r){var o=null==e?0:e.length;if(!o)return-1;var n=null==r?0:Ma(r);return n<0&&(n=xa(o+n,0)),La(e,Da(t),n)};function Fa(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var Va=function(r){t._inherits(n,r);var o=Fa(n);function n(r){var a;return e._classCallCheck(this,n),(a=o.call(this,r)).getCustomButtonEnabled=a.getCustomButtonEnabled.bind(t._assertThisInitialized(a)),a.customButtonIconCallback=a.customButtonIconCallback.bind(t._assertThisInitialized(a)),a.customButtonOnClick=a.customButtonOnClick.bind(t._assertThisInitialized(a)),a.convertToolbarConfig=a.convertToolbarConfig.bind(t._assertThisInitialized(a)),a}return e._createClass(n,[{key:"getCustomButtonEnabled",value:function(e,t){var r=void 0!==e&&e===u.STATES.DISABLED,o=this.props.customButtonsState&&void 0!==this.props.customButtonsState[t.id]?this.props.customButtonsState[t.id]:t.enabled||!1;return!r&&o}},{key:"customButtonIconCallback",value:function(e,t){var r,o=this.props.controller.getHandlers().buttonIconHandler;return o&&o({type:"customButtonIcon",propertyId:this.props.propertyId,buttonId:e,carbonIcon:t},(function(e){r=e})),r}},{key:"customButtonOnClick",value:function(e){var t=this.props.controller.getHandlers().buttonHandler;t&&t({type:"custom_button",propertyId:this.props.propertyId,buttonId:e})}},{key:"convertToolbarConfig",value:function(e){var t=this,r=[];return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]).forEach((function(o){var n=t.getCustomButtonEnabled(e,o),a={action:o.id,enable:n};o.icon?a.iconEnabled=o.icon:o.carbonIcon&&(a.iconEnabled=t.customButtonIconCallback(o.id,o.carbonIcon)),o.label&&(a.label=o.label.text,a.incLabelWithIcon="before",a.kind="ghost"),o.description&&(a.tooltip=o.description.text),o.divider&&"before"===o.divider&&r.push({divider:!0}),r.push(a),o.divider&&"after"===o.divider&&r.push({divider:!0})})),r}},{key:"render",value:function(){var e={leftBar:this.convertToolbarConfig(this.props.tableState,this.props.customButtons)};return O.default.createElement("div",{className:"properties-custom-table-buttons"},O.default.createElement(C.Toolbar,{config:e,instanceId:0,size:"sm",toolbarActionHandler:this.customButtonOnClick}))}}]),n}(O.default.Component),Ua=Va;function za(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var Ha=function(r){t._inherits(i,r);var a=za(i);function i(r){var o;return e._classCallCheck(this,i),(o=a.call(this,r)).showSubPanel=o.showSubPanel.bind(t._assertThisInitialized(o)),o.onSubPanelHidden=o.onSubPanelHidden.bind(t._assertThisInitialized(o)),o}return e._createClass(i,[{key:"onSubPanelHidden",value:function(e){e||(this.props.controller.updatePropertyValue(this.props.propertyId,this.initialControlValue),this.props.controller.setErrorMessages(this.initialMessages),this.props.controller.setControlStates(this.initialStates))}},{key:"showSubPanel",value:function(){this.initialControlValue=n.cloneDeep_1(this.props.controller.getPropertyValue(this.props.propertyId)),this.initialMessages=this.props.controller.getAllErrorMessages(),this.initialStates=this.props.controller.getControlStates(),this.subPanelInvoker.showSubDialog(this.props.title,this.props.panel,this.onSubPanelHidden)}},{key:"render",value:function(){var e=this,t=void 0!==this.props.disabled&&this.props.disabled,r=o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.SUBPANEL_BUTTON_TOOLTIP),n=o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.APPLYBUTTON_LABEL),a=o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.REJECTBUTTON_LABEL);return O.default.createElement(Ot,{ref:function(t){return e.subPanelInvoker=t},rightFlyout:this.props.rightFlyout,applyLabel:n,rejectLabel:a,controller:this.props.controller},O.default.createElement(y,{id:m.v4()+"-tooltip-subpanel-cell",tip:r,direction:"left",className:"properties-tooltips icon-tooltip"},O.default.createElement(l.Button,{className:"properties-subpanel-button",kind:"ghost",renderIcon:d.Settings16,onClick:this.showSubPanel,disabled:t,iconDescription:r,hasIconOnly:!0})))}}]),i}(O.default.Component);function ja(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Ga(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ga(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function Ga(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function qa(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var Ya=function(r){t._inherits(i,r);var a=qa(i);function i(r){var o;return e._classCallCheck(this,i),(o=a.call(this,r)).state={filterText:null,enableRemoveIcon:!1},o.onPanelContainer=[],o.allowColumnControls=!1,o.isReadonlyTable=o.isReadonlyTable.bind(t._assertThisInitialized(o)),o.indexOfColumn=o.indexOfColumn.bind(t._assertThisInitialized(o)),o.setCurrentControlValueSelected=o.setCurrentControlValueSelected.bind(t._assertThisInitialized(o)),o.setReadOnlyColumnValue=o.setReadOnlyColumnValue.bind(t._assertThisInitialized(o)),o.removeSelected=o.removeSelected.bind(t._assertThisInitialized(o)),o.updateRowSelections=o.updateRowSelections.bind(t._assertThisInitialized(o)),o.handleRowClick=o.handleRowClick.bind(t._assertThisInitialized(o)),o.createTable=o.createTable.bind(t._assertThisInitialized(o)),o.onFilter=o.onFilter.bind(t._assertThisInitialized(o)),o.onSort=o.onSort.bind(t._assertThisInitialized(o)),o.setScrollToRow=o.setScrollToRow.bind(t._assertThisInitialized(o)),o.includeInFilter=o.includeInFilter.bind(t._assertThisInitialized(o)),o.makeAddRemoveButtonPanel=o.makeAddRemoveButtonPanel.bind(t._assertThisInitialized(o)),o.makeEditButtonPanel=o.makeEditButtonPanel.bind(t._assertThisInitialized(o)),o.makeCustomButtonsPanel=o.makeCustomButtonsPanel.bind(t._assertThisInitialized(o)),o.buildChildItem=o.buildChildItem.bind(t._assertThisInitialized(o)),o.makeCells=o.makeCells.bind(t._assertThisInitialized(o)),o.checkedAll=o.checkedAll.bind(t._assertThisInitialized(o)),o.isLightTheme=o.isLightTheme.bind(t._assertThisInitialized(o)),r.selectedRows&&r.selectedRows.length>0&&(o.scrollToRow=r.selectedRows[r.selectedRows.length-1]),o.selectSummaryPropertyName="table-multi-select-edit-property-"+r.control.name,r.controller.saveControls([{name:o.selectSummaryPropertyName}]),o.setSelectedSummaryRowValue(r.selectedRows),o}return e._createClass(i,[{key:"componentDidMount",value:function(){if(this.props.control.subControls){var e=this.setReadOnlyColumnValue();this.props.controller.updatePropertyValue(this.props.propertyId,e,!0,u.UPDATE_TYPE.INITIAL_LOAD)}}},{key:"componentDidUpdate",value:function(){this.isSelectSummaryEdit(this.props.selectedRows)&&this.updateSelectedRowsValues()}},{key:"componentWillUnmount",value:function(){this.props.controller.removePropertyValue({name:this.selectSummaryPropertyName})}},{key:"onFilter",value:function(e){this.setState({filterText:e})}},{key:"onSort",value:function(e){for(var t=this.props.value,r=-1,n=0;n<this.props.control.subControls.length;n++)if(this.props.control.subControls[n].name===e.column){r=n;break}r>-1&&(t=o.sortBy_1(t,(function(e){return e[r]})),e.direction===u.SORT_DIRECTION.DESC&&t.reverse(),this.setCurrentControlValueSelected(t,[]))}},{key:"getOnPanelContainer",value:function(e){return 0===this.onPanelContainer.length||0===e.length||this.isSelectSummaryEdit(e)?O.default.createElement("div",null):O.default.createElement("div",{className:"properties-onpanel-container"},this.onPanelContainer[e[0]])}},{key:"getDefaultRow",value:function(){var e=[];if(this.props.control.defaultRow){var t,r=ja(this.props.control.defaultRow);try{for(r.s();!(t=r.n()).done;){var o=t.value;null!=o&&o.parameterRef?e.push(this.props.controller.getPropertyValue({name:o.parameterRef})):e.push(o)}}catch(e){r.e(e)}finally{r.f()}}return e}},{key:"setScrollToRow",value:function(e){this.scrollToRow=e}},{key:"setCurrentControlValueSelected",value:function(e,t){var r=e;if(this.props.control.subControls&&(r=this.setReadOnlyColumnValue(e)),Array.isArray(r))for(var n=0;n<r.length;n++){var a=r[n];if(Array.isArray(a))for(var i=0;i<this.props.control.subControls.length;i++){var s=this.props.control.subControls[i];"column"===s.role&&"structure"===s.valueDef.propType&&(r[n][i]=o.fieldStringToValue(a[i],s,this.props.controller))}else"column"===this.props.control.role&&"structure"===this.props.control.valueDef.propType&&(r[n]=o.fieldStringToValue(a,this.props.control,this.props.controller))}this.props.controller.updatePropertyValue(this.props.propertyId,r);var l=Array.isArray(t)?t:[];this.updateRowSelections(l)}},{key:"setReadOnlyColumnValue",value:function(e){var t=e||this.props.value;if(!Array.isArray(t))return t;for(var r=0;r<t.length;r++)for(var n=0;n<this.props.control.subControls.length;n++){var a=this.props.control.subControls[n];if(a.controlType===o.ControlType.READONLY&&a.generatedValues&&"index"===a.generatedValues.operation){var i=void 0!==a.generatedValues.startValue?a.generatedValues.startValue+r:r+1;t[r][n]=i}}return t}},{key:"setSelectedSummaryRowValue",value:function(e){if(this.isSelectSummaryEdit(e)){var t={name:this.selectSummaryPropertyName},r=this.props.controller.getPropertyValue(t);r||(r=[this.getDefaultRow()],this.props.controller.updatePropertyValue(t,r,!0)),this.selectedSummaryRowValue=n.cloneDeep_1(r)}}},{key:"isSelectSummaryEdit",value:function(e){return this.props.control.rowSelection===u.ROW_SELECTION.MULTIPLE&&e.length>1}},{key:"isReadonlyTable",value:function(){return this.props.control.controlType===o.ControlType.READONLYTABLE}},{key:"indexOfColumn",value:function(e){return Ba(this.props.control.subControls,(function(t){return t.name===e}))}},{key:"handleRowClick",value:function(e,t){var r=this.props.selectedRows;if(this.props.control.rowSelection===u.ROW_SELECTION.SINGLE)r=[e];else if(!0===t.metaKey||!0===t.ctrlKey){var o=r.indexOf(e);o>=0?r.splice(o,1):r=r.concat(e)}else if(!0===t.shiftKey){for(var n=r.length>0?r[0]:e,a=(n>e?n:e)+1,i=[],s=n>e?e:n;s<a;s++)i.push(s);r=i}this.updateRowSelections(r)}},{key:"updateSelectedRowsValues",value:function(){var e=this,t={name:this.selectSummaryPropertyName},r=this.props.controller.getControl({name:this.props.control.name}),a=this.props.controller.getPropertyValue(t);a&&Array.isArray(a)&&(a[0].forEach((function(t,n){if(null!==t&&!o.isEqual_1(t,e.selectedSummaryRowValue[0][n])){var a=void 0===t?null:t;e.props.selectedRows.forEach((function(t){e.props.controller.updatePropertyValue({name:e.props.control.name,row:t,col:n},a,!0)})),r.subControls[n].controlType===o.ControlType.ONEOFSELECT&&e.props.controller.updatePropertyValue({name:e.selectSummaryPropertyName,row:0,col:n},null)}})),this.selectedSummaryRowValue=n.cloneDeep_1(a))}},{key:"updateRowSelections",value:function(e){this.props.controller.updateSelectedRows(this.props.propertyId,e),this.props.rightFlyout&&this.setState({enableRemoveIcon:0!==e.length}),this.setSelectedSummaryRowValue(e)}},{key:"removeSelected",value:function(){for(var e=this.props.value,t=this.props.selectedRows.sort((function(e,t){return t-e})),r=0;r<t.length;r++)e.splice(t[r],1),this.props.controller.removeErrorMessageRow({name:this.props.propertyId.name,row:t[r]});this.setCurrentControlValueSelected(e)}},{key:"_makeCell",value:function(e,t,r,a,i,s,l){var p={name:r,row:a,col:i},c=n.cloneDeep_1(this.props.propertyId),d=p;l||c.name===p.name||(d=this.props.controller.setChildPropertyId(c,p));var f,h={table:!0,allowColumnControls:this.allowColumnControls},m=this.props.controller.getControlFactory(),y=Object.assign({},e),v=y.className?y.className:"";if(e.dmImage){var g=this.props.controller.getDatasetMetadataFields(),b=o.stringifyFieldValue(this.props.controller.getPropertyValue(d),e,!0);y.icon=o.getDMFieldIcon(g,b,e.dmImage)}return this.isReadonlyTable()?f=O.default.createElement("div",{className:u.classNames("properties-table-cell-control",v)},O.default.createElement(ya,{control:this.props.controller.getControl(d),propertyId:d,controller:this.props.controller,tableControl:!0})):e.editStyle===o.EditStyle.SUBPANEL||e.editStyle===o.EditStyle.ON_PANEL?l?f=O.default.createElement("div",null):(f=O.default.createElement("div",{className:u.classNames("properties-table-cell-control",v)},O.default.createElement(ya,{control:this.props.controller.getControl(d),propertyId:d,controller:this.props.controller,tableControl:!0})),e.editStyle===o.EditStyle.ON_PANEL&&this.onPanelContainer[a].push(O.default.createElement("div",{key:i},O.default.createElement("br",null),m.createControlItem(e,d)))):(h.editStyle=o.EditStyle.INLINE,f=O.default.createElement("div",{className:u.classNames("properties-table-cell-control",v)},m.createControl(y,d,h))),{column:e.name,width:e.width,content:f,className:v,value:this.props.controller.getPropertyValue(d),resizable:e.resizable}}},{key:"_getCustomCtrlContent",value:function(e,t,r,n){var a=r;return t.controlType===o.ControlType.CUSTOM&&(n.editStyle="summary",a=this.props.controller.getCustomControl(e,t,n)),a}},{key:"_getDisabledStatus",value:function(e,t){return void 0!==t&&t===u.STATES.DISABLED||this.props.controller.getControlState(e)===u.STATES.DISABLED}},{key:"includeInFilter",value:function(e){if(!this.state.filterText||0===this.state.filterText.length)return!0;for(var t=this.props.value,r=0;r<this.filterFields.length;r++)for(var o=0;o<this.props.control.subControls.length;o++){if(this.props.control.subControls[o].name===this.filterFields[r]){var n=t[e][o];if("string"==typeof n&&n.toLowerCase().indexOf(this.state.filterText.toLowerCase())>-1)return!0;break}}return!1}},{key:"hasFilter",value:function(){var e=!1;if(this.props.control.subControls){var t,r=ja(this.props.control.subControls);try{for(r.s();!(t=r.n()).done;){if(t.value.filterable){e=!0;break}}}catch(e){r.e(e)}finally{r.f()}}return e}},{key:"addOnClick",value:function(e){this.addOnClickCallback&&this.addOnClickCallback(e,this.onFieldPickerCloseCallback)}},{key:"isLightTheme",value:function(){return this.props.controller.getLight()&&this.props.control.light}},{key:"makeSelectedEditRow",value:function(e){if(e&&Array.isArray(e)&&e.length>1){var t=o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.MULTI_SELECTED_ROW_LABEL),r=o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.MULTI_SELECTED_ROW_ACTION),n=e.length+" "+t+" "+r,a=[],i=!1===this.props.control.header?[]:this.makeHeader([],[]),l=this.props.controller.getPropertyValue({name:this.selectSummaryPropertyName});this.makeCells(a,l,null,this.selectSummaryPropertyName,!0);var p=this.props.control.label&&this.props.control.label.text?this.props.control.label.text:"";return O.default.createElement("div",{className:"properties-at-selectedEditRows"},O.default.createElement("div",{className:"properties-selectedEditRows-title"},O.default.createElement("span",null,n)),O.default.createElement(s.FlexibleTable,{showHeader:!1,columns:i,data:a,rows:0,scrollKey:this.selectSummaryPropertyName,tableLabel:p,summaryTable:!0,rowSelection:u.ROW_SELECTION.MULTIPLE,light:this.isLightTheme(),emptyTablePlaceholder:this.props.control.additionalText}))}return null}},{key:"makeAddRemoveButtonPanel",value:function(e,t){this.onFieldPickerCloseCallback=t&&t.fieldPickerCloseFunction?t.fieldPickerCloseFunction.bind(this):null;var r=t&&t.removeButtonFunction?t.removeButtonFunction:this.removeSelected,n=t&&t.removeButtonLabel?t.removeButtonLabel:o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.STRUCTURETABLE_REMOVEBUTTON_LABEL),a=!this.state.enableRemoveIcon||e===u.STATES.DISABLED,i=!1;this.addOnClickCallback=t&&t.addButtonFunction?t.addButtonFunction:this.props.openFieldPicker;var s=t&&t.addButtonLabel?t.addButtonLabel:o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.STRUCTURETABLE_ADDBUTTON_LABEL);return e===u.STATES.DISABLED&&(i=!0,this.addOnClickCallback=null),O.default.createElement("div",{className:"properties-at-buttons-container"},O.default.createElement(l.Button,{className:"properties-remove-fields-button",disabled:a,onClick:r,size:"small",kind:"ghost",renderIcon:d.TrashCan16},n),O.default.createElement(l.Button,{className:"properties-add-fields-button",disabled:i,onClick:this.addOnClick.bind(this,this.props.propertyId),size:"small",kind:"ghost",renderIcon:d.Add16},s))}},{key:"makeEditButtonPanel",value:function(e,t){var r=null;return t&&t.editCallback&&(this.editOnClickCallback=t.editCallback,r=O.default.createElement("div",{className:"properties-at-buttons-container"},O.default.createElement(l.Button,{className:"properties-edit-button",onClick:this.editOnClick.bind(this,this.props.propertyId),size:"small",kind:"ghost",renderIcon:d.Edit16},t.label))),r}},{key:"makeCustomButtonsPanel",value:function(e,t){var r=null;return t&&(r=O.default.createElement("div",{className:"properties-at-buttons-container"},O.default.createElement(Ua,{controller:this.props.controller,propertyId:this.props.propertyId,tableState:e,customButtons:t,customButtonsState:this.props.tableButtons}))),r}},{key:"editOnClick",value:function(e){this.editOnClickCallback&&this.editOnClickCallback(e)}},{key:"checkedAllValue",value:function(e,t){var r=this.props.value;if(Array.isArray(r)){for(var o=0;o<r.length;o++){var n={name:this.props.control.name,row:o,col:e};this.props.controller.getControlState(n)!==u.STATES.DISABLED&&this.props.controller.updatePropertyValue(n,t)}this.checkedAll[e]=t}}},{key:"checkedAll",value:function(e){var t=this.props.value;if(!Array.isArray(t))return!1;if(0===t.length)return!1;for(var r=0;r<t.length;r++){var o={name:this.props.control.name,row:r,col:e};if(this.props.controller.getControlState(o)!==u.STATES.DISABLED&&!t[r][e])return!1}return!0}},{key:"disabledAll",value:function(e){var t=this.props.value;if(!Array.isArray(t))return!1;if(0===t.length)return!1;var r,o=ja(t);try{for(o.s();!(r=o.n()).done;){if(!1===r.value[e])return!1}}catch(e){o.e(e)}finally{o.f()}return!0}},{key:"createTable",value:function(e,t,r){var o=[],n=[],a=[];this.filterFields=a;var i=this.makeHeader(n,a),l=!1!==this.props.control.header,p=this.props.value;this.makeCells(o,p,e);var c,d=this.props.control.rowSelection===u.ROW_SELECTION.MULTIPLE?this.makeSelectedEditRow(this.props.selectedRows):null,f=null;r?f=this.makeCustomButtonsPanel(e,r):this.isReadonlyTable()?this.props.hideEditButton||(f=this.makeEditButtonPanel(e,t)):this.props.addRemoveRows&&(f=this.makeAddRemoveButtonPanel(e,t)),Number.isInteger(this.scrollToRow)&&o.length>this.scrollToRow&&(c=this.scrollToRow,delete this.scrollToRow);var h,m=this.props.control.label&&this.props.control.label.text?this.props.control.label.text:"";this.isReadonlyTable()&&this.props.control.rowSelection===u.ROW_SELECTION.SINGLE||(h=this.props.control.rowSelection===u.ROW_SELECTION.SINGLE?this.handleRowClick:this.updateRowSelections);var y=O.default.createElement(s.FlexibleTable,{sortable:n,filterable:a,columns:i,data:o,showHeader:l,scrollToRow:c,onFilter:this.onFilter,onSort:this.onSort,topRightPanel:f,selectedEditRow:d,scrollKey:this.props.control.name,tableState:e,messageInfo:this.props.controller.getErrorMessage(this.props.propertyId),rows:this.props.control.rows,tableLabel:m,updateRowSelections:h,selectedRows:this.props.selectedRows,rowSelection:this.props.control.rowSelection,light:this.isLightTheme(),emptyTablePlaceholder:this.props.control.additionalText});return O.default.createElement("div",null,y)}},{key:"makeHeader",value:function(e,t){for(var r=[],n=0;n<this.props.control.subControls.length;n++){var a=this.props.control.subControls[n],i=this.props.control.name+n,s=this.props.controller.getControlState({name:this.props.control.name,col:n}),p=s===u.STATES.DISABLED||s===u.STATES.HIDDEN,c=a.controlType===o.ControlType.CHECKBOX?O.default.createElement(l.Checkbox,{disabled:p,id:i,checked:this.checkedAll(n),onChange:this.checkedAllValue.bind(this,n),labelText:a.label.text}):a.label.text;a.visible&&a.controlType!==o.ControlType.HIDDEN&&(a.sortable&&e.push(a.name),r.push({key:a.name,label:c,width:a.width,description:a.description?a.description.text:null,resizable:!!a.resizable&&a.resizable,operation:a.generatedValues&&a.generatedValues.operation?a.generatedValues.operation:null}),a.filterable&&t.push(a.name))}return this.props.control.childItem&&!this.isReadonlyTable()&&r.push({key:"subpanel",label:"",width:u.TABLE_SUBPANEL_BUTTON_WIDTH,staticWidth:!0}),r}},{key:"makeCells",value:function(e,t,r,n,a){if(Array.isArray(t))for(var i=n||this.props.control.name,s=0;s<t.length;s++){var l=[];if(this.onPanelContainer[s]=[],this.includeInFilter(s)||a){for(var u=0;u<this.props.control.subControls.length;u++){var p=this.props.control.subControls[u];if(p.visible||p.editStyle===o.EditStyle.ON_PANEL){var c=this._makeCell(p,t,i,s,u,r,a);p.visible&&l.push(c)}}if(this.props.control.childItem&&!a&&!this.isReadonlyTable()){var d=this.buildChildItem(i,s,r);l.push(d)}e.push({columns:l})}}}},{key:"buildChildItem",value:function(e,t,r){var o={name:e,row:t},a=n.cloneDeep_1(this.props.propertyId),i=o;a.name!==o.name&&(i=this.props.controller.setChildPropertyId(a,o));var s=this.props.buildUIItem(t,this.props.control.childItem,i,this.indexOfColumn),l=O.default.createElement("div",{className:"properties-table-subcell"},O.default.createElement(Ha,{label:s.props.label,title:s.props.title,panel:s.props.panel,disabled:r===u.STATES.DISABLED,controller:this.props.controller,propertyId:this.props.propertyId,rightFlyout:this.props.rightFlyout}));return{column:"subpanel",width:u.TABLE_SUBPANEL_BUTTON_WIDTH,content:l}}}],[{key:"getDerivedStateFromProps",value:function(e,t){var r=0!==e.selectedRows.length;return t.enableRemoveIcon!==r?{enableRemoveIcon:r}:{}}}]),i}(O.default.Component);function Ka(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}Ya.defaultProps={addRemoveRows:!0,hideEditButton:!1};var Wa=function(r){t._inherits(a,r);var n=Ka(a);function a(r){var o;return e._classCallCheck(this,a),(o=n.call(this,r)).getEmptyTableText=o.getEmptyTableText.bind(t._assertThisInitialized(o)),o.isReadonlyTable=o.isReadonlyTable.bind(t._assertThisInitialized(o)),o}return e._createClass(a,[{key:"getEmptyTableText",value:function(){var e="".concat(this.props.control.name,".empty.table.text"),t=o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.PROPERTIES_EMPTY_TABLE_TEXT,{button_label:this.props.emptyTableButtonLabel});return this.props.controller.getResource(e,t)}},{key:"isReadonlyTable",value:function(){return this.props.control.controlType===o.ControlType.READONLYTABLE}},{key:"render",value:function(){var e=this.getEmptyTableText();return O.default.createElement("div",{className:"properties-empty-table",disabled:this.props.disabled},O.default.createElement("span",null,e),O.default.createElement("br",null),O.default.createElement(l.Button,{className:"properties-empty-table-button",kind:"tertiary",size:"small",renderIcon:this.isReadonlyTable()?d.Edit16:d.Add16,onClick:this.props.emptyTableButtonClickHandler,disabled:this.props.disabled},this.props.emptyTableButtonLabel))}}]),a}(O.default.Component),Xa=Wa;function $a(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var Ja=function(r){t._inherits(a,r);var n=$a(a);function a(r){var o;return e._classCallCheck(this,a),(o=n.call(this,r)).getTableRowMoveImages=o.getTableRowMoveImages.bind(t._assertThisInitialized(o)),o.topMoveRow=o.topMoveRow.bind(t._assertThisInitialized(o)),o.upMoveRow=o.upMoveRow.bind(t._assertThisInitialized(o)),o.downMoveRow=o.downMoveRow.bind(t._assertThisInitialized(o)),o.bottomMoveRow=o.bottomMoveRow.bind(t._assertThisInitialized(o)),o.getMoveableTableRows=o.getMoveableTableRows.bind(t._assertThisInitialized(o)),o.getLeastValue=o.getLeastValue.bind(t._assertThisInitialized(o)),o.getMaxValue=o.getMaxValue.bind(t._assertThisInitialized(o)),o}return e._createClass(a,[{key:"getMoveableTableRows",value:function(){var e=null;if(void 0!==this.props.control.moveableRows&&this.props.control.moveableRows){var t=this.getTableRowMoveImages();e=O.default.createElement("div",{className:"properties-mr-button-container"},t)}var r=O.default.createElement("table",{role:"presentation",className:"properties-mr-table-container"},O.default.createElement("tbody",null,O.default.createElement("tr",{className:u.classNames("properties-mr-table-content",{disabled:this.props.disabled})},O.default.createElement("td",null,this.props.tableContainer),O.default.createElement("td",null,e))));return O.default.createElement("div",null,r)}},{key:"getTableRowMoveImages",value:function(){var e=this.props.controller.getSelectedRows(this.props.propertyId).sort(),t=this.props.controller.getPropertyValue(this.props.propertyId),r=!this.props.disableRowMoveButtons&&0!==e.length&&0!==e[0]&&!this.props.disabled,n=!this.props.disableRowMoveButtons&&0!==e.length&&e[e.length-1]!==t.length-1&&!this.props.disabled,a=this.props.controller.getStaticRows(this.props.propertyId).sort();e.length>0&&a.length>0&&a.includes(e[0])?(r=!1,n=!1):e[0]===a[a.length-1]+1?(r=!1,n=!this.props.disableRowMoveButtons&&0!==e.length&&e[e.length-1]!==t.length-1&&!this.props.disabled):e[0]===a[0]-1&&(n=!1);var i=o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.MOVEABLE_TABLE_BUTTON_TOP_DESCRIPTION),s=o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.MOVEABLE_TABLE_BUTTON_UP_DESCRIPTION),p=O.default.createElement("div",{key:"topImages"},O.default.createElement(l.Button,{className:"table-row-move-button",onClick:this.topMoveRow,disabled:!r,kind:"ghost",renderIcon:d.UpToTop24,iconDescription:i,tooltipPosition:"left",hasIconOnly:!0}),O.default.createElement(l.Button,{className:"table-row-move-button",onClick:this.upMoveRow,disabled:!r,kind:"ghost",renderIcon:d.ArrowUp24,iconDescription:s,tooltipPosition:"left",hasIconOnly:!0})),c=o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.MOVEABLE_TABLE_BUTTON_DOWN_DESCRIPTION),f=o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.MOVEABLE_TABLE_BUTTON_BOTTOM_DESCRIPTION);return[p,O.default.createElement("div",{key:"bottomImages"},O.default.createElement(l.Button,{className:"table-row-move-button",onClick:this.downMoveRow,disabled:!n,kind:"ghost",renderIcon:d.ArrowDown24,iconDescription:c,tooltipPosition:"left",hasIconOnly:!0}),O.default.createElement(l.Button,{className:"table-row-move-button",onClick:this.bottomMoveRow,disabled:!n,kind:"ghost",renderIcon:d.DownToBottom24,iconDescription:f,tooltipPosition:"left",hasIconOnly:!0}))]}},{key:"getLeastValue",value:function(){var e=0,t=this.props.controller.getStaticRows(this.props.propertyId).sort();return t&&t.length>0&&t.includes(0)&&(e=t[t.length-1]),e}},{key:"getMaxValue",value:function(){var e=this.props.controller.getPropertyValue(this.props.propertyId),t=e.length-1,r=this.props.controller.getStaticRows(this.props.propertyId).sort();return r&&r.length>0&&r.includes(e.length-1)&&(t=r[0]-1),t}},{key:"topMoveRow",value:function(e){for(var t=this.props.controller.getSelectedRows(this.props.propertyId).sort((function(e,t){return e-t})),r=this.props.controller.getPropertyValue(this.props.propertyId),o=this.getLeastValue(),n=this.props.controller.getStaticRows(this.props.propertyId).sort(),a=t[0];a>o;a--)for(var i=0;i<=t.length-1;i++)if(n.length>0&&t[0]>o+1||0===n.length){var s=t.shift(),l=r[s-1];r[s-1]=r[s],r[s]=l,t.push(s-1),this.props.controller.moveErrorMessageRows(this.props.propertyId.name,s,s-1)}t.length>0&&this.props.setScrollToRow(t[0]),this.props.setCurrentControlValueSelected(r,t)}},{key:"upMoveRow",value:function(e){var t=this.props.controller.getSelectedRows(this.props.propertyId).sort((function(e,t){return e-t})),r=this.getLeastValue(),o=this.props.controller.getStaticRows(this.props.propertyId).sort();if(0!==t.length&&t[0]>r){for(var n=this.props.controller.getPropertyValue(this.props.propertyId),a=0;a<=t.length-1;a++)if(o.length>0&&t[0]>r+1){var i=t.shift(),s=n[i-1];n[i-1]=n[i],n[i]=s,t.push(i-1),this.props.controller.moveErrorMessageRows(this.props.propertyId.name,i,i-1)}else if(0===o.length){var l=t.shift();if(0!==l){var u=n[l-1];n[l-1]=n[l],n[l]=u,t.push(l-1),this.props.controller.moveErrorMessageRows(this.props.propertyId.name,l,l-1)}}this.props.setScrollToRow(t[0]),this.props.setCurrentControlValueSelected(n,t)}}},{key:"downMoveRow",value:function(e){var t=this.props.controller.getSelectedRows(this.props.propertyId).sort((function(e,t){return e-t})),r=this.props.controller.getPropertyValue(this.props.propertyId),o=this.getMaxValue();if(0!==t.length&&t[t.length-1]!==r.length-1){for(var n=t.length-1;n>=0;n--){var a=t.pop();if(a!==o){var i=r[a+1];r[a+1]=r[a],r[a]=i,t.unshift(a+1),this.props.controller.moveErrorMessageRows(this.props.propertyId.name,a,a+1)}}t.length>1?this.props.setScrollToRow(t[t.length-1]):this.props.setScrollToRow(t[0]),this.props.setCurrentControlValueSelected(r,t)}}},{key:"bottomMoveRow",value:function(e){for(var t=this.props.controller.getSelectedRows(this.props.propertyId).sort((function(e,t){return e-t})),r=this.props.controller.getPropertyValue(this.props.propertyId),o=this.getMaxValue(),n=t[t.length-1];n<o;n++)for(var a=t.length-1;a>=0;a--){var i=t.pop(),s=r[i+1];r[i+1]=r[i],r[i]=s,t.unshift(i+1),this.props.controller.moveErrorMessageRows(this.props.propertyId.name,i,i+1)}t.length>0&&this.props.setScrollToRow(t[t.length-1]),this.props.setCurrentControlValueSelected(r,t)}},{key:"render",value:function(){return this.props.isEmptyTable&&this.props.addRemoveRows?O.default.createElement(Xa,{control:this.props.control,controller:this.props.controller,emptyTableButtonLabel:this.props.emptyTableButtonLabel,emptyTableButtonClickHandler:this.props.emptyTableButtonClickHandler,disabled:this.props.disabled}):this.getMoveableTableRows()}}]),a}(O.default.Component);Ja.defaultProps={addRemoveRows:!0};var Za=c.connect((function(e,t){return{disableRowMoveButtons:t.controller.isDisableRowMoveButtons(t.propertyId),addRemoveRows:t.controller.getAddRemoveRows(t.propertyId),tableButtons:t.controller.getTableButtons(t.propertyId)}}))(Ja);function Qa(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var ei=[o.Type.INTEGER,o.Type.DOUBLE,o.Type.LONG],ti=function(r){t._inherits(i,r);var n=Qa(i);function i(r){var o;return e._classCallCheck(this,i),(o=n.call(this,r)).addRow=o.addRow.bind(t._assertThisInitialized(o)),o.reactIntl=r.controller.getReactIntl(),o}return e._createClass(i,[{key:"addRow",value:function(){var e=this.props.controller.getControlPropType(this.props.propertyId),t=ei.indexOf(e)>-1?null:"",r=this.props.controller.getPropertyValue(this.props.propertyId);void 0===r&&(r=[]);var o=r.concat([t]);this.setCurrentControlValueSelected(o)}},{key:"makeCell",value:function(e,t,r,o){return ei.indexOf(r)>-1?O.default.createElement("div",{className:"properties-table-cell-control"},O.default.createElement(ka,{control:e,propertyId:t,controller:this.props.controller,controlItem:o,tableControl:!0})):O.default.createElement("div",{className:"properties-table-cell-control"},O.default.createElement(ba,{control:e,propertyId:t,controller:this.props.controller,controlItem:o,tableControl:!0}))}},{key:"makeRows",value:function(e,t,r){var o=[];if(e)for(var n=0;n<e.length;n++){var a=[],i={name:this.props.control.name,row:n};if(this.props.propertyId.name!==i.name){var s=Object.assign({},this.props.propertyId);i=this.props.controller.setChildPropertyId(s,{name:this.props.control.name,row:n})}var l=this.props.controller.getControlPropType(i),u=void 0===r||0===r.length?"":r[0].label,p=this.makeCell({},i,l,u);a.push({key:n+"-0-value",column:"value",content:p}),o.push({key:n,onClickCallback:this.handleRowClick.bind(this,n,!1),columns:a,className:"list-table-row"})}return o}},{key:"makeHeader",value:function(){var e=[];return e.push({key:"value",label:o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.LIST_TABLE_LABEL),description:null}),e}},{key:"render",value:function(){var e,t=this.makeHeader(),r={addButtonLabel:o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.STRUCTURELISTEDITOR_ADDBUTTON_LABEL),removeButtonLabel:o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.STRUCTURELISTEDITOR_REMOVEBUTTON_LABEL),addButtonFunction:this.addRow},n=this.makeRows(this.props.value,this.props.state,t),i=this.makeAddRemoveButtonPanel(this.props.state,r);Number.isInteger(this.scrollToRow)&&n.length>this.scrollToRow&&(e=this.scrollToRow,delete this.scrollToRow);var l=this.props.control.label&&this.props.control.label.text?this.props.control.label.text:"",p=O.default.createElement(s.FlexibleTable,{columns:t,data:n,scrollToRow:e,topRightPanel:i,scrollKey:this.props.control.name,tableState:this.props.state,messageInfo:this.props.messageInfo,rows:this.props.control.rows,tableLabel:l,selectedRows:this.props.selectedRows,rowSelection:this.props.control.rowSelection,updateRowSelections:this.updateRowSelections,light:this.props.controller.getLight()&&this.props.control.light,emptyTablePlaceholder:this.props.control.additionalText}),c=O.default.createElement("div",null,O.default.createElement("div",{className:"properties-list-table"},p),O.default.createElement(fa,{state:this.props.state,messageInfo:this.props.messageInfo}));return O.default.createElement("div",{"data-id":ht(this.props.propertyId),className:"properties-list-control"},this.props.controlItem,O.default.createElement(Za,{tableContainer:c,control:this.props.control,controller:this.props.controller,propertyId:this.props.propertyId,setScrollToRow:this.setScrollToRow,setCurrentControlValueSelected:this.setCurrentControlValueSelected,disabled:this.props.state===u.STATES.DISABLED,isEmptyTable:a.isEmpty_1(this.props.value),emptyTableButtonLabel:r.addButtonLabel,emptyTableButtonClickHandler:this.addRow}))}}]),i}(Ya);ti.propTypes={control:L.default.object.isRequired,propertyId:L.default.object.isRequired,controller:L.default.object.isRequired,controlItem:L.default.element,selectedRows:L.default.array,state:L.default.string,value:L.default.array,messageInfo:L.default.object,addRemoveRows:L.default.bool,tableButtons:L.default.object};var ri=c.connect((function(e,t){return{value:t.controller.getPropertyValue(t.propertyId),state:t.controller.getControlState(t.propertyId),messageInfo:t.controller.getErrorMessage(t.propertyId),selectedRows:t.controller.getSelectedRows(t.propertyId),addRemoveRows:t.controller.getAddRemoveRows(t.propertyId),tableButtons:t.controller.getTableButtons(t.propertyId)}}))(ti);function oi(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var ni=new RegExp("[0-9- _$]","g"),ai=function(r){t._inherits(i,r);var n=oi(i);function i(r){var s;return e._classCallCheck(this,i),(s=n.call(this,r)).reactIntl=r.controller.getReactIntl(),s.valueColumn=o.formatMessage(s.reactIntl,u.MESSAGE_KEYS.EXPRESSION_VALUE_COLUMN),s.valueColumnDesc=o.formatMessage(s.reactIntl,u.MESSAGE_KEYS.EXPRESSION_VALUE_COLUMN_DESCRIPTION),s.recentUseCat=o.formatMessage(s.reactIntl,u.MESSAGE_KEYS.EXPRESSION_RECENTLY_USED),s.recentUseCatInfo={id:s.recentUseCat,locLabel:s.recentUseCat,field_columns:{field_column_info:{locLabel:o.formatMessage(s.reactIntl,u.MESSAGE_KEYS.EXPRESSION_RECENTLY_USED_COLUMN)},value_column_info:{locLabel:s.valueColumn,descLabel:s.valueColumnDesc}}},s.inCategories=Object.keys(r.functionList),s.fields=s._makeDatasetFields(r.controller.getDatasetMetadataFields(),r.controller.getExpressionInfo().fields),s.resources=a.get_1(r.controller.getExpressionInfo(),"resources",{}),s.state={fieldSelected:0,valueSelected:0,functionSelected:0,fieldTableSortSpec:null,valuesTableSortSpec:null,functionTableSortSpec:null,functionCategory:s.inCategories[0],selectedIndex:0,fieldCategory:"fields",currentFieldDataset:s.fields.field_table_info[0].field_value_groups},s.controller=r.controller,s.onFunctionCatChange=s.onFunctionCatChange.bind(t._assertThisInitialized(s)),s.onFieldCatChange=s.onFieldCatChange.bind(t._assertThisInitialized(s)),s.onFieldFilter=s.onFieldFilter.bind(t._assertThisInitialized(s)),s.onValueFilter=s.onValueFilter.bind(t._assertThisInitialized(s)),s.onFunctionFilter=s.onFunctionFilter.bind(t._assertThisInitialized(s)),s.language=r.language,s.onFieldTableClick=s.onFieldTableClick.bind(t._assertThisInitialized(s)),s.onFieldTableDblClick=s.onFieldTableDblClick.bind(t._assertThisInitialized(s)),s.onFunctionTableClick=s.onFunctionTableClick.bind(t._assertThisInitialized(s)),s.onFunctionTableDblClick=s.onFunctionTableDblClick.bind(t._assertThisInitialized(s)),s.onValueTableClick=s.onValueTableClick.bind(t._assertThisInitialized(s)),s.onValueTableDblClick=s.onValueTableDblClick.bind(t._assertThisInitialized(s)),s.sortTableRows=s.sortTableRows.bind(t._assertThisInitialized(s)),s.shouldQuoteField=s.shouldQuoteField.bind(t._assertThisInitialized(s)),s}return e._createClass(i,[{key:"onSwitch",value:function(e,t){this.setState({selectedIndex:e.index})}},{key:"onFunctionCatChange",value:function(e){this.setState({functionCategory:e.selectedItem.value,functionSelected:0})}},{key:"onFieldCatChange",value:function(e){var t=[];if(e.selectedItem.value===this.recentUseCat)t=this.props.controller.getExpressionFieldsRecentlyUsed();else for(var r=0;r<this.fields.field_table_info.length;r++)e.selectedItem.value===this.fields.field_table_info[r].id&&(t=this.fields.field_table_info[r].field_value_groups);this.setState({fieldCategory:e.selectedItem.value,fieldSelected:0,currentFieldDataset:t})}},{key:"onFieldTableClick",value:function(e,t,r){this.setState({fieldSelected:r,valueSelected:0})}},{key:"onFieldTableDblClick",value:function(e,t,r){var o=this.state.currentFieldDataset[t],n=o.id;if(this.state.fieldCategory!==this.recentUseCat&&this.props.controller.updateExpressionFieldsRecentlyUsed(o),this.props.onChange){var a="CLEM"===this.language&&"globals"!==this.state.fieldCategory?"'":"";this.shouldQuoteField(o.id)&&(n=a+o.id+a),this.props.onChange(n)}}},{key:"onFieldFilter",value:function(e){this.setState({fieldFilterText:e})}},{key:"onValueTableClick",value:function(e,t,r){this.setState({valueSelected:r})}},{key:"onValueTableDblClick",value:function(e,t,r){if(this.props.onChange){var o=this.state.currentFieldDataset[this.state.fieldSelected],n='"';if(o.values){var a=o.values[t].value,i="string"==typeof a?n+a+n:a;this.props.onChange(i)}else if(o.range){var s="string"==typeof o.range.min.value?n+o.range.min.value+n:o.range.min.value,l="string"==typeof o.range.max.value?n+o.range.max.value+n:o.range.max.value;this.props.onChange(0===t?s:l)}}this.setState({valueSelected:t})}},{key:"onValueFilter",value:function(e){this.setState({valueFilterText:e})}},{key:"onFunctionTableClick",value:function(e,t,r){this.setState({functionSelected:r})}},{key:"onFunctionTableDblClick",value:function(e,t,r){var o;this.state.functionCategory===this.recentUseCat?o=this.props.controller.getExpressionRecentlyUsed()[t]:(o=this.props.functionList[this.state.functionCategory].functionList[t],this.props.controller.updateExpressionRecentlyUsed(o));var n=o.value;this.props.onChange&&this.props.onChange(n)}},{key:"onFunctionFilter",value:function(e){this.setState({functionFilterText:e})}},{key:"setSortColumn",value:function(e,t){switch(e){case"fieldTable":this.setState({fieldTableSortSpec:t});break;case"valuesTable":this.setState({valuesTableSortSpec:t});break;case"functionTable":this.setState({functionTableSortSpec:t})}}},{key:"sortTableRows",value:function(e,t){var r=0;if(e.length>0){for(var n=e[0].columns,a=0;a<n.length;a++)if(n[a].column===t.column){r=a;break}var i=o.sortBy_1(e,(function(e){return e.columns[r].value}));return t.direction===u.SORT_DIRECTION.DESC&&i.reverse(),i}return e}},{key:"shouldQuoteField",value:function(e){return null!==e.match(ni)}},{key:"createContentObject",value:function(e){var t=!0;e&&(t=!1);var r=O.default.createElement("span",{className:"properties-expr-table-cell"},e),n=O.default.createElement(o.TruncatedContentTooltip,{content:r,tooltipText:e,disabled:t});return O.default.createElement("div",{className:"properties-table-cell-control"},n)}},{key:"_makeDatasetFields",value:function(e,t){var r,n,a=o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.EXPRESSION_FIELD_COLUMN),i=o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.EXPRESSION_FIELD_COLUMN_DESCRIPTION),s=o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.EXPRESSION_STORAGE_COLUMN),l={id:"fields",locLabel:o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.EXPRESSION_FIELDS_DROPDOWN_TITLE),field_columns:{field_column_info:{locLabel:a,descLabel:i},value_column_info:{locLabel:this.valueColumn,descLabel:this.valueColumnDesc},additional_column_info:[{id:"storage",locLabel:s}]}},p={id:"fields",field_value_groups:[]};e.forEach((function(e){var t={id:e.name,additional_column_entries:[{id:"storage",value:e.type}]};e.metadata.values&&(t.values=[],e.metadata.values.forEach((function(e){t.values.push({value:e})}))),e.metadata.range&&(t.range={},e.metadata.range.min&&(t.range.min={value:e.metadata.range.min}),e.metadata.range.max&&(t.range.max={value:e.metadata.range.max})),p.field_value_groups.push(t)}));for(var c=0;c<t.field_categories.length;c++)"fields"===t.field_categories[c].id&&(r=c);for(var d=0;d<t.field_table_info.length;d++)"fields"===t.field_table_info[d].id&&(n=d);return void 0!==r?t.field_categories[r]=l:t.field_categories.unshift(l),void 0!==n?t.field_table_info[n]=p:t.field_table_info.unshift(p),t}},{key:"_makeFieldAndValuesContent",value:function(){var e=this,t=this._makeFieldDropdown(),r=[],n=[],i=["fieldName"],l=null,p=null;if(this.state.fieldCategory===this.recentUseCat)l=this.recentUseCatInfo,p={id:this.recentUseCat,field_value_groups:this.props.controller.getExpressionFieldsRecentlyUsed()};else{for(var c=0;c<this.fields.field_categories.length;c++)this.state.fieldCategory===this.fields.field_categories[c].id&&(l=this.fields.field_categories[c]);for(var d=0;d<this.fields.field_table_info.length;d++)this.state.fieldCategory===this.fields.field_table_info[d].id&&(p=this.fields.field_table_info[d])}if(l&&(r.push({key:"fieldName",label:l.field_columns.field_column_info.locLabel,description:l.field_columns.field_column_info.descLabel,resizable:!0}),n.push({key:"values",label:l.field_columns.value_column_info.locLabel,description:l.field_columns.value_column_info.descLabel}),l.field_columns.additional_column_info))for(var f=0;f<l.field_columns.additional_column_info.length;f++)i.push(l.field_columns.additional_column_info[f].id),r.push({key:l.field_columns.additional_column_info[f].id,label:l.field_columns.additional_column_info[f].locLabel});var h=[],m=[];if(p&&p.field_value_groups)for(var y=0;y<p.field_value_groups.length;y++){var v=p.field_value_groups[y],g=[];(!this.state.fieldFilterText||0===this.state.fieldFilterText.length||v.id.toLowerCase().indexOf(this.state.fieldFilterText.toLowerCase())>-1)&&(g.push({column:"fieldName",content:this.createContentObject(v.id),value:v.id}),v.additional_column_entries&&this._makeAdditionalColumnsContent(v,g),h.push({columns:g,rowKey:y}),y===this.state.fieldSelected&&(m=this._makeValuesContent(v,m)))}var b=this.state.fieldSelected;null!==this.state.fieldTableSortSpec&&(b=(h=this.sortTableRows(h,this.state.fieldTableSortSpec)).findIndex((function(t){return t.rowKey===e.state.fieldSelected})));var E=this.state.valueSelected;null!==this.state.valuesTableSortSpec&&(E=(m=this.sortTableRows(m,this.state.valuesTableSortSpec)).findIndex((function(t){return t.rowKey===e.state.valueSelected})));var _=o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.EXPRESSION_FIELDS_TABLE_LABEL),S=o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.EXPRESSION_VALUES_TABLE_LABEL),T=a.get_1(this.resources,u.MESSAGE_KEYS.EXPRESSION_FIELDS_EMPTY_TABLE_LABEL,o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.EXPRESSION_FIELDS_EMPTY_TABLE_LABEL)),I=a.get_1(this.resources,u.MESSAGE_KEYS.EXPRESSION_VALUES_EMPTY_TABLE_LABEL,o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.EXPRESSION_VALUES_EMPTY_TABLE_LABEL));return O.default.createElement("div",{className:"properties-field-and-values-table-container"},t,O.default.createElement("div",{className:"properties-field-table-container"},O.default.createElement(s.FlexibleTable,{columns:r,data:h,sortable:i,filterable:["fieldName"],onFilter:this.onFieldFilter,rows:u.EXPRESSION_TABLE_ROWS,tableLabel:_,rowSelection:u.ROW_SELECTION.SINGLE,updateRowSelections:this.onFieldTableClick,selectedRows:[b],onRowDoubleClick:this.onFieldTableDblClick,onSort:this.setSortColumn.bind(this,"fieldTable"),light:this.props.controller.getLight(),emptyTablePlaceholder:T})),O.default.createElement("div",{className:"properties-value-table-container"},O.default.createElement(s.FlexibleTable,{columns:n,data:m,sortable:["values"],filterable:["values"],onFilter:this.onValueFilter,rows:u.EXPRESSION_TABLE_ROWS,tableLabel:S,rowSelection:u.ROW_SELECTION.SINGLE,updateRowSelections:this.onValueTableClick,selectedRows:[E],onRowDoubleClick:this.onValueTableDblClick,onSort:this.setSortColumn.bind(this,"valuesTable"),light:this.props.controller.getLight(),emptyTablePlaceholder:I})))}},{key:"_makeValuesContent",value:function(e,t){var r=o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.EXPRESSION_MIN_LABEL),n=o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.EXPRESSION_MAX_LABEL);if(e.values)for(var a=0;a<e.values.length;a++)this._addValueRow(e.values[a].value,a,t);else e.range&&(e.range.min&&this._addValueRow(r+": "+e.range.min.value,0,t),e.range.max&&this._addValueRow(n+": "+e.range.max.value,1,t));return t}},{key:"_addValueRow",value:function(e,t,r){if(!this.state.valueFilterText||0===this.state.valueFilterText.length||String(e).toLowerCase().indexOf(this.state.valueFilterText.toLowerCase())>-1){var o=[{column:"values",content:this.createContentObject(e),value:e}];r.push({columns:o,rowKey:t})}}},{key:"_makeFunctionsContent",value:function(){if(this.props.functionList){var e=Object.keys(this.props.functionList),t=this._makeFunctionDropdown(e),r=this._makeFunctionsTable(e);return O.default.createElement("div",{className:"properties-expression-function-table-container"},t,r)}return O.default.createElement("span",null,"formatMessage(this.reactIntl, MESSAGE_KEYS.EXPRESSION_NO_FUNCTIONS);")}},{key:"_makeAdditionalColumnsContent",value:function(e,t){for(var r=0;r<e.additional_column_entries.length;r++)t.push({column:e.additional_column_entries[r].id,content:this.createContentObject(e.additional_column_entries[r].value),value:e.additional_column_entries[r].value})}},{key:"_makeFunctionDropdown",value:function(e){var t=this,r=e.map((function(e,r){return{value:e,label:t.props.functionList[e].locLabel}})),n=r.slice(0,1),a=r.slice(1);r=n.concat({value:this.recentUseCat,label:this.recentUseCat},a);var i=this.state.functionCategory===this.recentUseCat?this.recentUseCat:this.props.functionList[this.state.functionCategory].locLabel,s=o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.TABLE_SEARCH_HEADER),p={"close.menu":o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.DROPDOWN_TOOLTIP_CLOSEMENU),"open.menu":o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.DROPDOWN_TOOLTIP_OPENMENU)};return O.default.createElement("div",{className:"properties-expression-function-select"},O.default.createElement(l.Dropdown,{id:"properties-expression-function-select-dropdown-"+m.v4(),light:this.props.controller.getLight(),label:i,items:r,onChange:this.onFunctionCatChange,translateWithId:function(e){return p[e]},titleText:s}))}},{key:"_makeFieldDropdown",value:function(){for(var e=[],t=0;t<this.fields.field_categories.length;t++)e.push({value:this.fields.field_categories[t].id,label:this.fields.field_categories[t].locLabel});var r=e.slice(0,1),n=e.slice(1),a=r.concat({value:this.recentUseCat,label:this.recentUseCat},n),i=this.state.fieldCategory===this.recentUseCat?this.recentUseCat:e[0].label,s=o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.TABLE_SEARCH_HEADER),p={"close.menu":o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.DROPDOWN_TOOLTIP_CLOSEMENU),"open.menu":o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.DROPDOWN_TOOLTIP_OPENMENU)};return O.default.createElement("div",{className:"properties-expression-field-select"},O.default.createElement(l.Dropdown,{id:"properties-expression-field-select-dropdown-"+m.v4(),light:this.props.controller.getLight(),label:i,items:a,onChange:this.onFieldCatChange,translateWithId:function(e){return p[e]},titleText:s}))}},{key:"_makeFunctionsTable",value:function(e){var t=this,r=[],n=o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.EXPRESSION_FUNCTION_COLUMN),i=o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.EXPRESSION_RETURN_COLUMN);r.push({key:"function",label:n,width:73,resizable:!0}),r.push({key:"return",label:i,width:27});var l=this._buildFunctionTable(this.state.functionCategory),p=l.rows,c=this.state.functionSelected;null!==this.state.functionTableSortSpec&&(c=(p=this.sortTableRows(p,this.state.functionTableSortSpec)).findIndex((function(e){return e.rowKey===t.state.functionSelected})));var d=o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.EXPRESSION_FUNCTIONS_TABLE_LABEL),f=a.get_1(this.resources,u.MESSAGE_KEYS.EXPRESSION_NO_FUNCTIONS,o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.EXPRESSION_NO_FUNCTIONS));return O.default.createElement("div",{className:"properties-functions-table-container"},O.default.createElement("div",{className:"properties-functions-table"},O.default.createElement(s.FlexibleTable,{columns:r,data:p,sortable:["function","return"],filterable:["function"],onFilter:this.onFunctionFilter,rows:u.EXPRESSION_TABLE_ROWS,tableLabel:d,rowSelection:u.ROW_SELECTION.SINGLE,updateRowSelections:this.onFunctionTableClick,selectedRows:[c],onRowDoubleClick:this.onFunctionTableDblClick,onSort:this.setSortColumn.bind(this,"functionTable"),light:this.props.controller.getLight(),emptyTablePlaceholder:f})),O.default.createElement("div",{className:"properties-help-table-container"},l.helpContainer))}},{key:"_buildFunctionTable",value:function(e){var t={rows:[],helpContainer:O.default.createElement("div",null)},r=e===this.recentUseCat?this.props.controller.getExpressionRecentlyUsed():this.props.functionList[e].functionList;if(r)for(var o=0;o<r.length;o++){var n=r[o],a=[];if(!this.state.functionFilterText||0===this.state.functionFilterText.length||n.locLabel.toLowerCase().indexOf(this.state.functionFilterText.toLowerCase())>-1){var i=n.locReturnType?n.locReturnType:n.return_type;a.push({column:"function",content:this.createContentObject(n.locLabel),value:n.locLabel}),a.push({column:"return",content:this.createContentObject(i),value:i}),t.rows.push({columns:a,rowKey:o}),o===this.state.functionSelected&&(t.helpContainer=O.default.createElement("div",{className:"properties-function-help-text"},O.default.createElement("span",{className:"properties-function-help-command"},n.locLabel,":"),O.default.createElement("br",null),O.default.createElement("br",null),O.default.createElement("span",null,n.help)))}}return t}},{key:"render",value:function(){var e=this._makeFieldAndValuesContent(),t=this._makeFunctionsContent(),r=o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.EXPRESSION_FIELD_TAB),n=o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.EXPRESSION_FUNCTIONS_TAB),a=null;return 0===this.state.selectedIndex?a=e:1===this.state.selectedIndex&&(a=t),O.default.createElement("div",{className:"properties-expression-selection-fieldOrFunction"},O.default.createElement("div",{className:"properties-expression-selection-content-switcher"},O.default.createElement(l.ContentSwitcher,{onChange:this.onSwitch.bind(this),selectedIndex:this.state.selectedIndex},O.default.createElement(l.Switch,{key:0,name:"expresson-builder-fields-tab",className:"expresson-builder-fields-tab",text:r}),O.default.createElement(l.Switch,{key:1,name:"expresson-builder-function-tab",className:"expresson-builder-function-tab",text:n}))),a)}}]),i}(O.default.Component);function ii(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var si=function(r){t._inherits(n,r);var o=ii(n);function n(){return e._classCallCheck(this,n),o.apply(this,arguments)}return e._createClass(n,[{key:"onOperatorClick",value:function(e,t){this.props.onChange&&this.props.onChange(e)}},{key:"_makeOperatorContent",value:function(){var e=this;if(this.props.operatorList){var t=[];return this.props.operatorList.forEach((function(r,o){var n=m.v4()+"-tooltip-expression-operator",a=O.default.createElement("div",{className:"properties-tooltips"},r.help);t.push(O.default.createElement("div",{className:"properties-operator-tooltip-container",key:"expression-operator-"+o},O.default.createElement(y,{id:n,tip:a,direction:"bottom",className:"properties-tooltips"},O.default.createElement(l.Button,{className:u.classNames("properties-operator-button",{first:o%2==0,second:!(o%2==0)}),size:"small",kind:"tertiary",onClick:e.onOperatorClick.bind(e,r.value)},O.default.createElement("div",{className:"properties-operator-button-label"},r.locLabel)))))})),O.default.createElement("div",{className:"properties-operator-container"},t)}return O.default.createElement("div",null)}},{key:"render",value:function(){var e=this._makeOperatorContent();return O.default.createElement("div",{className:"properties-expression-selection-operator"},e)}}]),n}(O.default.Component);function li(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var ui=function(r){t._inherits(n,r);var o=li(n);function n(){return e._classCallCheck(this,n),o.apply(this,arguments)}return e._createClass(n,[{key:"render",value:function(){var e=O.default.createElement(ai,{controller:this.props.controller,onChange:this.props.onChange,functionList:this.props.functionList,language:this.props.language}),t=O.default.createElement(si,{controller:this.props.controller,onChange:this.props.onChange,operatorList:this.props.operatorList});return O.default.createElement("div",{className:"properties-expression-selection-container"},t,e)}}]),n}(O.default.Component);function pi(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var ci=function(r){t._inherits(a,r);var n=pi(a);function a(r){var o;return e._classCallCheck(this,a),(o=n.call(this,r)).selection=[],o.expressionInfo=r.controller.getExpressionInfo(),o.editorDidMount=o.editorDidMount.bind(t._assertThisInitialized(o)),o.onChange=o.onChange.bind(t._assertThisInitialized(o)),o.onBlur=o.onBlur.bind(t._assertThisInitialized(o)),o.onSelectionChange=o.onSelectionChange.bind(t._assertThisInitialized(o)),o.lastCursorPos=null,o}return e._createClass(a,[{key:"onChange",value:function(e){var t="string"==typeof e?e:e.toString(),r=this.editor.getCursor(),o=1;if(this.editor.somethingSelected())o=0,this.editor.replaceSelection(t);else{var n=" ";this.lastCursorPos&&(this.editor.setCursor(this.lastCursorPos),r=this.lastCursorPos);var a=this.editor.getLine(r.line)[r.ch-1];-1!==["(","[","{"].indexOf(a)&&(n=""),this.editor.replaceSelection(n+t)}this._setSelection(t,r,o);var i=this.editor.getValue();this.props.controller.updatePropertyValue(this.props.propertyId,i,!0),this.lastCursorPos=this.editor.getCursor()}},{key:"onSelectionChange",value:function(e){this.selection=e}},{key:"onBlur",value:function(e,t){this.lastCursorPos=e.getCursor();var r=this.props.controller.getPropertyValue(this.props.propertyId),n=this.editor.getValue(),a=this.expressionSelectionPanel&&t&&this.expressionSelectionPanel.contains(t.relatedTarget);o.isEqual_1(r,n)&&a||this.props.controller.updatePropertyValue(this.props.propertyId,n,a)}},{key:"editorDidMount",value:function(e,t){this.editor=e}},{key:"_setSelection",value:function(e,t,r){if("string"==typeof e){var o=e.indexOf("?");if(-1!==o){var n={anchor:{line:t.line,ch:t.ch+o+r+1},head:{line:t.line,ch:t.ch+o+r}};return void this.onSelectionChange([n])}}for(var a=this.editor.lineCount(),i=0;i<a;i++){var s=this.editor.getLine(i).indexOf("?");if(-1!==s){var l={anchor:{line:i,ch:s+1},head:{line:i,ch:s}};return void this.onSelectionChange([l])}}var u={anchor:{line:t.line,ch:t.ch+e.length+r},head:{line:t.line,ch:t.ch+e.length+r}};this.onSelectionChange([u])}},{key:"render",value:function(){var e=this,t=o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.EXPRESSION_BUILDER_LABEL);return O.default.createElement("div",{className:"properties-expression-builder"},O.default.createElement(Bi,{control:this.props.control,propertyId:this.props.propertyId,controller:this.props.controller,builder:!1,editorDidMount:this.editorDidMount,selectionRange:this.selection,onSelectionChange:this.onSelectionChange,onBlur:this.onBlur,height:96,expressionLabel:t}),O.default.createElement("div",{ref:function(t){return e.expressionSelectionPanel=t}},O.default.createElement(ui,{controller:this.props.controller,onChange:this.onChange,functionList:this.expressionInfo.functionCategories,operatorList:this.expressionInfo.operators,language:this.props.control.language})))}}]),a}(O.default.Component);function di(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var fi,hi=function(r){t._inherits(a,r);var n=di(a);function a(t){var r;return e._classCallCheck(this,a),(r=n.call(this,t)).buttonHandler=t.controller.getHandlers().buttonHandler||function(){return null},r.reactIntl=t.controller.getReactIntl(),r}return e._createClass(a,[{key:"render",value:function(){var e=this;return O.default.createElement("div",{className:"properties-expression-toggle"},O.default.createElement("div",{className:"properties-expression-toggle-absolute"},this.props.enableMaximize?O.default.createElement(l.Button,{className:"maximize",type:"button",size:"small",kind:"ghost",renderIcon:d.Maximize16,hasIconOnly:!0,iconDescription:o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.EXPRESSION_MAXIMIZE_LABEL),onClick:function(){!e.buttonHandler({type:"maximize_tearsheet",propertyId:e.props.control.data||{}})&&e.props.control.data&&e.props.control.data.tearsheet_ref&&e.props.controller.setActiveTearsheet(e.props.control.data.tearsheet_ref)}}):O.default.createElement(l.Button,{type:"button",className:"minimize",size:"small",kind:"ghost",hasIconOnly:!0,renderIcon:d.Minimize16,iconDescription:o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.EXPRESSION_MINIMIZE_LABEL),onClick:function(){return e.props.controller.clearActiveTearsheet()}})))}}]),a}(O.default.Component),mi=_.injectIntl(hi);function yi(e,t){for(var r=e.length,o=0;o<r;++o)t(e[o])}function vi(e,t,r){var o,n=e.getCursor(),a=r(e,n),i=a;/^[\w$_]*$/.test(a.string)||(a=i={start:n.ch,end:n.ch,string:"",state:a.state,className:":"===a.string?"python-type":null}),o||(o=[]),o.push(i);var s=function(e,t){var r=[],o=e.string;function n(e){0!==e.lastIndexOf(o,0)||function(e,t){if(!Array.prototype.indexOf){for(var r=e.length;r--;)if(e[r]===t)return!0;return!1}return-1!==e.indexOf(t)}(r,e)||r.push(e)}function a(e){yi(_i,n),yi(Ei,n)}if(t){var i=t.pop(),s="";for("variable"===i.type?s=i.string:"variable-3"===i.type&&(s=":"+i.string);null!==s&&t.length;)s=s[t.pop().string];null!==s&&a()}return r}(a,o);return s.sort(),{list:s,from:fi.Pos(n.line,a.start),to:fi.Pos(n.line,a.end)}}function gi(e){return vi(e,0,(function(e,t){return e.getTokenAt(t)}))}var bi,Ei="and del from not while as elif global or with assert else if pass yieldbreak except import print class exec in raise continue finally is return def for lambda try".split(" "),_i="abs divmod input open staticmethod all enumerate int ord str any eval isinstance pow sum basestring execfile issubclass print superbin file iter property tuple bool filter len range typebytearray float list raw_input unichr callable format locals reduce unicodechr frozenset long reload vars classmethod getattr map repr xrangecmp globals max reversed zip compile hasattr memoryview round __import__complex hash min set apply delattr help next setattr bufferdict hex object slice coerce dir id oct sorted intern ".split(" ").join("() ").split(" ");function Si(e,t){for(var r=e.length,o=0;o<r;++o)t(e[o])}function Ti(e,t,r){var o,n=e.getCursor(),a=r(e,n),i=a;/^[\w$_]*$/.test(a.string)||(a=i={start:n.ch,end:n.ch,string:"",state:a.state,className:":"===a.string?"r-type":null}),o||(o=[]),o.push(i);var s=function(e,t){var r=[],o=e.string;function n(e){0!==e.lastIndexOf(o,0)||function(e,t){if(!Array.prototype.indexOf){for(var r=e.length;r--;)if(e[r]===t)return!0;return!1}return-1!==e.indexOf(t)}(r,e)||r.push(e)}function a(e){Si(Ai,n),Si(Ri,n)}if(t){var i=t.pop(),s="";for("variable"===i.type?s=i.string:"variable-3"===i.type&&(s=":"+i.string);null!==s&&t.length;)s=s[t.pop().string];null!==s&&a()}return r}(a,o);return s.sort(),{list:s,from:bi.Pos(n.line,a.start),to:bi.Pos(n.line,a.end)}}function Ii(e){return Ti(e,0,(function(e,t){return e.getTokenAt(t)}))}var Ci,Ri="function|if|in|break|next|repeat|else|for|return|switch|while|try|tryCatch|stop|warning|require|library|attach|detach|source|setMethod|setGeneric|setGroupGeneric|setClass".split("|"),Ai="zapsmall xzfile xtfrm xor writeLines writeChar writeBin write withVisible withRestarts withinwithCallingHandlers withAutoprint with while which weekdays warnings warning version Vectorize vector vapplyvalidUTF8 validEnc utf8ToInt UseMethod url unz untracemem untrace unsplit unserialize unname unlockBinding unloadNamespaceunlist unlink unique union undebug unclass typeof tryCatch try truncate trunc trimws trigammatransform tracingState tracemem traceback trace toupper toString topenv tolower textConnectionValue textConnectiontestPlatformEquivalence tempfile tempdir tcrossprod taskCallbackManager tapply tanpi tanh tan tabulate table T t system2 systemswitch sweep svd suspendInterrupts suppressWarnings suppressPackageStartupMessages suppressMessages summary sumsubstring substr substitute subset sub strwrap structure strtrim strtoi strsplit strrep strptime strftimestopifnot stop stdout stdin stderr startsWith standardGeneric srcref srcfilecopy srcfilealias srcfile sQuote sqrt sprintf splitsource sort solve socketSelect socketConnection sinpi sink sinh single sin simplify2array simpleWarning simpleMessage simpleErrorsimpleCondition signif signalCondition sign shQuote showConnections setwd setTimeLimit setSessionTimeLimit setNamespaceInfo setHooksetequal setdiff serialize sequence seq_len seq_along seq seek searchpaths search scan scale saveRDS save sapply sample rowSumsrowsum rownames rowMeans row round RNGversion length lchoose lbeta lazyLoadDBfetch lazyLoadDBexecRNGkind rm rle rev returnValue return retracemem restartFormals restartDescription requireNamespace require replicate replace repeatrep_len rep removeTaskCallback remove regmatches registerS3methods registerS3method regexpr regexec Reduce RecallreadRenviron readRDS readLines readline readChar readBin Re rcond rbind rawToChar rawToBits rawShift rawConnectionValue rawConnectionraw rapply rank range R_system_version quote quit quarters qr q pushBackLength pushBack psigamma provideDimnames prod prmatrix printprettyNum pretty Position polyroot pmin pmax pmatch pipe pi pcre_config paste0 paste parseNamespaceFile parsepackBits packageStartupMessage packageHasNamespace packageEvent package_version outer ordered order options open OlsonNamesoldClass objects nzchar numeric_version numeric NROW nrow normalizePath norm noquote nlevels ngettext NextMethod next Negate NCOL ncolnchar nargs namespaceImportMethods namespaceImportFrom namespaceImportClasses namespaceImport namespaceExportmonths mode Mod missing min mget message merge memDecompress memCompress mean max matrix match mapply MapmakeActiveBinding ls logical logb log2 log1p log10 log lockEnvironment lockBinding local loadNamespace loadingNamespaceInfo loadedNamespacesload list2env list license licence library libcurlVersion lgamma lfactorial levels LETTERS letters lengthslazyLoad lapply labels La_version La_library l10n_info kronecker kappa julian jitter isTRUE isSymmetric isSeekable isS4 isRestart isOpenISOdatetime ISOdate isNamespaceLoaded isNamespace isIncomplete isFALSE isdebugged isBaseNamespace isattyinvokeRestartInteractively invokeRestart invisible intToUtf8 intToBits intersect  acosh acos abs abbreviateinteractive interaction integer inherits importIntoEnv Im ifelse if identity identical icuSetCollate icuGetCollate iconvlist iconv Igzfile gzcon gsub grouping grepRaw grepl grep gregexpr globalenv gl getwd gettextf gettext getTaskCallbackNames getSrcLines getRversiongetOption getNativeSymbolInfo getNamespaceVersion getNamespaceUsers getNamespaceName getNamespaceInfo getNamespaceImports getNamespaceExportsgetNamespace getLoadedDLLs getHook getExportedValue geterrmessage getElement getDLLRegisteredRoutines getConnection getCallingDLLegetCallingDLL getAllConnections get0 get gctorture2 gctorture gcinfo gc gamma function forwardsolve formatDL formatC formatformals forceAndCall force for flush floor findRestart findPackageEnv findInterval Find Filter file fifo factorial factor F extSoftVersionexpression expm1 exp exists evalq eval environmentName environmentIsLocked environment enquote endsWith EncodingencodeString enc2utf8 enc2native emptyenv eigen eapply dynGet duplicated dump droplevels drop dQuote dput double dontCheck dirname dirdigamma difftime diff dget determinant detach det deparse delayedAssign asNamespace asinh asindebugonce debuggingState debug date cut curlGetHeaders cumsum cumprod cummin cummax Cstack_info crossprod cospi cosh cos contributors Conjconflicts conditionMessage conditionCall computeRestarts complex comment commandArgs colSums colnames colMeans colcloseAllConnections close clearPushBack class choose chol2inv chol chkDots check_tzones chartr charToRaw charmatch character ceilingcbind cat casefold capabilities callCC call c bzfile by builtins browserText browserSetDebug browserCondition browser break bquote bodybitwXor bitwShiftR bitwShiftL bitwOr bitwNot bitwAnd bindtextdomain bindingIsLocked bindingIsActive beta besselY besselK besselJ besselIbasename baseenv backsolve autoloader autoload attributes attr attachNamespace attach atanh atan2 atan assign asS4 asS3arrayInd array args Arg apply append aperm anyNA anyDuplicated any allowInterrupts all alist agrepl agrep addTaskCallback addNA".split(" ");var ki="@BLANK @DIFF1 @DIFF2 @FIELD @FIELDS_BETWEEN @FIELDS_MATCHING @GLOBAL_MAX @GLOBAL_MEAN @GLOBAL_MIN @GLOBAL_SDEV @GLOBAL_SUM @INDEX @LAST_NON_BLANK @MAX @MEAN @MIN @MULTI_RESPONSE_SET @NULL @OFFSET @PARTITION_FIELD @PREDICTED @SDEV @SINCE @SINCE0 @SUM @TARGET @TESTING_PARTITION @THIS @TODAY @TRAINING_PARTITION @VALIDATION_PARTITION abs allbutfirst allbutlast alphabefore and arccos arccosh arcsin arcsinh arctan arctan2 arctanh area cdf_chisq cdf_f cdf_normal cdf_t close_to COND1 and COND2 COND1 or COND2 cos cosh count_equal count_greater_than count_less_than count_non_nulls count_not_equal count_nulls count_substring crosses date_before date_days_difference date_from_ywd date_in_days date_in_months date_in_weeks date_in_years date_iso_day date_iso_week date_iso_year date_months_difference date_weeks_difference date_years_difference datetime_date datetime_day datetime_day_name datetime_day_short_name datetime_hour datetime_in_seconds datetime_minute datetime_month datetime_month_name datetime_month_short_name datetime_now datetime_second datetime_time datetime_timestamp datetime_weekday datetime_year distance div endstring exp first_index first_non_null first_non_null_index fracof hasendstring hasmidstring hasstartstring hassubstring hassubstring if then else elseif endif integer_bitcount integer_leastbit integer_length intof is_date is_datetime is_integer is_number is_real is_string is_time is_timestamp isalphacode isendstring islowercode ismidstring isnumbercode isstartstring issubstring issubstring issubstring_count issubstring_lim isuppercode last last_index last_non_null last_non_null_index length locchar locchar_back log log10 lowertoupper max max_index max_n MEAN mean_n member min min_index min_n negate not num_points oneof or overlap pi random random0 rem replace replicate round sdev_n sign sin sinh skipchar skipchar_back soundex soundex_difference sqrt startstring stb_centroid_latitude stb_centroid_longitude stripchar strmember subscrs substring substring_between sum_n tan tanh testbit time_before time_hours_difference time_in_hours time_in_mins time_in_secs time_mins_difference".split(" ");function Oi(e,t){return function(e,t,r,o){var n=e.getCursor(),a=r(e,n);if(/\b(?:string|comment)\b/.test(a.type))return null;a.state=Ci.innerMode(e.getMode(),a.state).state,/^[\w$_@]*$/.test(a.string)?a.end>n.ch&&(a.end=n.ch,a.string=a.string.slice(0,n.ch-a.start)):a={start:n.ch,end:n.ch,string:"",state:a.state,type:"."===a.string?"property":null};return{list:wi(a,t),from:Ci.Pos(n.line,a.start),to:Ci.Pos(n.line,a.end)}}(e,ki,(function(e,t){return e.getTokenAt(t)}))}function wi(e,t,r){for(var o=[],n=e.string,a=0;a<t.length;a++)0===t[a].lastIndexOf(n,0)&&-1===o.indexOf(t[a])&&o.push(t[a]);return o}function Ni(){var e="@BLANK @DIFF1 @DIFF2 @FIELD @FIELDS_BETWEEN @FIELDS_MATCHING @GLOBAL_MAX @GLOBAL_MEAN @GLOBAL_MIN @GLOBAL_SDEV @GLOBAL_SUM @INDEX @LAST_NON_BLANK @MAX @MEAN @MIN @MULTI_RESPONSE_SET @NULL @OFFSET @PARTITION_FIELD @PREDICTED @SDEV @SINCE @SINCE0 @SUM @TARGET @TESTING_PARTITION @THIS @TODAY @TRAINING_PARTITION @VALIDATION_PARTITION abs allbutfirst allbutlast alphabefore and arccos arccosh arcsin arcsinh arctan arctan2 arctanh area cdf_chisq cdf_f cdf_normal cdf_t close_to COND1 and COND2 COND1 or COND2 cos cosh count_equal count_greater_than count_less_than count_non_nulls count_not_equal count_nulls count_substring crosses date_before date_days_difference date_from_ywd date_in_days date_in_months date_in_weeks date_in_years date_iso_day date_iso_week date_iso_year date_months_difference date_weeks_difference date_years_difference datetime_date datetime_day datetime_day_name datetime_day_short_name datetime_hour datetime_in_seconds datetime_minute datetime_month datetime_month_name datetime_month_short_name datetime_now datetime_second datetime_time datetime_timestamp datetime_weekday datetime_year distance div endstring exp first_index first_non_null first_non_null_index fracof hasendstring hasmidstring hasstartstring hassubstring hassubstring if then else elseif endif integer_bitcount integer_leastbit integer_length intof is_date is_datetime is_integer is_number is_real is_string is_time is_timestamp isalphacode isendstring islowercode ismidstring isnumbercode isstartstring issubstring issubstring issubstring_count issubstring_lim isuppercode last last_index last_non_null last_non_null_index length locchar locchar_back log log10 lowertoupper max max_index max_n MEAN mean_n member min min_index min_n negate not num_points oneof or overlap pi random random0 rem replace replicate round sdev_n sign sin sinh skipchar skipchar_back soundex soundex_difference sqrt startstring stb_centroid_latitude stb_centroid_longitude stripchar strmember subscrs substring substring_between sum_n tan tanh testbit time_before time_hours_difference time_in_hours time_in_mins time_in_secs time_mins_difference".split(" "),t=/[\[\]{}\(\),;\:\.]/,r=/\d/,o=/[\w\.]/,n=/[\w\$_]/,a=/[+\-*&%=<>!?|\/]/;function i(i,s){var l=i.next();if("#"===l&&s.startOfLine)return i.skipToEnd(),"meta";if('"'===l)return function(e,t,r){var o,n=!1;for(;void 0!==(o=t.next());)if(o===e){n=!0;break}n&&(r.tokenize=null)}(l,i,s),"string";if("'"===l)return function(e,t,r){var o,n=!1;for(;void 0!==(o=t.next());)if(o===e){n=!0;break}n&&(r.tokenize=null)}(l,i,s),"variable";if(t.test(l))return null;if(r.test(l))return i.eatWhile(o),"number";if(a.test(l))return i.eatWhile(a),"operator";i.eatWhile(n);var u=i.current();return-1!==e.indexOf(u)?"keyword":"variable"}return{startState:function(){return{tokenize:null}},token:function(e,t){return e.eatSpace()?null:(t.tokenize||i)(e,t)},electricChars:"{}"}}function Pi(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Li(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Li(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function Li(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function Di(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var Mi=null;"undefined"!=typeof window&&void 0!==window.navigator&&(Mi=require("codemirror"),require("codemirror/addon/hint/show-hint"),require("codemirror/addon/display/placeholder"),require("codemirror/addon/display/autorefresh"),require("codemirror/mode/javascript/javascript"),require("codemirror/addon/hint/javascript-hint"),require("codemirror/addon/hint/sql-hint"),require("codemirror/mode/sql/sql"),require("codemirror/mode/python/python"),require("codemirror/mode/r/r"),function(e){(fi=e).registerHelper("hint","python",gi)}(Mi),function(e){(bi=e).registerHelper("hint","r",Ii)}(Mi),function(e){(Ci=e).registerHelper("hint","CLEM",Oi),Ci.defineMode("CLEM",Ni),Ci.defineMIME("text/x-CLEM","CLEM")}(Mi));var xi=function(r){t._inherits(i,r);var n=Di(i);function i(r){var o;return e._classCallCheck(this,i),(o=n.call(this,r)).state={showExpressionBuilder:!1,validationInProgress:!1},o.origHint="",o.expressionInfo=o.props.controller.getExpressionInfo(),o.handleValidate=o.handleValidate.bind(t._assertThisInitialized(o)),o.hasValidate=o.hasValidate.bind(t._assertThisInitialized(o)),o.cancelExpressionBuilder=o.cancelExpressionBuilder.bind(t._assertThisInitialized(o)),o.hideExpressionBuilder=o.hideExpressionBuilder.bind(t._assertThisInitialized(o)),o.showExpressionBuilder=o.showExpressionBuilder.bind(t._assertThisInitialized(o)),o.editorDidMount=o.editorDidMount.bind(t._assertThisInitialized(o)),o.addonHints=o.addonHints.bind(t._assertThisInitialized(o)),o.getDatasetFields=o.getDatasetFields.bind(t._assertThisInitialized(o)),o.handleBlur=o.handleBlur.bind(t._assertThisInitialized(o)),o.handleKeyDown=o.handleKeyDown.bind(t._assertThisInitialized(o)),o.handleChange=function(e,t,r){if(Array.isArray(t.text)&&1===t.text.length&&1===t.text[0].length&&o.props.onSelectionChange){var n=t.removed[0].length>0?{line:t.from.line,ch:t.from.ch+1}:{line:t.to.line,ch:t.to.ch+1};o.props.onSelectionChange([{anchor:n,head:n}])}o.state.validateIcon&&(o.setState({validateIcon:null}),o.props.controller.updateErrorMessage(o.props.propertyId,u.DEFAULT_VALIDATION_MESSAGE))},o}return e._createClass(i,[{key:"componentDidUpdate",value:function(e){var t=this;this.props.selectionRange&&this.props.selectionRange.length>0&&!o.isEqual_1(e.selectionRange,this.props.selectionRange)&&this.editor&&(this.props.selectionRange.forEach((function(e){t.editor.setSelection(e.anchor,e.head)})),this.editor.focus())}},{key:"componentWillUnmount",value:function(){this.origHint&&Mi&&Mi.registerHelper("hint",this.props.control.language,this.origHint)}},{key:"getDatasetFields",value:function(){var e,t=[],r=Pi(this.props.controller.getDatasetMetadataFields());try{for(r.s();!(e=r.n()).done;){var o=e.value;t.push(o.name)}}catch(e){r.e(e)}finally{r.f()}return t}},{key:"addonHints",value:function(e,t){var r={},o=e.getCursor(),n=e.getTokenAt(o);if(this.origHint){r=this.origHint(e,t);for(var a=this.getDatasetFields(),i=0;i<a.length;++i){var s=a[i];(0===s.lastIndexOf(n.string,0)&&-1===r.list.indexOf(s)||" "===n.string&&null===n.type)&&r.list.unshift(s)}}return r}},{key:"editorDidMount",value:function(e,t){this.editor=e;var r=this.expressionEditorDiv?this.expressionEditorDiv.clientWidth:0,o=r>0?r/8.5:30,n=this.props.control.charLimit?Math.min(this.props.control.charLimit/o*26,390):104;n=this.props.control.rows?26*this.props.control.rows:n,n=this.props.height?this.props.height:n,this.editor.setSize(null,Math.max(Math.floor(n),104)),this.origHint=e.getHelper({line:0,ch:0},"hint");var a=this.props.control.language;switch(this.props.control.language){case"text/x-hive":a="sql";break;case"text/x-python":a="python";break;case"text/x-rsrc":a="r"}Mi&&Mi.registerHelper("hint",a,this.addonHints),this.props.editorDidMount&&this.props.editorDidMount(e,t)}},{key:"showExpressionBuilder",value:function(){this.initialControlValue=this.props.controller.getPropertyValue(this.props.propertyId),this.initialMessage=this.props.controller.getErrorMessage(this.props.propertyId),this.initialState=this.props.controller.getControlState(this.props.propertyId),this.setState({showExpressionBuilder:!0})}},{key:"hideExpressionBuilder",value:function(){this.setState({showExpressionBuilder:!1})}},{key:"cancelExpressionBuilder",value:function(){this.props.controller.updatePropertyValue(this.props.propertyId,this.initialControlValue),this.props.controller.updateErrorMessage(this.props.propertyId,this.initialMessage),this.props.controller.updateControlState(this.props.propertyId,this.initialState),this.hideExpressionBuilder()}},{key:"handleValidate",value:function(){var e=this;this.setState({validateIcon:null,validationInProgress:!0});var t=this.props.controller.getAppData();this.props.controller.getHandlers().validationHandler(this.props.controller,this.props.propertyId,this.props.value,t,(function(t){e.props.controller.updateErrorMessage(e.props.propertyId,t),e.setState({validateIcon:t.type,validationInProgress:!1}),e.editor.display.input.blur()}))}},{key:"hasValidate",value:function(){return"function"==typeof this.props.controller.getHandlers().validationHandler}},{key:"handleKeyDown",value:function(e,t){if("Enter"===t.code&&this.props.selectionRange&&this.props.selectionRange.length>0&&this.props.onSelectionChange){var r={line:this.props.selectionRange[0].anchor.line+1,ch:0};this.props.onSelectionChange([{anchor:r,head:r}])}}},{key:"handleBlur",value:function(e,t){if(this.props.onBlur)this.props.onBlur(e,t);else{var r=this.editor.getValue(),o=t&&t.relatedTarget&&t.relatedTarget.classList.contains("properties-expression-button");this.props.controller.updatePropertyValue(this.props.propertyId,r,o)}}},{key:"_showBuilderButton",value:function(){return this.props.builder&&this.props.rightFlyout&&this.expressionInfo.functionCategories&&Object.keys(this.expressionInfo.functionCategories).length>0}},{key:"render",value:function(){var e=this,t=this.props.messageInfo,r=t?t.type:u.CONDITION_MESSAGE_TYPE.INFO;r===u.CONDITION_MESSAGE_TYPE.SUCCESS&&(t=null);var n=this.props.state===u.STATES.DISABLED?"disabled":r,i=this.props.controller.getReactIntl(),s=this._showBuilderButton()?O.default.createElement(l.Button,{kind:"ghost",size:"small",className:"properties-expression-button",disabled:this.props.state===u.STATES.DISABLED,onClick:this.showExpressionBuilder,renderIcon:d.Calculator24,iconDescription:o.formatMessage(i,u.MESSAGE_KEYS.EXPRESSION_BUILDER_ICON_DESCRIPTION),tooltipPosition:"right",hasIconOnly:!0}):null,p=null;this.state.validateIcon&&(p=O.default.createElement("div",{className:"icon validateIcon"},O.default.createElement(h.Icon,{type:this.state.validateIcon,className:"properties-validation-icon-".concat(this.state.validateIcon)})));var c=this.state.validationInProgress?o.formatMessage(i,u.MESSAGE_KEYS.EXPRESSION_VALIDATING_LABEL):o.formatMessage(i,u.MESSAGE_KEYS.EXPRESSION_VALIDATE_LABEL),f=this.hasValidate()&&this.props.validateLink?O.default.createElement("div",{className:"properties-expression-validate",disabled:this.props.state===u.STATES.DISABLED},O.default.createElement(l.Button,{className:"validateLink",kind:"ghost",onClick:this.handleValidate,disabled:this.props.state===u.STATES.DISABLED||this.state.validationInProgress},c),p):null,m={mode:this.props.control.language,placeholder:this.props.control.additionalText,theme:n+" custom",readOnly:this.props.state===u.STATES.DISABLED&&"nocursor",extraKeys:{"Ctrl-Space":"autocomplete"},autoRefresh:!0,lineNumbers:!0},y=o.formatMessage(i,u.MESSAGE_KEYS.APPLYBUTTON_LABEL),v=o.formatMessage(i,u.MESSAGE_KEYS.REJECTBUTTON_LABEL),g=o.formatMessage(i,u.MESSAGE_KEYS.EXPRESSION_BUILDER_TITLE),b=this.state.showExpressionBuilder?O.default.createElement(dt,{cancelHandler:this.cancelExpressionBuilder,okHandler:this.hideExpressionBuilder,show:this.state.showExpressionBuilder,applyLabel:y,rejectLabel:v,title:g,light:this.props.controller.getLight()&&this.props.control.light},O.default.createElement("div",null,O.default.createElement(ci,{control:this.props.control,controller:this.props.controller,propertyId:this.props.propertyId}))):null,E=u.classNames("properties-expression-editor ".concat(r),{"properties-light-disabled":!this.props.control.light||!this.props.controller.getLight()}),_=O.default.createElement("div",{className:"properties-expression-link-container"},s,f),S=_;this.props.expressionLabel&&(S=O.default.createElement("div",{className:"properties-expression-header"},O.default.createElement("div",{className:"properties-expression-title"},this.props.expressionLabel),_));var T=null;if(this.props.control.enableMaximize){var I=this.props.controller.getActiveTearsheet()===a.get_1(this,"props.control.data.tearsheet_ref");T=O.default.createElement(mi,{control:this.props.control,controller:this.props.controller,enableMaximize:!I})}return O.default.createElement("div",{className:"properties-expression-editor-wrapper"},this.props.controlItem,b,O.default.createElement("div",{className:"properties-editor-container"},S,T,O.default.createElement("div",{ref:function(t){return e.expressionEditorDiv=t},"data-id":ht(this.props.propertyId),className:E},O.default.createElement(R.UnControlled,{ref:function(t){return e.codeMirror=t},options:m,onChange:this.handleChange,onKeyDown:this.handleKeyDown,onBlur:this.handleBlur,editorDidMount:this.editorDidMount,value:this.props.value}),O.default.createElement(fa,{state:this.props.state,messageInfo:t,inTable:this.props.tableControl}))))}}]),i}(O.default.Component);xi.defaultProps={builder:!0,validateLink:!0};var Bi=c.connect((function(e,t){return{value:t.controller.getPropertyValue(t.propertyId),state:t.controller.getControlState(t.propertyId),messageInfo:t.controller.getErrorMessage(t.propertyId)}}),null)(xi);function Fi(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var Vi=function(r){t._inherits(a,r);var n=Fi(a);function a(t){var r;return e._classCallCheck(this,a),(r=n.call(this,t)).id=ft(r.props.propertyId),r}return e._createClass(a,[{key:"handleChange",value:function(e){this.props.controller.updatePropertyValue(this.props.propertyId,e.target.value)}},{key:"render",value:function(){var e="".concat(this.props.control.name,".passwordShow.tooltip"),t="".concat(this.props.control.name,".passwordHide.tooltip"),r=o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.SHOW_PASSWORD_TOOLTIP),n=o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.HIDE_PASSWORD_TOOLTIP),a=this.props.controller.getResource(e,r),i=this.props.controller.getResource(t,n),s=this.props.value?this.props.value:"",p=u.classNames("properties-pwdfield","properties-input-control",{hide:this.props.state===u.STATES.HIDDEN},this.props.messageInfo?this.props.messageInfo.type:null),c=bt(this.props.messageInfo,this.props.tableControl);return O.default.createElement("div",{className:p,"data-id":ht(this.props.propertyId)},O.default.createElement(l.Form,null,O.default.createElement(l.PasswordInput,u._extends({},c,{autoComplete:"off",id:this.id,disabled:this.props.state===u.STATES.DISABLED,placeholder:this.props.control.additionalText,onChange:this.handleChange.bind(this),value:s,labelText:this.props.controlItem,hideLabel:this.props.tableControl,light:this.props.controller.getLight()&&this.props.control.light,tooltipAlignment:"end",showPasswordLabel:a,hidePasswordLabel:i}))),O.default.createElement(fa,{inTable:this.props.tableControl,tableOnly:!0,state:this.props.state,messageInfo:this.props.messageInfo}))}}]),a}(O.default.Component),Ui=c.connect((function(e,t){return{value:t.controller.getPropertyValue(t.propertyId),state:t.controller.getControlState(t.propertyId),messageInfo:t.controller.getErrorMessage(t.propertyId)}}),null)(Vi);function zi(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var Hi=function(r){t._inherits(n,r);var o=zi(n);function n(r){var a;if(e._classCallCheck(this,n),(a=o.call(this,r)).id=ft(a.props.propertyId),a.getDateFormat=a.getDateFormat.bind(t._assertThisInitialized(a)),a.handleChange=a.handleChange.bind(t._assertThisInitialized(a)),a.value=r.value,a.value){var i=S.parse(a.value,u.DEFAULT_DATE_FORMAT,new Date);S.isValid(i)&&(a.value=S.format(i,a.getDateFormat()))}else a.value="";return a}return e._createClass(n,[{key:"getDateFormat",value:function(){var e=this.props.control.dateFormat||u.DEFAULT_DATE_FORMAT;return e=e.replace(/Y/g,"y").replace(/D/g,"d")}},{key:"handleChange",value:function(e){var t=null;if(this.value="",e.target.value){this.value=e.target.value;var r=S.parse(e.target.value,this.getDateFormat(),new Date);t=S.isValid(r)?S.format(r,u.DEFAULT_DATE_FORMAT):e.target.value}this.props.controller.updatePropertyValue(this.props.propertyId,t)}},{key:"render",value:function(){var e=u.classNames("properties-datefield","properties-input-control",{hide:this.props.state===u.STATES.HIDDEN},this.props.messageInfo?this.props.messageInfo.type:null),t=bt(this.props.messageInfo,this.props.tableControl);return O.default.createElement("div",{className:e,"data-id":ht(this.props.propertyId)},O.default.createElement(l.TextInput,u._extends({},t,{autoComplete:"off",id:this.id,disabled:this.props.state===u.STATES.DISABLED,placeholder:this.props.control.additionalText,onChange:this.handleChange.bind(this),value:this.value,labelText:this.props.controlItem,hideLabel:this.props.tableControl,light:this.props.controller.getLight()&&this.props.control.light})),O.default.createElement(fa,{inTable:this.props.tableControl,tableOnly:!0,state:this.props.state,messageInfo:this.props.messageInfo}))}}]),n}(O.default.Component),ji=c.connect((function(e,t){return{value:t.controller.getPropertyValue(t.propertyId),state:t.controller.getControlState(t.propertyId),messageInfo:t.controller.getErrorMessage(t.propertyId)}}),null)(Hi);function Gi(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var qi=function(r){t._inherits(n,r);var o=Gi(n);function n(r){var a;if(e._classCallCheck(this,n),(a=o.call(this,r)).id=ft(r.propertyId),a.value=r.value,a.value){var i=S.parse(a.value,"HH:mm:ss:xxx",new Date);S.isValid(i)&&(a.value=S.format(i,a.getTimeFormat()))}else a.value="";return a.getTimeFormat=a.getTimeFormat.bind(t._assertThisInitialized(a)),a.handleChange=a.handleChange.bind(t._assertThisInitialized(a)),a}return e._createClass(n,[{key:"getTimeFormat",value:function(){return this.props.control.timeFormat||u.DEFAULT_TIME_FORMAT}},{key:"handleChange",value:function(e){var t=null;if(this.value="",e.target.value){this.value=e.target.value;var r=S.parse(e.target.value,this.getTimeFormat(),new Date);t=S.isValid(r)?S.format(r,"HH:mm:ss:xxx"):e.target.value}this.props.controller.updatePropertyValue(this.props.propertyId,t)}},{key:"render",value:function(){var e=u.classNames("properties-timefield","properties-input-control",{hide:this.props.state===u.STATES.HIDDEN},this.props.messageInfo?this.props.messageInfo.type:null),t=bt(this.props.messageInfo,this.props.tableControl);return O.default.createElement("div",{className:e,"data-id":ht(this.props.propertyId)},O.default.createElement(l.TextInput,u._extends({},t,{autoComplete:"off",id:this.id,disabled:this.props.state===u.STATES.DISABLED,placeholder:this.props.control.additionalText,onChange:this.handleChange.bind(this),value:this.value,labelText:this.props.controlItem,hideLabel:this.props.tableControl,light:this.props.controller.getLight()&&this.props.control.light})),O.default.createElement(fa,{inTable:this.props.tableControl,tableOnly:!0,state:this.props.state,messageInfo:this.props.messageInfo}))}}]),n}(O.default.Component),Yi=c.connect((function(e,t){return{value:t.controller.getPropertyValue(t.propertyId),state:t.controller.getControlState(t.propertyId),messageInfo:t.controller.getErrorMessage(t.propertyId)}}),null)(qi);function Ki(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var Wi=function(r){t._inherits(n,r);var o=Ki(n);function n(t){var r;return e._classCallCheck(this,n),(r=o.call(this,t)).id=ft(r.props.propertyId),r}return e._createClass(n,[{key:"handleChange",value:function(e){this.props.controller.updatePropertyValue(this.props.propertyId,e)}},{key:"render",value:function(){var e=this.props.control.label?this.props.control.label.text:"",t=m.v4()+"-tooltip-"+this.props.control.name,r="";this.props.control.description&&this.props.state!==u.STATES.DISABLED&&this.props.state!==u.STATES.HIDDEN&&!this.props.tableControl&&(r=O.default.createElement("span",null,this.props.control.description.text),this.props.control.description.link&&(this.props.control.description.link.propertyId=this.props.propertyId));var o=a.isEmpty_1(r)?"":O.default.createElement(y,{id:t,tip:r,link:this.props.control.description.link?this.props.control.description.link:null,tooltipLinkHandler:this.props.controller.getHandlers().tooltipLinkHandler,direction:"bottom",className:"properties-tooltips",showToolTipOnClick:!0},O.default.createElement(h.Icon,{type:u.CARBON_ICONS.INFORMATION,className:"properties-control-description-icon-info"})),n=O.default.createElement("span",{className:"properties-checkbox-label"},e);return O.default.createElement("div",{className:u.classNames("properties-checkbox",{hide:this.props.state===u.STATES.HIDDEN},this.props.messageInfo?this.props.messageInfo.type:null),"data-id":ht(this.props.propertyId)},O.default.createElement(l.Checkbox,{disabled:this.props.state===u.STATES.DISABLED,id:this.id,labelText:n,onChange:this.handleChange.bind(this),checked:Boolean(this.props.value),hideLabel:this.props.tableControl}),o,O.default.createElement(fa,{inTable:this.props.tableControl,state:this.props.state,messageInfo:this.props.controller.getErrorMessage(this.props.propertyId)}))}}]),n}(O.default.Component),Xi=c.connect((function(e,t){return{value:t.controller.getPropertyValue(t.propertyId),state:t.controller.getControlState(t.propertyId),messageInfo:t.controller.getErrorMessage(t.propertyId)}}),null)(Wi);function $i(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var Ji=function(r){t._inherits(a,r);var n=$i(a);function a(t){var r;return e._classCallCheck(this,a),(r=n.call(this,t)).id=ft(r.props.propertyId),r}return e._createClass(a,[{key:"handleChange",value:function(e){this.props.controller.updatePropertyValue(this.props.propertyId,e)}},{key:"render",value:function(){var e="".concat(this.props.control.name,".toggle.on.label"),t="".concat(this.props.control.name,".toggle.off.label"),r=o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.TOGGLE_ON_LABEL),n=o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.TOGGLE_OFF_LABEL),a=this.props.controller.getResource(e,r),i=this.props.controller.getResource(t,n),s=this.props.tableControl?"sm":"md",p=O.default.createElement(l.Toggle,{id:this.id,size:s,disabled:this.props.state===u.STATES.DISABLED,toggled:Boolean(this.props.value),labelB:a,labelA:i,onToggle:this.handleChange.bind(this),labelText:this.props.tableControl?null:this.props.controlItem}),c=u.classNames("properties-toggle",{hide:this.props.state===u.STATES.HIDDEN},this.props.messageInfo?this.props.messageInfo.type:null);return O.default.createElement("div",{className:c,"data-id":ht(this.props.propertyId)},p,O.default.createElement(fa,{inTable:this.props.tableControl,state:this.props.state,messageInfo:this.props.messageInfo}))}}]),a}(O.default.Component),Zi=c.connect((function(e,t){return{value:t.controller.getPropertyValue(t.propertyId),state:t.controller.getControlState(t.propertyId),messageInfo:t.controller.getErrorMessage(t.propertyId)}}),null)(Ji);function Qi(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var es=function(r){t._inherits(i,r);var n=Qi(i);function i(r){var o;return e._classCallCheck(this,i),(o=n.call(this,r)).uuid=m.v4(),o.handleChange=o.handleChange.bind(t._assertThisInitialized(o)),o.updateValueFromFilterEnum=o.updateValueFromFilterEnum.bind(t._assertThisInitialized(o)),o}return e._createClass(i,[{key:"componentDidMount",value:function(){this.updateValueFromFilterEnum(!0)}},{key:"componentDidUpdate",value:function(e){o.isEqual_1(this.props.controlOpts,e.controlOpts)||this.updateValueFromFilterEnum()}},{key:"updateValueFromFilterEnum",value:function(e){if(Array.isArray(this.props.value)){var t=pa(this.props.value,this.props.controlOpts.values);o.isEqual_1(this.props.value,t)||this.props.controller.updatePropertyValue(this.props.propertyId,t,e)}}},{key:"handleChange",value:function(e,t){var r=this.props.controller.getPropertyValue(this.props.propertyId);null==r&&(r=[]);var o=r.indexOf(e);t&&o<0&&(r=r.concat([e])),!t&&o>=0&&r.splice(o,1);var n=r.concat();this.props.controller.updatePropertyValue(this.props.propertyId,n)}},{key:"render",value:function(){var e=this.props.state===u.STATES.HIDDEN,t=this.props.value;null==t&&(t=[]);for(var r=[],o=0;o<this.props.control.values.length;o++){var n=this.props.control.values[o],i=this.props.state===u.STATES.DISABLED||!this.props.controlOpts.values.includes(n),s=null;if(Array.isArray(this.props.control.valueDescs)&&!a.isEmpty_1(this.props.control.valueDescs[o])&&!this.props.tableControl){var p=O.default.createElement("span",null,this.props.control.valueDescs[o]);s=O.default.createElement(y,{id:"tooltip-".concat(this.uuid,"-").concat(o),tip:p,direction:"bottom",className:"properties-tooltips",showToolTipOnClick:!0,disable:e||i},O.default.createElement(d.Information16,{disabled:i,className:"properties-control-description-icon-info"}))}var c={name:this.props.propertyId.name,row:o},f=t.indexOf(n)>=0;r.push(O.default.createElement("div",{className:"properties-checkbox-tooltip-container",key:ft(c,this.uuid)},O.default.createElement(l.Checkbox,{disabled:i,id:ft(c,this.uuid),key:n+o,labelText:this.props.control.valueLabels[o],onChange:this.handleChange.bind(this,n),checked:f}),s))}return O.default.createElement("fieldset",null,O.default.createElement("legend",null,this.props.controlItem),O.default.createElement("div",{className:u.classNames("properties-checkboxset",{hide:this.props.state===u.STATES.HIDDEN}),"data-id":ht(this.props.propertyId)},O.default.createElement("div",{className:u.classNames("properties-checkboxset-container",this.props.messageInfo?this.props.messageInfo.type:null)},r),O.default.createElement(fa,{inTable:this.props.tableControl,state:this.props.state,messageInfo:this.props.messageInfo})))}}]),i}(O.default.Component),ts=c.connect((function(e,t){var r={value:t.controller.getPropertyValue(t.propertyId),state:t.controller.getControlState(t.propertyId),messageInfo:t.controller.getErrorMessage(t.propertyId)};return r.controlOpts=t.controller.getFilteredEnumItems(t.propertyId,t.control),r}),null)(es);function rs(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return os(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return os(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function os(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function ns(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var as=function(r){t._inherits(i,r);var n=ns(i);function i(r){var o;return e._classCallCheck(this,i),(o=n.call(this,r)).uuid=m.v4(),o.handleChange=o.handleChange.bind(t._assertThisInitialized(o)),o.updateValueFromFilterEnum=o.updateValueFromFilterEnum.bind(t._assertThisInitialized(o)),o}return e._createClass(i,[{key:"componentDidMount",value:function(){this.updateValueFromFilterEnum(!0,u.UPDATE_TYPE.INITIAL_LOAD);var e=this.props.controller.getPropertyValue(this.props.propertyId);this.setEnabledStateOfOptionalPanels(e),void 0!==this.props.value&&null!==this.props.value&&this.handleCheckedDisabled(this.props.value,this.isRadioButtonDisabled(String(this.props.value)))}},{key:"componentDidUpdate",value:function(e){o.isEqual_1(this.props.controlOpts,e.controlOpts)||this.updateValueFromFilterEnum(),void 0!==this.props.value&&null!==this.props.value&&this.handleCheckedDisabled(this.props.value,this.isRadioButtonDisabled(String(this.props.value)))}},{key:"setEnabledStateOfOptionalPanels",value:function(e){if(this.props.control.optionalPanels){var t=this.props.controlOpts,r=this.props.controller.getPanelStates();this.props.controller.parsePanelTree();for(var o=0;o<t.values.length;o++){var n=t.values[o];Fn(r,{name:n},t.values[o]===e?u.STATES.ENABLED:u.STATES.DISABLED,n)}this.props.controller.setPanelStates(r),function(e,t){for(var r={controls:t.getControlStates(),panels:t.getPanelStates(),actions:t.getActionStates()},o=0;o<e.length;o++){var n=t.getPanelState({name:e[o]});Xn(r,{name:e[o]},n,t)}t.setControlStates(r.controls),t.setPanelStates(r.panels),t.setActionStates(r.actions)}(t.values,this.props.controller)}}},{key:"getOptionalPanel",value:function(e){return this.props.control.optionalPanels?this.props.control.optionalPanels[e]:null}},{key:"updateValueFromFilterEnum",value:function(e,t){if(null!==this.props.value&&void 0!==this.props.value&&!this.props.controlOpts.values.includes(this.props.value)){var r=null;this.props.control.valueDef&&this.props.control.valueDef.defaultValue&&this.props.controlOpts.values.includes(this.props.control.valueDef.defaultValue)&&(r=this.props.control.valueDef.defaultValue),this.props.controller.updatePropertyValue(this.props.propertyId,r,e,t)}}},{key:"convertTargetValue",value:function(e){return"boolean"===this.props.control.valueDef.propType?"true"===e:"integer"===this.props.control.valueDef.propType||"long"===this.props.control.valueDef.propType||"double"===this.props.control.valueDef.propType?Number(e):e}},{key:"handleChange",value:function(e){var t=this.props.controller.getPropertyValue(this.props.propertyId),r=this.convertTargetValue(e);this.props.controller.updatePropertyValue(this.props.propertyId,r),t!==r&&this.setEnabledStateOfOptionalPanels(r)}},{key:"isRadioButtonDisabled",value:function(e){var t=this.props.valueStates;return!!(t&&t[e]&&t[e].value)&&t[e].value===u.STATES.DISABLED}},{key:"handleCheckedDisabled",value:function(e,t){if(null!=e&&t&&this.props.state!==u.STATES.DISABLED){var r,o=this.props.controller.getControl(this.props.propertyId),n=this.props.control.valueDef.defaultValue;if(n&&!this.isRadioButtonDisabled(n))r=n;else{var a,i=rs(o.values);try{for(i.s();!(a=i.n()).done;){var s=a.value;if(s!==e&&!this.isRadioButtonDisabled(s)){r=s;break}}}catch(e){i.e(e)}finally{i.f()}}r&&this.props.controller.updatePropertyValue(this.props.propertyId,r)}}},{key:"render",value:function(){var e=this.props.state===u.STATES.DISABLED,t=this.props.state===u.STATES.HIDDEN;this.props.control.values||"radioset"!==this.props.control.controlType||(this.props.control.values=[!0,!1],this.props.control.valueLabels=["true","false"]);for(var r=[],n=this.props.controlOpts,i=0;i<n.values.length;i++){var s=null;if(Array.isArray(this.props.control.valueDescs)&&!a.isEmpty_1(this.props.control.valueDescs[i])&&!this.props.tableControl){var p=O.default.createElement("span",null,this.props.control.valueDescs[i]);s=O.default.createElement(y,{id:"tooltip-".concat(this.uuid,"-").concat(i),tip:p,direction:"bottom",className:"properties-tooltips",showToolTipOnClick:!0,disable:t||e},O.default.createElement(d.Information16,{disabled:e,className:"properties-control-description-icon-info"}))}var c=n.values[i]===this.props.value,f="boolean"===this.props.control.valueDef.propType?String(n.values[i]):n.values[i],h=this.isRadioButtonDisabled(f),m=this.getOptionalPanel(f),v={name:this.props.propertyId.name,row:i};r.push(O.default.createElement("div",{key:i,className:"properties-radioset-panel"},O.default.createElement("div",{className:"properties-radioset-tooltip"},O.default.createElement(l.RadioButton,{key:i,id:ft(v,this.uuid),disabled:e||h,labelText:n.valueLabels[i],value:f,onChange:this.handleChange,checked:c}),s),m))}return O.default.createElement("div",{"data-id":ht(this.props.control,this.props.propertyId),className:u.classNames("properties-radioset ",{hide:this.props.state===u.STATES.HIDDEN})},O.default.createElement("div",{className:u.classNames("properties-radio-button-group",this.props.messageInfo?this.props.messageInfo.type:null,{horizontal:this.props.control.orientation!==o.ORIENTATIONS.VERTICAL}),disabled:this.props.state===u.STATES.DISABLED},r),O.default.createElement(fa,{state:this.props.state,messageInfo:this.props.messageInfo,inTable:this.props.tableControl}))}}]),i}(O.default.Component),is=c.connect((function(e,t){return{value:t.controller.getPropertyValue(t.propertyId),state:t.controller.getControlState(t.propertyId),valueStates:t.controller.getControlValueStates(t.propertyId),messageInfo:t.controller.getErrorMessage(t.propertyId),controlOpts:t.controller.getFilteredEnumItems(t.propertyId,t.control)}}),null)(as);function ss(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return ls(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ls(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function ls(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function us(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var ps=function(r){t._inherits(i,r);var n=us(i);function i(r){var s;if(e._classCallCheck(this,i),(s=n.call(this,r)).reactIntl=r.controller.getReactIntl(),s.emptyLabel="...",s.disableEmptyListDropdown=!1,a.isEmpty_1(r.controlOpts)){var l="".concat(s.props.control.name,".emptyList.placeholder"),p=o.formatMessage(s.reactIntl,u.MESSAGE_KEYS.EMPTY_LIST_PLACEHOLDER);s.emptyLabel=r.controller.getResource(l,p),s.emptyLabel!==p&&(s.disableEmptyListDropdown=!0)}else r.control.additionalText&&(s.emptyLabel=r.control.additionalText);return s.id=ft(s.props.propertyId),s.handleChange=s.handleChange.bind(t._assertThisInitialized(s)),s.handleComboOnChange=s.handleComboOnChange.bind(t._assertThisInitialized(s)),s.handleOnInputChange=s.handleOnInputChange.bind(t._assertThisInitialized(s)),s.genSchemaSelectOptions=s.genSchemaSelectOptions.bind(t._assertThisInitialized(s)),s.genSelectOptions=s.genSelectOptions.bind(t._assertThisInitialized(s)),s.genFieldSelectOptions=s.genFieldSelectOptions.bind(t._assertThisInitialized(s)),s.updateValueFromFilterEnum=s.updateValueFromFilterEnum.bind(t._assertThisInitialized(s)),s}return e._createClass(i,[{key:"componentDidMount",value:function(){this.updateValueFromFilterEnum(!0,u.UPDATE_TYPE.INITIAL_LOAD)}},{key:"componentDidUpdate",value:function(e){o.isEqual_1(this.props.controlOpts,e.controlOpts)||this.updateValueFromFilterEnum()}},{key:"getSelectedOption",value:function(e,t){var r=o.stringifyFieldValue(t,this.props.control),n=e.find((function(e){return e.value===r}));return(null===(n=void 0===n?null:n)&&r||this.props.control.customValueAllowed)&&(n={value:r,label:r}),n}},{key:"genSchemaSelectOptions",value:function(e){var t=[];if(t.push({value:"",label:this.emptyLabel}),Array.isArray(this.props.controlOpts)){var r,o=ss(this.props.controlOpts);try{for(o.s();!(r=o.n()).done;){var n=r.value;t.push({value:n,label:n})}}catch(e){o.e(e)}finally{o.f()}}return{options:t,selectedOption:this.getSelectedOption(t,e)}}},{key:"genFieldSelectOptions",value:function(e){var t=[];t.push({value:"",label:this.emptyLabel});var r,o=ss(this.props.controlOpts);try{for(o.s();!(r=o.n()).done;){var n=r.value;t.push({value:n.name,label:n.name})}}catch(e){o.e(e)}finally{o.f()}return{options:t,selectedOption:this.getSelectedOption(t,e)}}},{key:"genSelectOptions",value:function(e){for(var t=[],r=0;r<this.props.controlOpts.values.length;r++)t.push({value:this.props.controlOpts.values[r],label:this.props.controlOpts.valueLabels[r]});return{options:t,selectedOption:this.getSelectedOption(t,e)}}},{key:"updateValueFromFilterEnum",value:function(e,t){if(this.props.control.controlType===o.ControlType.ONEOFSELECT&&null!==this.props.value&&void 0!==this.props.value&&!this.props.controlOpts.values.includes(this.props.value)){var r=null;this.props.control.valueDef&&this.props.control.valueDef.defaultValue&&this.props.controlOpts.values.includes(this.props.control.valueDef.defaultValue)?r=this.props.control.valueDef.defaultValue:this.props.control.customValueAllowed&&this.props.value&&(r=this.props.value),this.props.controller.updatePropertyValue(this.props.propertyId,r,e,t)}}},{key:"handleChange",value:function(e){var t=this.props.tableControl?e.target.value:e.selectedItem.value;this.props.control.controlType===o.ControlType.SELECTCOLUMN&&(t=o.fieldStringToValue(t,this.props.control,this.props.controller)),this.props.controller.updatePropertyValue(this.props.propertyId,t)}},{key:"handleComboOnChange",value:function(e){var t=e.selectedItem&&e.selectedItem.value?e.selectedItem.value:"";this.props.control.controlType===o.ControlType.SELECTCOLUMN&&(t=o.fieldStringToValue(t,this.props.control,this.props.controller)),this.props.controller.updatePropertyValue(this.props.propertyId,t)}},{key:"handleOnInputChange",value:function(e){if(null!==e){var t=e;this.props.controller.updatePropertyValue(this.props.propertyId,t)}}},{key:"render",value:function(){var e;e=this.props.control.controlType===o.ControlType.SELECTSCHEMA?this.genSchemaSelectOptions(this.props.value):this.props.control.controlType===o.ControlType.SELECTCOLUMN?this.genFieldSelectOptions(this.props.value):this.genSelectOptions(this.props.value);var t={"close.menu":o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.DROPDOWN_TOOLTIP_CLOSEMENU),"open.menu":o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.DROPDOWN_TOOLTIP_OPENMENU)},r=null,n=bt(this.props.messageInfo,this.props.tableControl);if(this.props.tableControl){var a=[],i=e.selectedOption&&e.selectedOption.value?e.selectedOption.value:"";e.selectedOption||a.push(O.default.createElement(l.SelectItem,{text:this.emptyLabel,key:this.id,value:""}));var s,p=ss(e.options);try{for(p.s();!(s=p.n()).done;){var c=s.value;a.push(O.default.createElement(l.SelectItem,{text:c.label,key:this.id+"-"+c.value,value:c.value}))}}catch(e){p.e(e)}finally{p.f()}r=O.default.createElement(l.Select,{id:this.id,hideLabel:!0,inline:!0,labelText:this.props.control.label?this.props.control.label.text:"",disabled:this.props.state===u.STATES.DISABLED||this.disableEmptyListDropdown,onChange:this.handleChange,value:i,light:this.props.controller.getLight()&&this.props.control.light},a)}else r=this.props.control.customValueAllowed?O.default.createElement(l.ComboBox,u._extends({},n,{ariaLabel:this.props.control.label?this.props.control.label.text:"",id:"".concat(ht(this.props.propertyId),"-dropdown"),disabled:this.props.state===u.STATES.DISABLED||this.disableEmptyListDropdown,placeholder:e.selectedOption.label,selectedItem:e.selectedOption.label,items:e.options,onChange:this.handleComboOnChange,onInputChange:this.handleOnInputChange,light:this.props.controller.getLight()&&this.props.control.light,translateWithId:function(e){return t[e]},titleText:this.props.controlItem})):O.default.createElement(l.Dropdown,u._extends({},n,{id:"".concat(ht(this.props.propertyId),"-dropdown"),disabled:this.props.state===u.STATES.DISABLED||this.disableEmptyListDropdown,type:"default",items:e.options,onChange:this.handleChange,selectedItem:e.selectedOption,label:this.emptyLabel,light:this.props.controller.getLight()&&this.props.control.light,translateWithId:function(e){return t[e]},titleText:this.props.controlItem}));return O.default.createElement("div",{"data-id":ht(this.props.propertyId),className:u.classNames("properties-dropdown",{hide:this.props.state===u.STATES.HIDDEN},this.props.messageInfo?this.props.messageInfo.type:null)},r,O.default.createElement(fa,{state:this.props.state,messageInfo:this.props.messageInfo,inTable:this.props.tableControl,tableOnly:!0}))}}]),i}(O.default.Component),cs=c.connect((function(e,t){var r={value:t.controller.getPropertyValue(t.propertyId),state:t.controller.getControlState(t.propertyId),messageInfo:t.controller.getErrorMessage(t.propertyId)};return t.control.controlType===o.ControlType.SELECTSCHEMA?r.controlOpts=t.controller.getDatasetMetadataSchemas():t.control.controlType===o.ControlType.SELECTCOLUMN?r.controlOpts=t.controller.getFilteredDatasetMetadata(t.propertyId):r.controlOpts=t.controller.getFilteredEnumItems(t.propertyId,t.control),r}),null)(ps);function ds(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var fs=function(r){t._inherits(i,r);var n=ds(i);function i(r){var o;return e._classCallCheck(this,i),(o=n.call(this,r)).reactIntl=r.controller.getReactIntl(),o.getSelectedOption=o.getSelectedOption.bind(t._assertThisInitialized(o)),o.genSelectOptions=o.genSelectOptions.bind(t._assertThisInitialized(o)),o.handleOnChange=o.handleOnChange.bind(t._assertThisInitialized(o)),o.updateValueFromFilterEnum=o.updateValueFromFilterEnum.bind(t._assertThisInitialized(o)),o.setShouldRender=o.setShouldRender.bind(t._assertThisInitialized(o)),o.state={shouldRender:!0},o}return e._createClass(i,[{key:"componentDidMount",value:function(){this.updateValueFromFilterEnum(!0)}},{key:"componentDidUpdate",value:function(e){o.isEqual_1(this.props.controlOpts,e.controlOpts)||this.updateValueFromFilterEnum(),this.setShouldRender(e)}},{key:"setShouldRender",value:function(e){!o.isEqual_1(this.props.controlOpts.values,e.controlOpts.values)&&this.state.shouldRender?this.setState({shouldRender:!1}):this.state.shouldRender||this.setState({shouldRender:!0})}},{key:"getSelectedOption",value:function(e,t){var r=o.stringifyFieldValue(t,this.props.control),n=[];return r&&r.forEach((function(t){return n.push(e.find((function(e){return e.id===t})))})),n}},{key:"genSelectOptions",value:function(e){for(var t=[],r=0;r<this.props.controlOpts.values.length;r++)t.push({id:this.props.controlOpts.values[r],label:this.props.controlOpts.valueLabels[r]});return{options:t,selectedOptions:this.getSelectedOption(t,e)}}},{key:"updateValueFromFilterEnum",value:function(e){var t=pa(this.props.value,this.props.controlOpts.values);o.isEqual_1(t,this.props.value)||(a.isEmpty_1(t)&&this.props.control.valueDef&&this.props.control.valueDef.defaultValue&&(t=pa(this.props.control.valueDef.defaultValue,this.props.controlOpts.values)),this.props.controller.updatePropertyValue(this.props.propertyId,t,e))}},{key:"handleOnChange",value:function(e){for(var t=[],r=0;r<e.selectedItems.length;r++)t.push(e.selectedItems[r].id);this.props.controller.updatePropertyValue(this.props.propertyId,t)}},{key:"render",value:function(){var e=this.genSelectOptions(this.props.value);if(!this.state.shouldRender)return null;var t={"close.menu":o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.DROPDOWN_TOOLTIP_CLOSEMENU),"open.menu":o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.DROPDOWN_TOOLTIP_OPENMENU),"clear.all":o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.DROPDOWN_TOOLTIP_CLEARALL),"clear.selection":o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.DROPDOWN_TOOLTIP_CLEARSELECTION)},r="".concat(this.props.control.name,".multiselect.dropdown.empty.label"),n=o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.MULTISELECT_DROPDOWN_EMPTY_LABEL),a="".concat(this.props.control.name,".multiselect.dropdown.options.selected.label"),i=o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.MULTISELECT_DROPDOWN_OPTIONS_SELECTED_LABEL),s="";s=0===e.selectedOptions.length?this.props.controller.getResource(r,n):this.props.controller.getResource(a,i);var p=bt(this.props.messageInfo,this.props.tableControl),c=null;return c=this.props.control.filterable?O.default.createElement(l.FilterableMultiSelect,u._extends({},p,{id:"".concat(ht(this.props.propertyId),"-multiselect-filterable"),disabled:this.props.state===u.STATES.DISABLED,translateWithId:function(e){return t[e]},items:e.options,initialSelectedItems:e.selectedOptions,onChange:this.handleOnChange,placeholder:s,titleText:this.props.tableControl?null:this.props.controlItem,light:this.props.controller.getLight()&&this.props.control.light})):O.default.createElement(l.MultiSelect,u._extends({},p,{id:"".concat(ht(this.props.propertyId),"-multiselect"),disabled:this.props.state===u.STATES.DISABLED,translateWithId:function(e){return t[e]},items:e.options,selectedItems:e.selectedOptions,onChange:this.handleOnChange,label:s,titleText:this.props.tableControl?null:this.props.controlItem,light:this.props.controller.getLight()&&this.props.control.light})),O.default.createElement("div",{"data-id":ht(this.props.propertyId),className:u.classNames("properties-dropdown",{hide:this.props.state===u.STATES.HIDDEN},this.props.messageInfo?this.props.messageInfo.type:null)},c,O.default.createElement(fa,{state:this.props.state,tableOnly:!0,messageInfo:this.props.messageInfo,inTable:this.props.tableControl}))}}]),i}(O.default.Component),hs=c.connect((function(e,t){return{value:t.controller.getPropertyValue(t.propertyId),state:t.controller.getControlState(t.propertyId),messageInfo:t.controller.getErrorMessage(t.propertyId),controlOpts:t.controller.getFilteredEnumItems(t.propertyId,t.control)}}),null)(fs);function ms(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var ys=function(r){t._inherits(a,r);var n=ms(a);function a(r){var o;return e._classCallCheck(this,a),(o=n.call(this,r)).genSelectOptions=o.genSelectOptions.bind(t._assertThisInitialized(o)),o.updateValueFromFilterEnum=o.updateValueFromFilterEnum.bind(t._assertThisInitialized(o)),o.updateSelections=o.updateSelections.bind(t._assertThisInitialized(o)),o}return e._createClass(a,[{key:"componentDidMount",value:function(){this.updateValueFromFilterEnum(!0,u.UPDATE_TYPE.INITIAL_LOAD)}},{key:"componentDidUpdate",value:function(e){o.isEqual_1(this.props.controlOpts,e.controlOpts)||this.updateValueFromFilterEnum()}},{key:"updateValueFromFilterEnum",value:function(e,t){var r=pa(this.props.value,this.props.controlOpts.values);o.isEqual_1(r,this.props.value)||this.props.controller.updatePropertyValue(this.props.propertyId,r,e,t)}},{key:"updateSelections",value:function(e){for(var t=[],r=0;r<e.length;r++){var o=this.props.controlOpts.values[e[r]];t.push(o)}this.props.controller.updatePropertyValue(this.props.propertyId,t)}},{key:"genSelectOptions",value:function(e){for(var t={options:[],selected:[]},r=0;r<this.props.controlOpts.values.length;r++){-1!==e.indexOf(this.props.controlOpts.values[r])&&t.selected.push(r);var o=[];o.push({column:"someofselect",state:this.props.state,content:this.props.controlOpts.valueLabels[r]}),t.options.push({className:"table-row",columns:o,disabled:this.props.state===u.STATES.DISABLED})}return t}},{key:"render",value:function(){var e=this.props.value;null==e&&(e=[]);var t=this.genSelectOptions(e),r=this.props.control.rows?this.props.control.rows:5.5,o=this.props.control.label&&this.props.control.label.text?this.props.control.label.text:"";return O.default.createElement("div",{"data-id":ht(this.props.control,this.props.propertyId),className:u.classNames("properties-someofselect ",{hide:this.props.state===u.STATES.HIDDEN},this.props.messageInfo?this.props.messageInfo.type:null)},this.props.controlItem,O.default.createElement(s.FlexibleTable,{columns:[{key:"someofselect",label:""}],rows:r,data:t.options,scrollKey:this.props.control.name,tableLabel:o,selectedRows:t.selected,updateRowSelections:this.updateSelections,selectable:!0,showHeader:!1,light:this.props.controller.getLight()&&this.props.control.light,emptyTablePlaceholder:this.props.control.additionalText}),O.default.createElement(fa,{state:this.props.state,messageInfo:this.props.messageInfo,inTable:this.props.tableControl}))}}]),a}(O.default.Component),vs=c.connect((function(e,t){return{value:t.controller.getPropertyValue(t.propertyId),state:t.controller.getControlState(t.propertyId),messageInfo:t.controller.getErrorMessage(t.propertyId),controlOpts:t.controller.getFilteredEnumItems(t.propertyId,t.control)}}),null)(ys);function gs(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var bs=function(r){t._inherits(i,r);var n=gs(i);function i(r){var a;return e._classCallCheck(this,i),(a=n.call(this,r)).reactIntl=r.controller.getReactIntl(),a.emptyTableButtonClickHandler=a.addOnClick.bind(t._assertThisInitialized(a),a.props.propertyId),a.emptyTableButtonLabel=o.formatMessage(a.reactIntl,u.MESSAGE_KEYS.STRUCTURETABLE_ADDBUTTON_LABEL),a}return e._createClass(i,[{key:"makeRows",value:function(e,t){var r=[];if(e)for(var n=0;n<e.length;n++){var a=[],i=void 0!==this.props.propertyId.row?{row:this.props.propertyId.row,index:n}:{row:n},s=Object.assign({},this.props.propertyId,i),l=Object.assign({},this.props.control);if(l.dmImage){var u=this.props.controller.getDatasetMetadataFields(),p=o.stringifyFieldValue(this.props.controller.getPropertyValue(s),l,!0),c=o.getDMFieldIcon(u,p,l.dmImage);l.icon=c}var d=O.default.createElement("div",{className:"properties-table-cell-control"},O.default.createElement(ya,{control:l,propertyId:s,controller:this.props.controller,tableControl:!0}));a.push({key:n+"-0-field",column:"field",content:d}),r.push({key:n,onClickCallback:this.handleRowClick.bind(this,n,!1),columns:a,className:"column-select-table-row"})}return r}},{key:"onFieldPickerClose",value:function(e,t){if(e&&t){this.setCurrentControlValueSelected(e,t);var r=t[t.length-1];this.setScrollToRow(r)}}},{key:"makeHeader",value:function(){var e=[];return e.push({key:"field",label:o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.FIELDPICKER_FIELDCOLUMN_LABEL),description:null}),e}},{key:"render",value:function(){var e,t=this.makeHeader(),r={fieldPickerCloseFunction:this.onFieldPickerClose},o=this.makeRows(this.props.value,this.props.state),n=this.makeAddRemoveButtonPanel(this.props.state,r);Number.isInteger(this.scrollToRow)&&o.length>this.scrollToRow&&(e=this.scrollToRow,delete this.scrollToRow);var i=this.props.control.label&&this.props.control.label.text?this.props.control.label.text:"",l=O.default.createElement(s.FlexibleTable,{columns:t,data:o,scrollToRow:e,topRightPanel:n,scrollKey:this.props.control.name,tableState:this.props.state,messageInfo:this.props.messageInfo,rows:this.props.control.rows,tableLabel:i,selectedRows:this.props.selectedRows,rowSelection:this.props.control.rowSelection,updateRowSelections:this.updateRowSelections,light:this.props.controller.getLight()&&this.props.control.light,emptyTablePlaceholder:this.props.control.additionalText}),p=O.default.createElement("div",null,O.default.createElement("div",{className:"properties-column-select-table"},l),O.default.createElement(fa,{state:this.props.state,messageInfo:this.props.messageInfo}));return O.default.createElement("div",{"data-id":ht(this.props.propertyId),className:"properties-column-select"},this.props.controlItem,O.default.createElement(Za,{tableContainer:p,control:this.props.control,controller:this.props.controller,propertyId:this.props.propertyId,setScrollToRow:this.setScrollToRow,setCurrentControlValueSelected:this.setCurrentControlValueSelected,disabled:this.props.state===u.STATES.DISABLED,isEmptyTable:a.isEmpty_1(this.props.value),emptyTableButtonLabel:this.emptyTableButtonLabel,emptyTableButtonClickHandler:this.emptyTableButtonClickHandler}))}}]),i}(Ya);bs.propTypes={control:L.default.object.isRequired,propertyId:L.default.object.isRequired,controller:L.default.object.isRequired,controlItem:L.default.element,openFieldPicker:L.default.func.isRequired,selectedRows:L.default.array,state:L.default.string,value:L.default.array,messageInfo:L.default.object,addRemoveRows:L.default.bool,tableButtons:L.default.object};var Es=c.connect((function(e,t){return{value:t.controller.getPropertyValue(t.propertyId),state:t.controller.getControlState(t.propertyId),messageInfo:t.controller.getErrorMessage(t.propertyId),selectedRows:t.controller.getSelectedRows(t.propertyId),addRemoveRows:t.controller.getAddRemoveRows(t.propertyId),tableButtons:t.controller.getTableButtons(t.propertyId)}}),null)(bs);function _s(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var Ss=function(r){t._inherits(a,r);var o=_s(a);function a(t){var r;return e._classCallCheck(this,a),(r=o.call(this,t)).controlFactory=new Xs(r.props.controller),r.controlFactory.setFunctions(r.props.openFieldPicker,r.props.buildUIItem),r}return e._createClass(a,[{key:"_getSubControlDef",value:function(e){for(var t=0;t<this.props.control.subControls.length;t++)if(this.props.control.subControls[t].name===e)return this.props.control.subControls[t];return null}},{key:"_getColumnIndex",value:function(e){for(var t=0;t<this.props.control.subControls.length;t++)if(this.props.control.subControls[t].name===e)return t;return null}},{key:"_makeRow",value:function(e){for(var t=[],r=0;r<e.length;r++){var o=this._getSubControlDef(e[r]);if(o&&o.visible){var a={name:this.props.control.name,col:this._getColumnIndex(e[r])},i=n.cloneDeep_1(this.props.propertyId),s=a;i.name!==a.name&&(s=this.props.controller.setChildPropertyId(i,a)),t.push(this.controlFactory.createControlItem(o,s))}}return t}},{key:"_makeControls",value:function(){var e=[];if(Array.isArray(this.props.control.layout))for(var t=this.props.control.layout,r=0;r<t.length;r++)Array.isArray(t[r])&&e.push(this._makeRow(t[r]));else for(var o=0;o<this.props.control.subControls.length;o++)if(this.props.control.subControls[o].visible){var a={name:this.props.control.name,col:this._getColumnIndex(this.props.control.subControls[o].name)},i=n.cloneDeep_1(this.props.propertyId),s=a;i.name!==a.name&&(s=this.props.controller.setChildPropertyId(i,a)),e.push([this.controlFactory.createControlItem(this.props.control.subControls[o],s)])}return e}},{key:"_makeControlTable",value:function(e){for(var t=[],r=0;r<e.length;r++){for(var o=[],n=0;n<e[r].length;n++)o.push(O.default.createElement("td",{key:(1+r)*n,className:"properties-structureeditor-cell"},O.default.createElement("div",null,e[r][n])));t.push(O.default.createElement("tr",{key:1+r},o))}return O.default.createElement("table",{role:"presentation"},O.default.createElement("tbody",null,t))}},{key:"render",value:function(){var e=this._makeControlTable(this._makeControls());return O.default.createElement("div",{"data-id":ht(this.props.control,this.props.propertyId),className:u.classNames("properties-structureeditor ",{hide:this.props.state===u.STATES.HIDDEN},this.props.messageInfo?this.props.messageInfo.type:null)},e,O.default.createElement(fa,{state:this.props.state,messageInfo:this.props.messageInfo,inTable:!1}))}}]),a}(O.default.Component),Ts=c.connect((function(e,t){return{value:t.controller.getPropertyValue(t.propertyId),state:t.controller.getControlState(t.propertyId),messageInfo:t.controller.getErrorMessage(t.propertyId)}}),null)(Ss),Is=o._baseEach;var Cs=function(e,t){var r=[];return Is(e,(function(e,o,n){t(e,o,n)&&r.push(e)})),r};var Rs=function(e){if("function"!=typeof e)throw new TypeError("Expected a function");return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}},As=a._arrayFilter,ks=Cs,Os=s._baseIteratee,ws=a.isArray_1,Ns=Rs;var Ps=function(e,t){return(ws(e)?As:ks)(e,Ns(Os(t)))};function Ls(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Ds(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ds(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function Ds(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function Ms(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var xs=function(r){t._inherits(s,r);var i=Ms(s);function s(r){var n;return e._classCallCheck(this,s),(n=i.call(this,r)).reactIntl=r.controller.getReactIntl(),n.addColumns=n.addColumns.bind(t._assertThisInitialized(n)),n.removeColumns=n.removeColumns.bind(t._assertThisInitialized(n)),n.getDefaultRow=n.getDefaultRow.bind(t._assertThisInitialized(n)),n.indexOfRow=n.indexOfRow.bind(t._assertThisInitialized(n)),n.emptyTableButtonClickHandler=n.addOnClick.bind(t._assertThisInitialized(n),n.props.propertyId),n.emptyTableButtonLabel=o.formatMessage(n.reactIntl,u.MESSAGE_KEYS.STRUCTURETABLE_ADDBUTTON_LABEL),n}return e._createClass(s,[{key:"indexOfRow",value:function(e){var t=this.props.control.keyIndex;return Ba(this.props.controller.getPropertyValue(this.props.propertyId),(function(r){return r[t]===e}))}},{key:"addColumns",value:function(e,t){for(var r=[],o=this.props.control.valueDef.isMap,a=0;a<e.length;a++){var i=e[a];if(this.indexOfRow(i)<0){var s=n.cloneDeep_1(this.props.control.defaultRow);o?s.unshift(i):s[this.props.control.keyIndex]=i,r.push(s)}}var l=this.props.controller.getPropertyValue(this.props.propertyId).concat(r);this.setCurrentControlValueSelected(l)}},{key:"removeColumns",value:function(e,t){var r=this.props.controller.getPropertyValue(this.props.propertyId),o=this.props.control.keyIndex,n=Ps(r,(function(t){return e.indexOf(t[o])>=0}));this.setCurrentControlValueSelected(n)}},{key:"getDefaultRow",value:function(e){var t=[];if(this.props.value&&e)for(var r=o.getTableFieldIndex(this.props.control),n=0;n<this.props.value.length;n++){if(this.props.value[n][r]===e||this.props.value[n]===e)return this.props.value[n]}for(var a=0;a<this.props.control.subControls.length;a++){var i=this.props.control.subControls[a];if(i.role===o.ParamRole.COLUMN)t.push(e);else if(i.role===o.ParamRole.NEW_COLUMN)t.push(o.stringifyFieldValue(e,i).replace(".","_"));else if(void 0!==i.dmDefault)t.push(o.getDMDefault(i,e,this.props.controller.getDatasetMetadataFields()));else if(void 0!==this.props.control.defaultRow){var s=a;this.props.control.subControls.length!==this.props.control.defaultRow.length&&(s-=1);var l=this.props.control.defaultRow[s];this.props.control.subControls[s].valueDef.propType===o.Type.STRUCTURE?t.push([]):l&&l.parameterRef?t.push(this.props.controller.getPropertyValue({name:l.parameterRef})):t.push(l)}else i.valueDef&&i.valueDef.defaultValue?i.valueDef.defaultValue.parameterRef?t.push(this.props.controller.getPropertyValue({name:i.valueDef.defaultValue.parameterRef})):t.push(i.valueDef.defaultValue):t.push(null)}return t}},{key:"onFieldPickerClose",value:function(e,t){if(e&&t){var r,o=[],n=Ls(e);try{for(n.s();!(r=n.n()).done;){var a=r.value;o.push(this.getDefaultRow(a))}}catch(e){n.e(e)}finally{n.f()}this.setCurrentControlValueSelected(o,t);var i=t[t.length-1];this.setScrollToRow(i)}}},{key:"render",value:function(){var e={fieldPickerCloseFunction:this.onFieldPickerClose},t=this.props.control&&this.props.control.buttons,r=this.createTable(this.props.state,e,t),o=O.default.createElement("div",null,O.default.createElement("div",{className:"properties-st properties-st-buttons"},r),O.default.createElement(fa,{state:this.props.state,messageInfo:this.props.messageInfo})),n=this.getOnPanelContainer(this.props.selectedRows);return O.default.createElement("div",{"data-id":ht(this.props.control,this.props.propertyId),className:"properties-column-structure-wrapper"},O.default.createElement("div",{className:"properties-column-structure"},O.default.createElement(Za,{tableContainer:o,control:this.props.control,controller:this.props.controller,propertyId:this.props.propertyId,setScrollToRow:this.setScrollToRow,setCurrentControlValueSelected:this.setCurrentControlValueSelected,disabled:this.props.state===u.STATES.DISABLED,isEmptyTable:a.isEmpty_1(this.props.value),emptyTableButtonLabel:this.emptyTableButtonLabel,emptyTableButtonClickHandler:this.emptyTableButtonClickHandler})),O.default.createElement("div",null,n))}}]),s}(Ya);xs.propTypes={buildUIItem:L.default.func,control:L.default.object.isRequired,propertyId:L.default.object.isRequired,controller:L.default.object.isRequired,openFieldPicker:L.default.func.isRequired,rightFlyout:L.default.bool,selectedRows:L.default.array,state:L.default.string,value:L.default.array,messageInfo:L.default.object,addRemoveRows:L.default.bool,tableButtons:L.default.object};var Bs=c.connect((function(e,t){return{value:t.controller.getPropertyValue(t.propertyId),state:t.controller.getControlState(t.propertyId),messageInfo:t.controller.getErrorMessage(t.propertyId),selectedRows:t.controller.getSelectedRows(t.propertyId),addRemoveRows:t.controller.getAddRemoveRows(t.propertyId),tableButtons:t.controller.getTableButtons(t.propertyId)}}),null)(xs);function Fs(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var Vs=function(r){t._inherits(i,r);var n=Fs(i);function i(r){var o;return e._classCallCheck(this,i),(o=n.call(this,r)).addRow=o.addRow.bind(t._assertThisInitialized(o)),o.allowColumnControls=!0,o}return e._createClass(i,[{key:"addRow",value:function(){var e=this.getDefaultRow(),t=this.props.controller.getPropertyValue(this.props.propertyId).concat([e]);this.setCurrentControlValueSelected(t)}},{key:"render",value:function(){var e={addButtonLabel:o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.STRUCTURELISTEDITOR_ADDBUTTON_LABEL),removeButtonLabel:o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.STRUCTURELISTEDITOR_REMOVEBUTTON_LABEL),addButtonFunction:this.addRow},t=this.props.control&&this.props.control.buttons,r=this.createTable(this.props.state,e,t),n=O.default.createElement("div",null,O.default.createElement("div",{className:"properties-sle properties-sle-buttons"},r),O.default.createElement(fa,{state:this.props.state,messageInfo:this.props.messageInfo})),i=this.getOnPanelContainer(this.props.selectedRows);return O.default.createElement("div",{"data-id":ht(this.props.control,this.props.propertyId),className:"properties-sle-wrapper"},O.default.createElement("div",{"data-id":ht(this.props.control,this.props.propertyId),className:"properties-sle-container"},O.default.createElement(Za,{tableContainer:n,control:this.props.control,controller:this.props.controller,propertyId:this.props.propertyId,setScrollToRow:this.setScrollToRow,setCurrentControlValueSelected:this.setCurrentControlValueSelected,disabled:this.props.state===u.STATES.DISABLED,isEmptyTable:a.isEmpty_1(this.props.value),emptyTableButtonLabel:e.addButtonLabel,emptyTableButtonClickHandler:this.addRow})),O.default.createElement("div",null,i))}}]),i}(Ya);Vs.propTypes={buildUIItem:L.default.func,control:L.default.object.isRequired,propertyId:L.default.object.isRequired,controller:L.default.object.isRequired,rightFlyout:L.default.bool,selectedRows:L.default.array,state:L.default.string,value:L.default.array,messageInfo:L.default.object,addRemoveRows:L.default.bool,tableButtons:L.default.object};var Us=c.connect((function(e,t){return{value:t.controller.getPropertyValue(t.propertyId),state:t.controller.getControlState(t.propertyId),messageInfo:t.controller.getErrorMessage(t.propertyId),selectedRows:t.controller.getSelectedRows(t.propertyId),addRemoveRows:t.controller.getAddRemoveRows(t.propertyId),tableButtons:t.controller.getTableButtons(t.propertyId)}}),null)(Vs);function zs(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var Hs=function(r){t._inherits(i,r);var n=zs(i);function i(r){var o;return e._classCallCheck(this,i),(o=n.call(this,r)).reactIntl=r.controller.getReactIntl(),o.editCallback=o.editCallback.bind(t._assertThisInitialized(o)),o.buttonHandler=o.props.controller.getHandlers().buttonHandler,o}return e._createClass(i,[{key:"editCallback",value:function(){this.buttonHandler&&this.buttonHandler({type:"edit",propertyId:this.props.propertyId})}},{key:"render",value:function(){var e="".concat(this.props.control.name,".edit.button.label"),t=o.formatMessage(this.reactIntl,u.MESSAGE_KEYS.READONLYTABLE_EDIT_BUTTON_LABEL),r=this.props.controller.getResource(e,t),n=this.buttonHandler?{editCallback:this.editCallback,label:r}:null,i=this.props.control&&this.props.control.buttons,s=this.createTable(this.props.state,n,i),l=O.default.createElement("div",null,O.default.createElement("div",{className:"properties-rt properties-rt-buttons"},s),O.default.createElement(fa,{state:this.props.state,messageInfo:this.props.messageInfo}));return O.default.createElement("div",{"data-id":ht(this.props.control,this.props.propertyId),className:"properties-readonly-table-wrapper"},this.props.controlItem,O.default.createElement("div",{className:"properties-readonly-table"},O.default.createElement(Za,{tableContainer:l,control:this.props.control,controller:this.props.controller,propertyId:this.props.propertyId,setScrollToRow:this.setScrollToRow,setCurrentControlValueSelected:this.setCurrentControlValueSelected,disabled:this.props.state===u.STATES.DISABLED,isEmptyTable:a.isEmpty_1(this.props.value),emptyTableButtonLabel:r,emptyTableButtonClickHandler:this.editCallback})))}}]),i}(Ya);Hs.propTypes={buildUIItem:L.default.func,control:L.default.object.isRequired,propertyId:L.default.object.isRequired,controller:L.default.object.isRequired,controlItem:L.default.element,rightFlyout:L.default.bool,selectedRows:L.default.array,state:L.default.string,value:L.default.array,messageInfo:L.default.object,addRemoveRows:L.default.bool,tableButtons:L.default.object,hideEditButton:L.default.bool};var js=c.connect((function(e,t){return{value:t.controller.getPropertyValue(t.propertyId),state:t.controller.getControlState(t.propertyId),messageInfo:t.controller.getErrorMessage(t.propertyId),selectedRows:t.controller.getSelectedRows(t.propertyId),addRemoveRows:t.controller.getAddRemoveRows(t.propertyId),tableButtons:t.controller.getTableButtons(t.propertyId),hideEditButton:t.controller.getHideEditButton(t.propertyId)}}),null)(Hs);function Gs(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var qs=function(r){t._inherits(i,r);var n=Gs(i);function i(t){var r;return e._classCallCheck(this,i),(r=n.call(this,t)).actionFactory=new Qt(r.props.controller),r.uuid=m.v4(),r}return e._createClass(i,[{key:"render",value:function(){if(this.props.control.controlType===o.ControlType.HIDDEN)return null;var e,t,r,n,i=this.props.state===u.STATES.HIDDEN,s=this.props.state===u.STATES.DISABLED;this.props.control.label&&!1!==this.props.control.labelVisible&&(this.props.control.description&&!a.isEmpty_1(this.props.control.description.text)&&("on_panel"===this.props.control.description.placement?t=O.default.createElement("div",{className:"properties-control-description"},this.props.control.description.text):(this.props.control.description.link&&(this.props.control.description.link.propertyId=this.props.propertyId),r=O.default.createElement(y,{id:"".concat(this.uuid,"-tooltip-label-").concat(this.props.control.name),tip:this.props.control.description.text,link:this.props.control.description.link?this.props.control.description.link:null,tooltipLinkHandler:this.props.controller.getHandlers().tooltipLinkHandler,direction:"bottom",disable:i||s,showToolTipOnClick:!0},O.default.createElement(h.Icon,{type:u.CARBON_ICONS.INFORMATION,className:"properties-control-description-icon-info"})))),this.props.control.showRequiredLabel&&this.props.control.required?n=O.default.createElement("span",{className:"properties-indicator"},o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.LABEL_INDICATOR_REQUIRED)):this.props.control.showRequiredLabel||"required"in this.props.control||(n=O.default.createElement("span",{className:"properties-indicator"},o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.LABEL_INDICATOR_OPTIONAL))),e=O.default.createElement("div",{className:u.classNames("properties-label-container",{"table-control":!0===this.props.tableControl})},O.default.createElement("label",{className:"properties-control-label"},this.props.control.label.text),n,r));var l=this.actionFactory.generateAction(0,this.props.control.action),p=u.classNames("properties-control-item",{hide:i});return this.props.accessibleControls.includes(this.props.control.controlType)?O.default.createElement("div",{"data-id":"properties-ci-"+this.props.control.name,className:p,disabled:s},e,t):O.default.createElement("div",{"data-id":"properties-ci-"+this.props.control.name,className:p,disabled:s},e,t,this.props.controlObj,l)}}]),i}(O.default.Component),Ys=c.connect((function(e,t){return{state:t.controller.getControlState(t.propertyId)}}),null)(qs),Ks=[o.ControlType.CHECKBOXSET,o.ControlType.HIDDEN,o.ControlType.DATEFIELD,o.ControlType.NUMBERFIELD,o.ControlType.SPINNER,o.ControlType.PASSWORDFIELD,o.ControlType.TEXTAREA,o.ControlType.TEXTFIELD,o.ControlType.TIMEFIELD,o.ControlType.TOGGLETEXT,o.ControlType.LIST,o.ControlType.TOGGLE,o.ControlType.SOMEOFSELECT,o.ControlType.SELECTCOLUMNS,o.ControlType.READONLY,o.ControlType.READONLYTABLE,o.ControlType.TIMESTAMP,o.ControlType.EXPRESSION,o.ControlType.CODE,o.ControlType.ONEOFSELECT,o.ControlType.MULTISELECT,o.ControlType.SELECTSCHEMA,o.ControlType.SELECTCOLUMN],Ws=[o.ControlType.LIST,o.ControlType.READONLYTABLE,o.ControlType.SOMEOFSELECT,o.ControlType.SELECTCOLUMNS,o.ControlType.STRUCTURETABLE,o.ControlType.STRUCTURELISTEDITOR],Xs=function(){function t(r){e._classCallCheck(this,t),this.rightFlyout=!!r&&a.get_1(r.getPropertiesConfig(),"rightFlyout",!1),this.controller=r,this.actionFactory=new Qt(this.controller)}return e._createClass(t,[{key:"setFunctions",value:function(e,t){this.genUIItem=t,this.openFieldPicker=e}},{key:"setRightFlyout",value:function(e){this.rightFlyout=e}},{key:"createControlItem",value:function(e,t,r){if(this.controller.getControlState(t)===u.STATES.HIDDEN)return null;var o=this.createControl(e,t,r),n=e.className?e.className:"";return Ks.includes(e.controlType)?o:O.default.createElement("div",{key:"properties-ctrl-"+e.name,"data-id":"properties-ctrl-"+e.name,className:u.classNames("properties-ctrl-wrapper",n)},O.default.createElement(Ys,{key:"ctrl-item-"+e.name,controller:this.controller,propertyId:t,control:e,controlObj:o,accessibleControls:Ks,tableControl:Ws.includes(e.controlType)}))}},{key:"createControl",value:function(e,t,r){if(!e||!t)return null;var n,i=ht(t),s=this.controller.getControlState(t)===u.STATES.HIDDEN,l=this.actionFactory.generateAction(0,e.action),p={};switch(p.key=i,p.control=e,p.controller=this.controller,p.propertyId=t,p.controlItem=O.default.createElement(Ys,{key:"ctrl-item-"+e.name,controller:this.controller,propertyId:t,control:e,accessibleControls:Ks,tableControl:Ws.includes(e.controlType)}),r&&(p.tableControl=r.table),e.controlType){case o.ControlType.HIDDEN:return null;case o.ControlType.TEXTFIELD:n=O.default.createElement(ba,p);break;case o.ControlType.READONLY:case o.ControlType.TIMESTAMP:n=O.default.createElement(ya,p);break;case o.ControlType.TEXTAREA:n=O.default.createElement(Ca,p);break;case o.ControlType.TOGGLE:n=O.default.createElement(Zi,p);break;case o.ControlType.LIST:n=O.default.createElement(ri,p);break;case o.ControlType.EXPRESSION:n=O.default.createElement(Bi,u._extends({},p,{rightFlyout:this.rightFlyout}));break;case o.ControlType.CODE:n=O.default.createElement(Bi,u._extends({},p,{builder:!1,validateLink:!1,rightFlyout:this.rightFlyout}));break;case o.ControlType.TOGGLETEXT:n=O.default.createElement(Sa,p);break;case o.ControlType.PASSWORDFIELD:n=O.default.createElement(Ui,p);break;case o.ControlType.NUMBERFIELD:case o.ControlType.SPINNER:n=O.default.createElement(ka,p);break;case o.ControlType.DATEFIELD:n=O.default.createElement(ji,p);break;case o.ControlType.TIMEFIELD:n=O.default.createElement(Yi,p);break;case o.ControlType.CHECKBOX:n=O.default.createElement(Xi,p);break;case o.ControlType.CHECKBOXSET:n=r?O.default.createElement(ya,p):O.default.createElement(ts,p);break;case o.ControlType.RADIOSET:n=O.default.createElement(is,p);break;case o.ControlType.ONEOFSELECT:case o.ControlType.SELECTSCHEMA:n=O.default.createElement(cs,u._extends({},p,{rightFlyout:this.rightFlyout}));break;case o.ControlType.MULTISELECT:n=O.default.createElement(hs,p);break;case o.ControlType.SELECTCOLUMN:n=!r||r&&r.allowColumnControls?O.default.createElement(cs,u._extends({},p,{rightFlyout:this.rightFlyout})):O.default.createElement(ya,p);break;case o.ControlType.SOMEOFSELECT:n=r?O.default.createElement(ya,p):O.default.createElement(vs,p);break;case o.ControlType.SELECTCOLUMNS:n=r?O.default.createElement(ya,p):O.default.createElement(Es,u._extends({},p,{openFieldPicker:this.openFieldPicker,rightFlyout:this.rightFlyout}));break;case o.ControlType.STRUCTURETABLE:n=r?O.default.createElement(ya,p):O.default.createElement(Bs,u._extends({},p,{buildUIItem:this.genUIItem,openFieldPicker:this.openFieldPicker,rightFlyout:this.rightFlyout}));break;case o.ControlType.STRUCTURELISTEDITOR:n=r?O.default.createElement(ya,p):O.default.createElement(Us,u._extends({},p,{buildUIItem:this.genUIItem,rightFlyout:this.rightFlyout}));break;case o.ControlType.READONLYTABLE:n=r?O.default.createElement(ya,p):O.default.createElement(js,u._extends({},p,{buildUIItem:this.genUIItem,rightFlyout:this.rightFlyout}));break;case o.ControlType.CUSTOM:n=O.default.createElement("div",{className:"properties-custom-ctrl",key:i},this.controller.getCustomControl(t,e,r));break;case o.ControlType.STRUCTUREEDITOR:n=O.default.createElement(Ts,u._extends({},p,{buildUIItem:this.genUIItem,openFieldPicker:this.openFieldPicker,rightFlyout:this.rightFlyout}));break;default:n=O.default.createElement(ya,p)}if(Ks.includes(e.controlType)){if(r)return n;var c=e.className?e.className:"";return O.default.createElement("div",{key:"properties-ctrl-"+e.name,"data-id":"properties-ctrl-"+e.name,className:u.classNames("properties-ctrl-wrapper",{hide:s,action:a.has_1(e,"action.image.placement")},c)},n,l)}return n}},{key:"createFormControl",value:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:u.CONTAINER_TYPE.CUSTOM;if(!e)return null;var a=Dr.makePropertyDef(null,e.parameters,e.complex_types,e.uihints);if(a&&a.parameterMetadata){var i,s=new lr(e.resources),l=a.parameterMetadata.getParameter(t);l.propType()===o.Type.STRUCTURE&&a.structureMetadata&&(i=a.structureMetadata.getStructure(l.baseType()));var p={light:r,containerType:n};return Zr(a.parameterMetadata,t,null,i,s,null,null,null,p)}return null}}]),t}();function $s(e,t,r,n){if(["structuretable","structureeditor","structurelisteditor"].indexOf(e.control.controlType)>=0){var a=o.toType(e.value);return"undefined"!==a&&"null"!==a&&String(e.value).length>0}return o.logger.warn("Ignoring unsupported condition operation 'cellNotEmpty' for control type "+e.control.controlType),!0}function Js(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Zs(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Zs(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function Zs(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function Qs(e,t,r,n){if(["textfield"].indexOf(e.control.controlType)>=0){var a=n.getDatasetMetadataFields();if(!a)return!0;var i,s=!0,l=Js(a);try{for(l.s();!(i=l.n()).done;){var u=i.value;if(o.fieldValueMatchesProto(e.value,u)){s=!1;break}}}catch(e){l.e(e)}finally{l.f()}if(!s){var p,c=function(e,t){var r=[];if(void 0!==e.control.columnIndex){var n=t.getPropertyValue({name:e.id.name,row:e.id.row});Array.isArray(n)&&n.forEach((function(n,a){a!==e.control.columnIndex&&(t.getControl({name:e.id.name,col:a}).role===o.ParamRole.COLUMN&&r.push(n))}))}return r}(e,n),d=Js(c);try{for(d.s();!(p=d.n()).done;){var f=p.value;if(o.isEqual_1(e.value,f)){s=!0;break}}}catch(e){d.e(e)}finally{d.f()}}return s}return o.logger.warn("Ignoring unsupported condition operation 'colNotExists' for control type "+e.control.controlType),!0}function el(e,t,r,n){var a=n.getDatasetMetadataFields();if(!a)return!1;var i=e.control.controlType;switch(i){case"selectcolumns":case"selectcolumn":if(Array.isArray(e.value)&&void 0!==e.control.editStyle){if(e.value.length>0){var s=!0;return e.value.forEach((function(e){s=s&&void 0!==tl(a,e)})),s}return!0}return void 0!==tl(a,e.value);default:return o.logger.warn("Ignoring unsupported condition operation 'colDoesExists' for control type "+i),!0}}function tl(e,t){return!(null!=t&&!a.isEmpty_1(t))||e.find((function(e){return o.fieldValueMatchesProto(t,e)}))}var rl=a._arrayMap;var ol=function(e,t){return rl(t,(function(t){return e[t]}))},nl=a.keys_1;var al=function(e){return null==e?[]:ol(e,nl(e))},il=a._baseIndexOf,sl=a.isArrayLike_1,ll=o.isString_1,ul=Pa,pl=al,cl=Math.max;var dl=function(e,t,r,o){e=sl(e)?e:pl(e),r=r&&!o?ul(r):0;var n=e.length;return r<0&&(r=cl(n+r,0)),ll(e)?r<=n&&e.indexOf(t,r)>-1:!!n&&il(e,t,r)>-1};function fl(t,r,n,a){if(["checkbox","numberfield","passwordfield"].indexOf(t.control.controlType)<0){var i=e._typeof(t.value);if(void 0!==r)switch(i){case"undefined":return!1;case"string":case"object":return dl(t.value,r.value);default:return o.logger.warn("Ignoring condition operation 'contains' for parameter_ref "+t.param+" with input data type "+i),!0}else if(void 0!==n)switch(i){case"undefined":return!1;case"string":case"object":return dl(t.value,n);default:return o.logger.warn("Ignoring condition operation 'contains' for parameter_ref "+t.param+" with input data type "+i),!0}throw new Error("Insufficient parameter for condition operation contains")}return o.logger.warn("Ignoring unsupported condition operation 'contains' for control type "+t.control.controlType),!0}function hl(t,r,n,a){if("passwordfield"!==t.control.controlType){var i=e._typeof(t.value);if(r){if(null===t.value||null===r.value)return t.value===r.value;switch(i){case"undefined":case"boolean":case"number":return t.value===r.value;case"string":return t.value.trim()===r.value.trim();case"object":return JSON.stringify(t.value)===JSON.stringify(r.value);default:return o.logger.warn("Ignoring condition operation 'equals' for parameter_ref "+t.param+" with input data type "+i),!0}}else if(void 0!==n){if(null===t.value||null===n)return t.value===n;switch(i){case"undefined":case"boolean":case"number":return t.value===n;case"string":return t.value.trim()===n.toString().trim();case"object":return JSON.stringify(t.value)===JSON.stringify(n);default:return o.logger.warn("Ignoring condition operation 'equals' for parameter_ref "+t.param+" with input data type "+i),!0}}throw new Error("Insufficient parameter for condition operation equals")}return o.logger.warn("Ignoring unsupported condition operation 'equals' for control type "+t.control.controlType),!0}function ml(t,r,n,a){var i=e._typeof(t.value);switch(i){case"undefined":case"number":if(void 0!==r)return"number"==typeof r.value&&t.value>r.value;if(void 0!==n)return null===n||t.value>n;throw new Error("Insufficient parameter for condition operation 'greaterThan'");case"object":return null===t.value||null===r.value||null===n;default:return o.logger.warn("Ignoring condition operation 'greaterThan' for parameter_ref "+t.param+" with input data type "+i),!0}}function yl(t,r,n,a){var i=a.getPropertiesConfig(),s=e._typeof(t.value);switch(s){case"undefined":return!0;case"boolean":return!1;case"string":return i.trimSpaces?0===t.value.trim().length:0===t.value.length;case"number":return null===t.value;case"object":return null===t.value||0===t.value.length;default:return o.logger.warn("Ignoring condition operation 'isEmpty' for parameter_ref "+t.param+" with input data type "+s),!0}}function vl(t,r,n,a){var i=a.getPropertiesConfig(),s=e._typeof(t.value);switch(s){case"undefined":return!1;case"boolean":return!0;case"string":return i.trimSpaces?0!==t.value.trim().length:0!==t.value.length;case"number":return null!==t.value;case"object":return null!==t.value&&0!==t.value.length;default:return o.logger.warn("Ignoring condition operation 'isNotEmpty' for parameter_ref "+t.param+" with input data type "+s),!0}}function gl(t,r,n,a){var i=e._typeof(t.value);switch(i){case"undefined":case"number":if(void 0!==r)return"number"==typeof r.value&&t.value<r.value;if(void 0!==n)return null===n||t.value<n;throw new Error("Insufficient parameter for condition operation 'lessThan'");case"object":return null===t.value||null===r.value||null===n;default:return o.logger.warn("Ignoring condition operation 'lessThan' for parameter_ref "+t.param+" with input data type "+i),!0}}function bl(t,r,n,a){var i=e._typeof(t.value),s="";if(null!=r)s=r.value;else{if(null==n)return o.logger.warn("Ignoring condition operation 'matches' for parameter_ref "+t.param+" no regular expression specified in condition."),!0;s=n}return"string"===i||"undefined"===i?new RegExp(s).test(t.value):(o.logger.warn("Ignoring condition operation 'matches' for parameter_ref "+t.param+" with input data type "+i),!0)}function El(t,r,n,a){if(["checkbox","numberfield","passwordfield"].indexOf(t.control.controlType)<0){var i=e._typeof(t.value);if(void 0!==r)switch(i){case"undefined":return!0;case"string":case"object":return!dl(t.value,r.value);default:return o.logger.warn("Ignoring condition operation 'notContains' for parameter_ref "+t.param+" with input data type "+i),!0}else if(void 0!==n)switch(i){case"undefined":return!0;case"string":case"object":return!dl(t.value,n);default:return o.logger.warn("Ignoring condition operation 'notContains' for parameter_ref "+t.param+" with input data type "+i),!0}throw new Error("Insufficient parameter for condition operation notContains")}return o.logger.warn("Ignoring unsupported condition operation 'notContains' for control type "+t.control.controlType),!0}function _l(t,r,n,a){if("passwordfield"!==t.control.controlType){var i=e._typeof(t.value);if(r){if(null===t.value||null===r.value)return t.value!==r.value;switch(i){case"undefined":case"boolean":case"number":return t.value!==r.value;case"string":return t.value.trim()!==r.value.trim();case"object":return JSON.stringify(t.value)!==JSON.stringify(r.value);default:return o.logger.warn("Ignoring condition operation 'notEquals' for parameter_ref "+t.param+" with input data type "+i),!0}}else if(void 0!==n){if(null===t.value||null===n)return t.value!==n;switch(i){case"undefined":case"boolean":case"number":return t.value!==n;case"string":return t.value.trim()!==n.trim();case"object":return JSON.stringify(t.value)!==JSON.stringify(n);default:return o.logger.warn("Ignoring condition operation 'notEquals' for parameter_ref "+t.param+" with input data type "+i),!0}}throw new Error("Insufficient parameter for condition operation notEquals")}return o.logger.warn("Ignoring unsupported condition operation 'notEquals' for control type "+t.control.controlType),!0}function Sl(t,r,n,a){var i=e._typeof(t.value),s="";if(null!=r)s=r.value;else{if(null==n)return o.logger.warn("Ignoring condition operation 'notMatches' for parameter_ref "+t.param+" no regular expression specified in condition."),!0;s=n}return"string"===i||"undefined"===i?!new RegExp(s).test(t.value):(o.logger.warn("Ignoring condition operation 'notMatches' for parameter_ref "+t.param+" with input data type "+i),!0)}function Tl(e,t,r,o){if(e.value){var n="time"===r?"HH:mm:ss:xxx":u.DEFAULT_DATE_FORMAT,a=S.parse(e.value,n,new Date);return S.isValid(a)}return!0}function Il(t,r,n,a){"column"!==t.control.role&&o.logger.warn("Condition Operator dmTypeEquals only intended for use on columns");var i=a.getDatasetMetadataFields(),s=null;if(null!=r&&null!==r.value)"column"===r.control.role&&(s=aa(r,i,"type")),null===s&&(s=r.value);else{if(null==n)return!1;s=n}return!!i&&("string"==typeof t.value||"object"===e._typeof(t.value)?aa(t,i,"type")===s:(void 0!==t.value&&o.logger.warn("dmTypeEquals cannot handle the given type: "+e._typeof(t.value)),!1))}function Cl(t,r,n,a){"column"!==t.control.role&&o.logger.warn("Condition Operator dmTypeNotEquals only intended for use on columns");var i=a.getDatasetMetadataFields(),s=null;if(null!=r&&null!==r.value)"column"===r.control.role&&(s=aa(r,i,"type")),null===s&&(s=r.value);else{if(null==n)return!1;s=n}return!!i&&("string"==typeof t.value||"object"===e._typeof(t.value)?aa(t,i,"type")!==s:(void 0!==t.value&&o.logger.warn("dmTypeNotEquals cannot handle the given type: "+e._typeof(t.value)),!1))}function Rl(t,r,n,a){"column"!==t.control.role&&o.logger.warn("Condition Operator dmMeasurementEquals only intended for use on columns");var i=a.getDatasetMetadataFields(),s=null;if(null!=r&&null!==r.value)"column"===r.control.role&&(s=aa(r,i,"measure")),null===s&&(s=r.value);else{if(null==n)return!1;s=n}return!!i&&("string"==typeof t.value||"object"===e._typeof(t.value)?aa(t,i,"measure")===s:(void 0!==t.value&&o.logger.warn("dmMeasurementEquals cannot handle the given type: "+e._typeof(t.value)),!1))}function Al(t,r,n,a){"column"!==t.control.role&&o.logger.warn("Condition Operator dmMeasurementNotEquals only intended for use on columns");var i=a.getDatasetMetadataFields(),s=null;if(null!=r&&null!==r.value)"column"===r.control.role&&(s=aa(r,i,"measure")),null===s&&(s=r.value);else{if(null==n)return!1;s=n}return!!i&&("string"==typeof t.value||"object"===e._typeof(t.value)?aa(t,i,"measure")!==s:(void 0!==t.value&&o.logger.warn("dmMeasurementNotEquals cannot handle the given type: "+e._typeof(t.value)),!1))}function kl(t,r,n,a){"column"!==t.control.role&&o.logger.warn("Condition Operator dmRoleEquals only intended for use on columns");var i=a.getDatasetMetadataFields(),s=null;if(null!=r&&null!==r.value)"column"===r.control.role&&(s=aa(r,i,"modeling_role")),null===s&&(s=r.value);else{if(null==n)return!1;s=n}return!!i&&("string"==typeof t.value||"object"===e._typeof(t.value)?aa(t,i,"modeling_role")===s:(void 0!==t.value&&o.logger.warn("dmRoleEquals cannot handle the given type: "+e._typeof(t.value)),!1))}function Ol(t,r,n,a){"column"!==t.control.role&&o.logger.warn("Condition Operator dmRoleEquals only intended for use on columns");var i=a.getDatasetMetadataFields(),s=null;if(null!=r&&null!==r.value)"column"===r.control.role&&(s=aa(r,i,"modeling_role")),null===s&&(s=r.value);else{if(null==n)return!1;s=n}return!!i&&("string"==typeof t.value||"object"===e._typeof(t.value)?aa(t,i,"modeling_role")!==s:(void 0!==t.value&&o.logger.warn("dmRoleEquals cannot handle the given type: "+e._typeof(t.value)),!1))}function wl(e,t,r,n){var a,i=r;return t&&(i=t.value),"string"==typeof e.value||Array.isArray(e.value)?a=e.value.length:void 0!==e.value&&null!==e.value||(a=0),"number"==typeof i&&"number"==typeof a?a===i:(o.logger.warn("Ignoring condition operation 'lengthEquals' for parameter_ref "+e.param),!0)}function Nl(e,t,r,n){var a,i=r;return t&&(i=t.value),"string"==typeof e.value||Array.isArray(e.value)?a=e.value.length:void 0!==e.value&&null!==e.value||(a=0),"number"==typeof i&&"number"==typeof a?a<i:(o.logger.warn("Ignoring condition operation 'lengthLessThan' for parameter_ref "+e.param),!0)}function Pl(e,t,r,n){var a,i=r;return t&&(i=t.value),"string"==typeof e.value||Array.isArray(e.value)?a=e.value.length:void 0!==e.value&&null!==e.value||(a=0),"number"==typeof i&&"number"==typeof a?a>i:(o.logger.warn("Ignoring condition operation 'lengthGreaterThan' for parameter_ref "+e.param),!0)}function Ll(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Dl(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Dl(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function Dl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function Ml(e){var t={};if(t.cellNotEmpty=$s,t.colNotExists=Qs,t.colDoesExists=el,t.contains=fl,t.equals=hl,t.greaterThan=ml,t.isEmpty=yl,t.isNotEmpty=vl,t.lessThan=gl,t.matches=bl,t.notContains=El,t.notEquals=_l,t.notMatches=Sl,t.isDateTime=Tl,t.dmTypeEquals=Il,t.dmTypeNotEquals=Cl,t.dmMeasurementEquals=Rl,t.dmMeasurementNotEquals=Al,t.dmRoleEquals=kl,t.dmRoleNotEquals=Ol,t.lengthEquals=wl,t.lengthLessThan=Nl,t.lengthGreaterThan=Pl,Array.isArray(e)){var r,n=Ll(e);try{for(n.s();!(r=n.n()).done;){var a=r.value;a&&"function"==typeof a.op&&"function"==typeof a.evaluate?t[a.op()]=a.evaluate:o.logger.warn("Custom operator missing require function of `op` or `evaluate`")}}catch(e){n.e(e)}finally{n.f()}}return t}function xl(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return Bl(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Bl(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,n=function(){};return{s:n,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return i=e.done,e},e:function(e){s=!0,a=e},f:function(){try{i||null==r.return||r.return()}finally{if(s)throw a}}}}function Bl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}var Fl=function(){function t(){e._classCallCheck(this,t),this.propertiesStore=new Vo,this.handlers={propertyListener:null,controllerHandler:null,actionHandler:null,buttonHandler:null,buttonIconHandler:null,titleChangeHandler:null,tooltipLinkHandler:null},this.propertiesConfig={},this.visibleDefinitions={},this.enabledDefinitions={},this.validationDefinitions={},this.requiredDefinitionsIds=[],this.filterDefinitions={},this.filteredEnumDefinitions={},this.allowChangeDefinitions={},this.conditionalDefaultDefinitions={},this.panelTree={},this.controls={},this.actions={},this.customControls=[],this.summaryPanelControls={},this.controllerHandlerCalled=!1,this.commandStack=new E,this.custPropSumPanelValues={},this.controlFactory=new Xs(this),this.sharedCtrlInfo=[],this.isSummaryPanel=!1,this.visibleSubPanelCounter=0,this.conditionOps=Ml(),this.expressionFunctionInfo={},this.expressionRecentlyUsed=[],this.expressionFieldsRecentlyUsed=[],this.selectionListeners={}}return e._createClass(t,[{key:"getStore",value:function(){return this.propertiesStore.getStore()}},{key:"subscribe",value:function(e){this.propertiesStore.subscribe(e)}},{key:"getHandlers",value:function(){return this.handlers}},{key:"setHandlers",value:function(e){this.handlers=Object.assign(this.handlers,e),this.handlers.controllerHandler&&!this.controllerHandlerCalled&&(this.handlers.controllerHandler(this),this.controllerHandlerCalled=!0)}},{key:"setCommandStack",value:function(e){this.commandStack=e}},{key:"getCommandStack",value:function(){return this.commandStack}},{key:"setEditorSize",value:function(e){this.editorSize=e}},{key:"getEditorSize",value:function(){return this.editorSize}},{key:"setLight",value:function(e){this.light=e}},{key:"getLight",value:function(){return this.light}},{key:"setPropertiesConfig",value:function(e){this.propertiesConfig=e}},{key:"getPropertiesConfig",value:function(){return this.propertiesConfig}},{key:"isTearsheetContainer",value:function(){return"Tearsheet"===this.propertiesConfig.containerType}},{key:"setParamDef",value:function(e){var t=a.get_1(this.getPropertiesConfig(),"containerType"),r=a.get_1(this.getPropertiesConfig(),"convertTypes"),o=so.makeForm(e,t,r);this.setForm(o)}},{key:"setForm",value:function(e,t){if(this.form=e,this.reactIntl=t,this.form){this.controls={},this.setControlStates({}),this.setErrorMessages({}),this.isSummaryPanel=!1,this.visibleSubPanelCounter=0,this._parseUiConditions();var r,n=[];!function(e,t,r){if(r.uiItems){var o,n=zo(r.uiItems);try{for(n.s();!(o=n.n()).done;)qo(e,t,o.value)}catch(e){n.e(e)}finally{n.f()}}}(n,this.actions,this.form),this.saveControls(n),this._parseSummaryControls(n),this.parsePanelTree(),zn(this.controls,this.validationDefinitions,this.requiredDefinitionsIds,t);var i={};if(this.form.data&&(r=this.form.data.datasetMetadata,i=this.form.data.uiCurrentParameters?So({},this.form.data.currentParameters,this.form.data.uiCurrentParameters):this.form.data.currentParameters),this.setDatasetMetadata(r),this.setPropertyValues(i,!0),this._addToControlValues(),this._addToControlValues(!0),this.setInitialAddRemoveRows(),this.setInitialTableButtonState(),this.uiItems=this.form.uiItems,!a.isEmpty_1(this.uiItems)&&!a.isEmpty_1(this.uiItems[0].tabs)){var s=this.uiItems[0].tabs.filter((function(e){return e.content.itemType!==o.ItemType.TEARSHEET}));s.length&&this.propertiesStore.setActiveTab(s[0].group)}this.setTitle(this.form.label)}}},{key:"getForm",value:function(){return this.form}},{key:"getResource",value:function(e,t){return this.form&&this.form.resources&&this.form.resources[e]?this.form.resources[e]:t}},{key:"setAppData",value:function(e){this.appData=e}},{key:"getAppData",value:function(){return this.appData}},{key:"_parseUiConditions",value:function(){if(this.visibleDefinitions={controls:{},refs:{}},this.enabledDefinitions={controls:{},refs:{}},this.validationDefinitions={controls:{},refs:{}},this.filterDefinitions={controls:{},refs:{}},this.filteredEnumDefinitions={controls:{},refs:{}},this.allowChangeDefinitions={controls:{},refs:{}},this.conditionalDefaultDefinitions={controls:{},refs:{}},this.form.conditions){var e,t=xl(this.form.conditions);try{for(t.s();!(e=t.n()).done;){var r=e.value;r.visible?Yo(this.visibleDefinitions,r,u.CONDITION_TYPE.VISIBLE):r.enabled?Yo(this.enabledDefinitions,r,u.CONDITION_TYPE.ENABLED):r.validation?Yo(this.validationDefinitions,r,u.CONDITION_TYPE.VALIDATION):r.filter?Yo(this.filterDefinitions,r,u.CONDITION_TYPE.FILTER):r.enum_filter?Yo(this.filteredEnumDefinitions,r,u.CONDITION_TYPE.FILTEREDENUM):r.allow_change?Yo(this.allowChangeDefinitions,r,u.CONDITION_TYPE.ALLOWCHANGE):r.default_value?Yo(this.conditionalDefaultDefinitions,r,u.CONDITION_TYPE.CONDITIONALDEFAULT):o.logger.info("Invalid definition: "+JSON.stringify(r))}}catch(e){t.e(e)}finally{t.f()}}}},{key:"getDefinitions",value:function(e,t,r){var o;switch(t){case u.CONDITION_TYPE.VISIBLE:o=this.visibleDefinitions[r];break;case u.CONDITION_TYPE.ENABLED:o=this.enabledDefinitions[r];break;case u.CONDITION_TYPE.FILTEREDENUM:o=this.filteredEnumDefinitions[r];break;case u.CONDITION_TYPE.ALLOWCHANGE:o=this.allowChangeDefinitions[r];break;case u.CONDITION_TYPE.CONDITIONALDEFAULT:o=this.conditionalDefaultDefinitions[r];break;case u.CONDITION_TYPE.VALIDATION:o=this.validationDefinitions[r]}var n=[];for(var i in o)if(a.has_1(o,i)){var s=Un(i);s.name===e.name&&s.col===e.col&&(n=n.concat(o[i]))}return n}},{key:"getRequiredDefinitionIds",value:function(){return this.requiredDefinitionsIds}},{key:"convertPropertyId",value:function(e){return"string"==typeof e?{name:e}:this.convertNestedPropertyId(e)}},{key:"convertNestedPropertyId",value:function(e){var t;return e&&void 0!==e.col&&void 0===e.row?(void 0!==e.propertyId&&(t=this.convertNestedPropertyId(e.propertyId)),{name:e.name,row:e.col,propertyId:t}):e&&void 0!==e.col&&void 0!==e.row&&void 0!==e.propertyId?{name:e.name,row:e.row,col:e.col,propertyId:this.convertNestedPropertyId(e.propertyId)}:e}},{key:"updateLastChildPropertyId",value:function(e,t){return void 0!==e.propertyId?this.updateLastChildPropertyId(e.propertyId,t):(void 0!==t.row&&(e.row=t.row),void 0!==t.col&&(e.col=t.col),e)}},{key:"setChildPropertyId",value:function(e,t){return void 0!==e.propertyId?this.setChildPropertyId(e.propertyId,t):(e.propertyId=t,e)}},{key:"parsePanelTree",value:function(){this.panelTree={},this.panelTree[u.PANEL_TREE_ROOT]={controls:[],panels:[],actions:[]},function(e,t,r){if(t.uiItems){var o,n=$o(t.uiItems);try{for(n.s();!(o=n.n()).done;)Zo(e,o.value,r)}catch(e){n.e(e)}finally{n.f()}}}(this.panelTree,this.form,u.PANEL_TREE_ROOT)}},{key:"_addToControlValues",value:function(e){for(var t in this.controls)if(a.has_1(this.controls,t)){var r=this.controls[t],n={name:r.name},i=this.getPropertyValue(n);e?null!=i&&void 0!==i.parameterRef&&(i=this.getPropertyValue({name:i.parameterRef}),this.updatePropertyValue(n,i,!0,u.UPDATE_TYPE.INITIAL_LOAD)):"structuretable"===r.controlType&&!1===r.addRemoveRows&&!0===r.includeAllFields?(i=this._populateFieldData(i,r),this.updatePropertyValue(n,i,!0,u.UPDATE_TYPE.INITIAL_LOAD)):void 0!==r.valueDef&&void 0!==r.valueDef.defaultValue&&void 0===i?(i=r.valueDef.defaultValue,o.isSubControlStructureObjectType(r)&&(i=o.convertObjectStructureToArray(r.valueDef.isList,r.subControls,i)),this.updatePropertyValue(n,i,!0,u.UPDATE_TYPE.INITIAL_LOAD)):"structureeditor"===r.controlType&&(!i||Array.isArray(i)&&0===i.length)&&Array.isArray(r.defaultRow)&&this.updatePropertyValue(n,r.defaultRow,!0,u.UPDATE_TYPE.INITIAL_LOAD)}}},{key:"_populateFieldData",value:function(e,t){for(var r=this.getDatasetMetadataFields(),o=this._isMultiSchemaControl(t),n=[].concat(e),a=0;a<r.length;a++){var i=[];if(-1===this._indexOfField(r[a].name,e)){for(var s=0;s<t.subControls.length;s++)if(s===t.keyIndex){var l=o?{link_ref:r[a].schema,field_name:r[a].origName}:r[a].name;i.push(l)}else i.push(this._getDefaultSubControlValue(s,r[a].name,r,t));n.push(i)}}return n}},{key:"_isMultiSchemaControl",value:function(e){if(e.role===o.ParamRole.COLUMN&&e.valueDef.propType===o.Type.STRUCTURE)return!0;if("array"===o.toType(e.subControls))for(var t in e.subControls)if(a.has_1(e.subControls,t)){var r=e.subControls[t];if(r.role===o.ParamRole.COLUMN&&r.valueDef.propType===o.Type.STRUCTURE)return!0}return!1}},{key:"_canHaveMultipleSchemas",value:function(){for(var e in this.controls)if(a.has_1(this.controls,e)){var t=this.controls[e];if(this._isMultiSchemaControl(t))return!0}return!1}},{key:"_getDefaultSubControlValue",value:function(e,t,r,n){var a,i=n.subControls[e];return"undefined"!==o.toType(i.dmDefault)?a=o.getDMDefault(i,t,r):"undefined"!==o.toType(i.valueDef.defaultValue)?(a=i.valueDef.defaultValue).parameterRef&&(a=this.getPropertyValue({name:a.parameterRef})):a=i.values?i.values[0]:"string"===i.valueDef.propType?"":"boolean"!==i.valueDef.propType&&("enum"===i.valueDef.propType?i.values[0]:"integer"===i.valueDef.propType||"long"===i.valueDef.propType||"double"===i.valueDef.propType?0:"structure"===i.valueDef.propType?{}:null),a}},{key:"_indexOfField",value:function(e,t){for(var r=0;r<t.length;r++)if(t[r][0]===e)return r;return-1}},{key:"getUiItems",value:function(){return this.uiItems}},{key:"getReactIntl",value:function(){return this.reactIntl}},{key:"addSharedControls",value:function(e,t){this.sharedCtrlInfo.push({id:e,controlNames:t})}},{key:"getSharedCtrlInfo",value:function(){return this.sharedCtrlInfo}},{key:"isSummaryPanelShowing",value:function(){return this.isSummaryPanel}},{key:"setIsSummaryPanelShowing",value:function(e){this.isSummaryPanel=e}},{key:"increaseVisibleSubPanelCounter",value:function(){this.visibleSubPanelCounter++}},{key:"decreaseVisibleSubPanelCounter",value:function(){this.visibleSubPanelCounter--}},{key:"isSubPanelsShowing",value:function(){return this.visibleSubPanelCounter>0}},{key:"getTitle",value:function(){return this.propertiesStore.getTitle()}},{key:"setTitle",value:function(e){return this.propertiesStore.setTitle(e)}},{key:"setConditionOps",value:function(e){this.conditionOps=Ml(e)}},{key:"getConditionOp",value:function(e){return this.conditionOps?this.conditionOps[e]:null}},{key:"getConditionOps",value:function(){return this.conditionOps}},{key:"getDatasetMetadata",value:function(){return this.propertiesStore.getDatasetMetadata().schemas}},{key:"getDatasetMetadataFields",value:function(){return this.propertiesStore.getDatasetMetadata().fields}},{key:"getDatasetMetadataSchemas",value:function(){return this.propertiesStore.getDatasetMetadata().schemaNames}},{key:"getFilteredDatasetMetadata",value:function(e){var t=this.getDatasetMetadataFields();return e&&(t=this._filterSharedDataset(e,t),t=function(e,t,r,n){var a=n;if(t&&Array.isArray(t[e.name]))try{for(var i=t[e.name],s=0;s<i.length;s++)a=Rn(e,t[e.name][s].definition,r,a)}catch(t){o.logger.warn("Error thrown in filter for propertyId ("+e.name+"): "+t)}return a}(e,this.filterDefinitions.controls,this,t)),t}},{key:"_filterSharedDataset",value:function(e,t){if(!this.sharedCtrlInfo||!e)return t;var r,o=e.name,n=[],a=xl(this.sharedCtrlInfo);try{for(a.s();!(r=a.n()).done;){var i,s=r.value,l=xl(s.controlNames);try{for(l.s();!(i=l.n()).done;){if(o===i.value.controlName){n=s.controlNames;break}}}catch(e){l.e(e)}finally{l.f()}}}catch(e){a.e(e)}finally{a.f()}var u=n.map((function(e){return e.controlName}));return this.filterFieldsFromSharedProps(t,u,o)}},{key:"filterFieldsFromSharedProps",value:function(e,t,r){try{var n,a=[],i=xl(t);try{for(i.s();!(n=i.n()).done;){var s=n.value;if(s!==r){var l=this.getControl({name:s}),u=this.getPropertyValue({name:s});if(Array.isArray(u)){var p,c=xl(u);try{for(c.s();!(p=c.n()).done;){var d=p.value;if(Array.isArray(d)){var f=o.getTableFieldIndex(l);f>=0&&f<d.length&&a.push(o.stringifyFieldValue(d[f],l))}else a.push(o.stringifyFieldValue(d,l))}}catch(e){c.e(e)}finally{c.f()}}else a.push(o.stringifyFieldValue(u,l))}}}catch(e){i.e(e)}finally{i.f()}var h=Array.from(new Set(a));return e.filter((function(e){return-1===h.indexOf(e.name)}))}catch(e){o.logger.warn("Error filtering shared controls "+e)}return e}},{key:"setDatasetMetadata",value:function(e){var t=[],r=[];if(e){var o=n.cloneDeep_1(e);Array.isArray(o)||(o=[o]);for(var a=0;a<o.length;a++)o[a].name||(o[a].name=a.toString()),o[a].idx=a;var i,s=xl(o);try{var l=function(){var e=i.value,t=o.filter((function(t){return t.name===e.name}));if(t&&t.length>1)for(var r=0;r<t.length;r++)t[r].name=t[r].name+"_"+t[r].idx};for(s.s();!(i=s.n()).done;)l()}catch(e){s.e(e)}finally{s.f()}var u,p=xl(o);try{for(p.s();!(u=p.n()).done;){var c=u.value;if(t.push(c.name),c.fields){var d,f=xl(c.fields);try{for(f.s();!(d=f.n()).done;){var h=d.value;h.schema=c.name,h.origName=h.name,r.push(h)}}catch(e){f.e(e)}finally{f.f()}}}}catch(e){p.e(e)}finally{p.f()}}if(void 0===this.multipleSchemas&&(this.multipleSchemas=this._canHaveMultipleSchemas()),this.multipleSchemas){var m,y=xl(r);try{for(y.s();!(m=y.n()).done;){var v=m.value;v.name=v.schema+"."+v.origName}}catch(e){y.e(e)}finally{y.f()}}this.propertiesStore.setDatasetMetadata({schemas:e,fields:r,schemaNames:t})}},{key:"validateInput",value:function(e){Dn(e,this,!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}},{key:"validatePropertiesValues",value:function(){Pn(this,!(arguments.length>0&&void 0!==arguments[0])||arguments[0])}},{key:"getSelectedRows",value:function(e){var t=this.convertPropertyId(e);return this.propertiesStore.getSelectedRows(t)}},{key:"updateSelectedRows",value:function(e,t){var r=this.convertPropertyId(e);this.propertiesStore.updateSelectedRows(r,t),this._notifySelectionListener(r,t)}},{key:"clearSelectedRows",value:function(e){var t=this.convertPropertyId(e);this.propertiesStore.clearSelectedRows(t)}},{key:"setDisableRowMoveButtons",value:function(e){Array.isArray(e)&&this.propertiesStore.setDisableRowMoveButtons(e)}},{key:"getDisableRowMoveButtons",value:function(){return this.propertiesStore.getDisableRowMoveButtons()}},{key:"isDisableRowMoveButtons",value:function(e){var t=this.getDisableRowMoveButtons();return!!Array.isArray(t)&&t.some((function(t){return o.isEqual_1(t,e)}))}},{key:"addRowSelectionListener",value:function(e,t){var r=this.convertPropertyId(e),o=r.name;if(this.selectionListeners[o]||(this.selectionListeners[o]={}),Number.isInteger(r.row))throw new Error("Listening for row selection changes on controls within table cells is not currently supported");this.selectionListeners[o].listener=t}},{key:"removeRowSelectionListener",value:function(e){var t=this.convertPropertyId(e),r=t.name;if(Number.isInteger(t.row))throw new Error("Listening for row selection changes on controls within table cells is not currently supported");this.selectionListeners[r]&&delete this.selectionListeners[r]}},{key:"_notifySelectionListener",value:function(e,t){var r=this.convertPropertyId(e).name;this.selectionListeners[r]&&this.selectionListeners[r].listener(t)}},{key:"setExpressionInfo",value:function(e){this.expressionFunctionInfo=Wo(e)}},{key:"getExpressionInfo",value:function(){return this.expressionFunctionInfo}},{key:"getExpressionRecentlyUsed",value:function(){return this.expressionRecentlyUsed}},{key:"updateExpressionRecentlyUsed",value:function(e){var t=this.expressionRecentlyUsed.indexOf(e);-1===t?this.expressionRecentlyUsed.splice(0,0,e):(this.expressionRecentlyUsed.splice(t,1),this.expressionRecentlyUsed.unshift(e))}},{key:"clearExpressionRecentlyUsed",value:function(){this.expressionRecentlyUsed=[]}},{key:"getExpressionFieldsRecentlyUsed",value:function(){return this.expressionFieldsRecentlyUsed}},{key:"updateExpressionFieldsRecentlyUsed",value:function(e){var t=this.expressionFieldsRecentlyUsed.indexOf(e);-1===t?this.expressionFieldsRecentlyUsed.splice(0,0,e):(this.expressionFieldsRecentlyUsed.splice(t,1),this.expressionFieldsRecentlyUsed.unshift(e))}},{key:"clearExpressionFieldsRecentlyUsed",value:function(){this.expressionFieldsRecentlyUsed=[]}},{key:"getFilteredEnumItems",value:function(e,t){var r=this.propertiesStore.getFilteredEnumItems(e);if(Array.isArray(r)){for(var o={values:[],valueLabels:[]},n=function(e){o.values.push(r[e]);var n=r[e],a=t.values.findIndex((function(t){return t===r[e]}));a>-1&&(n=t.valueLabels[a]),o.valueLabels.push(n)},a=0;a<r.length;a++)n(a);return o}return t}},{key:"updatePropertyValue",value:function(e,t,r,n){var a=this.convertPropertyId(e),i=this.getPropertyValue(a);if(void 0===t?this.removePropertyValue(a):this.propertiesStore.updatePropertyValue(a,t),function(e,t){var r=!0;if(!t.getControl(e))return o.logger.warn("Control not found for "+e.name),r;var n=t.getDefinitions(e,u.CONDITION_TYPE.ALLOWCHANGE,u.CONDITION_DEFINITION_INDEX.CONTROLS);if(n.length>0)try{var a,i=wn(n);try{for(i.s();!(a=i.n()).done;)if(!(r=Cn(a.value.definition,e,t)))return r}catch(e){i.e(e)}finally{i.f()}}catch(e){o.logger.warn("Error thrown in validation: "+e)}return r}(e,this)){if(Mn(e,this),r||Dn(e,this,!0),this.handlers.propertyListener){var s=this._convertObjectStructure(a,t),l={action:u.ACTIONS.UPDATE_PROPERTY,property:a,value:s};void 0!==n&&(l.type=n),this.handlers.propertyListener(l)}}else this.propertiesStore.updatePropertyValue(a,i)}},{key:"getPropertyValue",value:function(e,t,r){var n=this.convertPropertyId(e),a=this.propertiesStore.getPropertyValue(n),i=r,s=t&&(t.filterHiddenDisabled||t.filterHidden),l=t&&(t.filterHiddenDisabled||t.filterDisabled),p=t&&t.filterHiddenControls;if(s||l||p){var c=this.getControlState(n),d=this.getControlType(n);if(c===u.STATES.DISABLED&&l||c===u.STATES.HIDDEN&&s||d===o.ControlType.HIDDEN&&p)return i;if(i=o.copy(a),Array.isArray(i))for(var f=0;f<i.length;f++){var h=i[f];if(Array.isArray(h))for(var m=0;m<h.length;m++){var y={name:n.name,row:f,col:m},v=this.getControlState(y),g=this.getControlType(y);(v===u.STATES.DISABLED&&l||v===u.STATES.HIDDEN&&s||g===o.ControlType.HIDDEN&&p)&&(i[f][m]=null)}}return t&&!0===t.applyProperties?this._convertObjectStructure(n,i):i}return t&&!0===t.applyProperties?this._convertObjectStructure(n,a):a}},{key:"removePropertyValue",value:function(e){var t=this.convertPropertyId(e);this.propertiesStore.removePropertyValue(t)}},{key:"_convertObjectStructure",value:function(e,t){var r=this.getControl(e);if(o.isSubControlStructureObjectType(r)){var n=r.structureType&&"object"===r.structureType;return o.convertArrayStructureToObject(r.valueDef.isList,r.subControls,t,n)}return t}},{key:"getPropertyValues",value:function(e){var t=this.propertiesStore.getPropertyValues(),r=t;if(e&&(e.filterHiddenDisabled||e.filterHidden||e.filterDisabled||e.filterHiddenControls)){var o={};for(var n in t)if(a.has_1(t,n)){var i=this.getPropertyValue({name:n},e);void 0!==i&&(o[n]=i)}r=o}if(e&&!0===e.applyProperties)for(var s in r)if(a.has_1(r,s)){var l=this.convertPropertyId(s),u=this.propertiesStore.getPropertyValue(l);r[s]=this._convertObjectStructure(l,u)}return r}},{key:"setPropertyValues",value:function(e,t){var r=this,i=n.cloneDeep_1(e);if(e){var s=this.getControls();Object.keys(i).forEach((function(t){if(o.isSubControlStructureObjectType(s[t])){var r=e[t],n=s[t],a=o.convertObjectStructureToArray(n.valueDef.isList,n.subControls,r);i[t]=a}}))}if(this.propertiesStore.setPropertyValues(i),t){var l={};a.isEmpty_1(i)||(Object.keys(i).forEach((function(e){!function(e,t,r){if(!t.getControl(e))return o.logger.warn("Control not found for "+e.name),null;var n=t.getDefinitions(e,u.CONDITION_TYPE.CONDITIONALDEFAULT,u.CONDITION_DEFINITION_INDEX.CONTROLS);if(n.length>0)try{var a,i=wn(n);try{for(i.s();!(a=i.n()).done;){var s=a.value,l=s.definition.default_value.parameter_ref;l in r||Cn(s.definition,e,t)&&(r[l]=s.definition.default_value.value)}}catch(e){i.e(e)}finally{i.f()}}catch(e){o.logger.warn("Error thrown in validation: "+e)}}({name:e},r,l)})),a.isEmpty_1(l)||Object.keys(l).forEach((function(e){if(!(e in i)){var t=r.getControl({name:e});o.isSubControlStructureObjectType(t)&&(l[e]=o.convertObjectStructureToArray(t.valueDef.isList,t.subControls,l[e])),r.propertiesStore.updatePropertyValue({name:e},l[e])}})))}Ln(this),this.handlers.propertyListener&&this.handlers.propertyListener({action:u.ACTIONS.SET_PROPERTIES})}},{key:"setControlStates",value:function(e){this.propertiesStore.setControlStates(e)}},{key:"updateControlState",value:function(e,t){var r=this.convertPropertyId(e);this.propertiesStore.updateControlState(r,t)}},{key:"getControlState",value:function(e){var t=this.propertiesStore.getControlState(e);return t?t.value:""}},{key:"getControlStates",value:function(){return this.propertiesStore.getControlStates()}},{key:"getControlValueStates",value:function(e){var t=this.propertiesStore.getControlState(e);return t?t.values:{}}},{key:"getControlEnumFilterStates",value:function(e){var t=this.propertiesStore.getControlState(e);return t?t.enumFilter:{}}},{key:"setPanelStates",value:function(e){this.propertiesStore.setPanelStates(e)}},{key:"updatePanelState",value:function(e,t){this.propertiesStore.updatePanelState(e,t)}},{key:"getPanelState",value:function(e){return this.propertiesStore.getPanelState(e)}},{key:"getPanelStates",value:function(){return this.propertiesStore.getPanelStates()}},{key:"clearActiveTearsheet",value:function(){this.propertiesStore.setActiveTearsheetId(null)}},{key:"setActiveTearsheet",value:function(e){this.propertiesStore.setActiveTearsheetId(e)}},{key:"getActiveTearsheet",value:function(){return this.propertiesStore.getActiveTearsheetId()||null}},{key:"setActionStates",value:function(e){this.propertiesStore.setActionStates(e)}},{key:"updateActionState",value:function(e,t){this.propertiesStore.updateActionState(e,t)}},{key:"getActionState",value:function(e){return this.propertiesStore.getActionState(e)}},{key:"getActionStates",value:function(){return this.propertiesStore.getActionStates()}},{key:"getAction",value:function(e){return this.actions[e.name]}},{key:"setErrorMessages",value:function(e){this.propertiesStore.setErrorMessages(e)}},{key:"getErrorMessage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=this.convertPropertyId(e);if(t){var i=this.getControlState(a),s=this.getControlType(a);if(i===u.STATES.DISABLED||i===u.STATES.HIDDEN||s===o.ControlType.HIDDEN)return null}var l=this.propertiesStore.getErrorMessage(a,this.reactIntl);return r&&l&&l.type===u.CONDITION_MESSAGE_TYPE.SUCCESS||n&&l&&!o.isUndefined_1(l.displayError)&&!l.displayError?null:l}},{key:"getErrorMessages",value:function(e,t,r){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=this.propertiesStore.getErrorMessages();return o&&(n=this._filterDisplayErrors(n)),(e||t)&&(n=this._filterMessages(n,e,t,r)),n}},{key:"getAllErrorMessages",value:function(){return this.getErrorMessages(!1,!1,!1,!1)}},{key:"getRequiredErrorMessages",value:function(){var e=this.propertiesStore.getErrorMessages(),t=this._filterNonRequiredErrors(e);return this._filterHiddenDisabledErrors(t)}},{key:"_filterMessages",value:function(e,t,r,o){var n={},i=[];for(var s in e)if(a.has_1(e,s)){var l=this.getErrorMessage({name:s},r,o);l&&l.text&&(t?i.push({id_ref:s,validation_id:l.validation_id,type:l.type,text:l.text}):n[s]=l)}return t?i:n}},{key:"_filterDisplayErrors",value:function(e){return this._filterErrors(e,(function(e){return o.isUndefined_1(e.displayError)||e.displayError}))}},{key:"_filterNonRequiredErrors",value:function(e){return this._filterErrors(e,(function(e){return!0===e.required}))}},{key:"_filterHiddenDisabledErrors",value:function(e){var t=this;return this._filterErrors(e,(function(e,r){var n=t.getControlState(r),a=t.getControlType(r);return n!==u.STATES.HIDDEN&&n!==u.STATES.DISABLED&&a!==o.ControlType.HIDDEN}))}},{key:"_filterErrors",value:function(e,t){var r={};return Object.keys(e).forEach((function(o){var n=e[o];if(n.text&&t(n,n.propertyId))r[o]=n;else for(var i in n)if(a.has_1(n,i)){var s=n[i];if(s&&s.text&&t(s,s.propertyId))void 0===r[o]&&(r[o]={}),r[o][i]=s;else for(var l in s)if(a.has_1(s,l)){var u=s[l];u&&u.text&&t(u,u.propertyId)&&(void 0===r[o]&&(r[o]={}),void 0===r[o][i]&&(r[o][i]={}),r[o][i][l]=u)}}})),r}},{key:"updateErrorMessage",value:function(e,t){var r=this.convertPropertyId(e);t&&"info"!==t.type?this.propertiesStore.updateErrorMessage(r,t):this.propertiesStore.clearErrorMessage(r)}},{key:"removeErrorMessageRow",value:function(e){var t=this.convertPropertyId(e),r=this.propertiesStore.getErrorMessages(),o=r[t.name];if(void 0!==o){for(var n=0,a=Object.keys(o);n<a.length;n++){var i=a[n],s=parseInt(i,10);s===t.row?delete r[t.name][s]:s>t.row&&(r=this._moveMessageRows(r,t.name,s,s-1))}this.setErrorMessages(r)}}},{key:"moveErrorMessageRows",value:function(e,t,r){var o=this.propertiesStore.getErrorMessages(),n=o[e];if(void 0!==n){var a=n[t],i=n[r];if(void 0!==a&&void 0!==i){(o=this._moveMessageRows(o,e,t,r))[e][t]={};for(var s=0,l=Object.keys(i);s<l.length;s++){var u=l[s];o[e][t][u]=i[u]}}else void 0!==a?o=this._moveMessageRows(o,e,t,r):void 0!==i&&(o=this._moveMessageRows(o,e,r,t));this.setErrorMessages(o)}}},{key:"_moveMessageRows",value:function(e,t,r,o){return e[t][o]=e[t][r],delete e[t][r],e}},{key:"saveControls",value:function(e){var t=this;e.forEach((function(e){void 0===e.columnIndex?(!a.has_1(t.controls,e.name)||a.has_1(t.controls,e.name)&&e.controlType!==o.ControlType.CUSTOM)&&(t.controls[e.name]=e):t.controls[e.parameterName][e.columnIndex]=e}))}},{key:"getControl",value:function(e){var t=this.controls[e.name];if(void 0!==e.col&&t){var r=this.controls[e.name][e.col.toString()];if(r)return r}return t}},{key:"getControlPropType",value:function(e){var t=this.getControl(e);return void 0!==t.valueDef?t.valueDef.propType:null}},{key:"updateControlEnumValues",value:function(e,t){var r=this.getControl(e);Array.isArray(t)&&r?(r.values=t.map((function(e){return e.value})),r.valueLabels=t.map((function(e){return e.label?e.label:e.value}))):o.logger.warn("properties-controller",new Error("updateControlEnumValues - control not found or valuesObj not valid"))}},{key:"getControls",value:function(){return this.controls}},{key:"setSaveButtonDisable",value:function(e){this.propertiesStore.setSaveButtonDisable(e)}},{key:"getSaveButtonDisable",value:function(){return this.propertiesStore.getSaveButtonDisable()}},{key:"setWideFlyoutPrimaryButtonDisabled",value:function(e,t){this.propertiesStore.setWideFlyoutPrimaryButtonDisabled(e,t)}},{key:"getWideFlyoutPrimaryButtonDisabled",value:function(e){return this.propertiesStore.getWideFlyoutPrimaryButtonDisabled(e)}},{key:"isRequired",value:function(e){var t=this.getControl(e);if(t){var r=t.required;return r||!1}return!1}},{key:"isSummary",value:function(e){var t=this.getControl(e);if(t){var r=t.summary;return r||!1}return!1}},{key:"getControlType",value:function(e){if(void 0===e)return null;var t=this.getControl(e);return t?t.controlType:null}},{key:"getColumnVisibility",value:function(e,t){return this.controls[e.name][t].visible}},{key:"toggleColumnVisibility",value:function(e,t,r){this.controls[e.name][t].visible=r}},{key:"_parseSummaryControls",value:function(e){var t={};e.forEach((function(e){e.summaryPanelId&&(void 0===t[e.summaryPanelId]&&(t[e.summaryPanelId]=[]),void 0===e.columnIndex&&t[e.summaryPanelId].push(e.name))})),this.setSummaryPanelControls(t)}},{key:"setSummaryPanelControls",value:function(e){this.summaryPanelControls=e}},{key:"getSummaryPanelControls",value:function(e){return this.summaryPanelControls[e]}},{key:"updateCustPropSumPanelValue",value:function(e,t){void 0!==e.name&&(this.custPropSumPanelValues[e.name]=t)}},{key:"getCustPropSumPanelValue",value:function(e){var t=this.getControlState(e);return t===u.STATES.DISABLED||t===u.STATES.HIDDEN?null:this.custPropSumPanelValues[e.name]}},{key:"setControlInSummary",value:function(e,t,r){var o=this.getControl(e);o&&(o.summary=!0,o.summaryLabel=t)}},{key:"createControl",value:function(e,t,r){var o=a.get_1(this.getPropertiesConfig(),"containerType"),n=this.controlFactory.createFormControl(t,r,this.getLight(),o),i=[];return Go(i,n,this.getControl(e).parentCategoryId),this.saveControls(i),this.controlFactory.createControlItem(n,e)}},{key:"getControlFactory",value:function(){return this.controlFactory}},{key:"setCustomControls",value:function(e){this.customControls=e}},{key:"getCustomControl",value:function(e,t,r){if(t.customControlId){var n,a=xl(this.customControls);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i.id()===t.customControlId)try{return new i(e,this,t.data,r).renderControl()}catch(e){return o.logger.warn("Error thrown creating custom control: "+e),""}}}catch(e){a.e(e)}finally{a.f()}}return"Custom control not found: "+t.customControlId}},{key:"getMaxLengthForMultiLineControls",value:function(){return void 0!==this.getPropertiesConfig().maxLengthForMultiLineControls?this.getPropertiesConfig().maxLengthForMultiLineControls:1024}},{key:"getMaxLengthForSingleLineControls",value:function(){return void 0!==this.getPropertiesConfig().maxLengthForSingleLineControls?this.getPropertiesConfig().maxLengthForSingleLineControls:128}},{key:"setInitialAddRemoveRows",value:function(){var e=this;Object.keys(this.controls).forEach((function(t){var r=e.controls[t];if(r.valueDef&&r.valueDef.propType===o.Type.STRUCTURE&&!o.isUndefined_1(r.addRemoveRows)){var n={name:r.name};e.setAddRemoveRows(n,r.addRemoveRows)}}))}},{key:"setAddRemoveRows",value:function(e,t){this.propertiesStore.setAddRemoveRows(e,t)}},{key:"getAddRemoveRows",value:function(e){return this.propertiesStore.getAddRemoveRows(e)}},{key:"setHideEditButton",value:function(e,t){this.propertiesStore.setHideEditButton(e,t)}},{key:"getHideEditButton",value:function(e){return this.propertiesStore.getHideEditButton(e)}},{key:"getStaticRows",value:function(e){var t=this.convertPropertyId(e);return this.propertiesStore.getStaticRows(t)}},{key:"updateStaticRows",value:function(e,t){var r=this.convertPropertyId(e),o=this.getPropertyValue(e),n=t.sort();this.validateSelectionValues(n,o)&&this.propertiesStore.updateStaticRows(r,n)}},{key:"clearStaticRows",value:function(e){var t=this.convertPropertyId(e);this.propertiesStore.clearStaticRows(t)}},{key:"setInitialTableButtonState",value:function(){var e=this;Object.keys(this.controls).forEach((function(t){var r=e.controls[t],n={name:r.name};o.isUndefined_1(r.buttons)||r.buttons.forEach((function(t){e.setTableButtonEnabled(n,t.id,t.enabled||!1)})),r.subControls&&e.setInitialTableButtonSubControlState(n,r.subControls)}))}},{key:"setInitialTableButtonSubControlState",value:function(e,t){var r=this;t.forEach((function(t){var n=r.getPropertyValue(e);o.isUndefined_1(t.buttons)||n.forEach((function(o,n){var a={name:e.name,row:n,col:t.columnIndex};t.buttons.forEach((function(e){r.setTableButtonEnabled(a,e.id,e.enabled||!1)}))}))}))}},{key:"setTableButtonEnabled",value:function(e,t,r){this.propertiesStore.setTableButtonEnabled(e,t,r)}},{key:"getTableButtons",value:function(e){return this.propertiesStore.getTableButtons(e)}},{key:"getTableButtonEnabled",value:function(e,t){return this.propertiesStore.getTableButtonEnabled(e,t)}},{key:"validateSelectionValues",value:function(e,t){var r=!1;e&&t.length>0?r=!(!e.slice(1).map((function(t,r){return t-e[r]})).every((function(e){return 1===e}))||!(e.includes(0)&&!e.includes(t.length-1)||!e.includes(0)&&e.includes(t.length-1))):r=!1;return r}}]),t}(),Vl={$schema:"https://json-schema.org/draft-04/schema#",id:"https://api.dataplatform.ibm.com/schemas/common-canvas/parameter-defs/parameter-defs-v3-schema.json",title:"Property Definitions Schema",description:"Watson Data Platform Property Definition Schema for the Common Properties editor",type:"object",properties:{titleDefinition:{type:"object",properties:{title:{type:"string"},editable:{description:"True if the title can be edited. False if the title should be readonly.",default:!0,type:"boolean"}}},current_parameters:{description:"Current parameter set upon input. Keys are parameter names, values are their values.",type:"object",properties:{},additionalProperties:!0},current_ui_parameters:{description:"Current UI only parameter set upon input. Keys are parameter names, values are their values.",type:"object",properties:{},additionalProperties:!0},parameters:{$ref:"https://api.dataplatform.ibm.com/schemas/common-pipeline/operators/operator-v3-schema.json#/properties/parameters"},complex_types:{$ref:"https://api.dataplatform.ibm.com/schemas/common-pipeline/operators/operator-v3-schema.json#/properties/complex_types"},uihints:{$ref:"https://api.dataplatform.ibm.com/schemas/common-pipeline/operators/uihints-v3-schema.json#"},conditions:{$ref:"https://api.dataplatform.ibm.com/schemas/common-pipeline/operators/conditions-v3-schema.json#/properties/conditions"},dataset_metadata:{oneOf:[{description:"A single datarecord object. Deprecated.",$ref:"https://api.dataplatform.ibm.com/schemas/common-pipeline/datarecord-metadata/datarecord-metadata-v3-schema.json#"},{description:"An array of datarecord objects",type:"array",items:{$ref:"https://api.dataplatform.ibm.com/schemas/common-pipeline/datarecord-metadata/datarecord-metadata-v3-schema.json#"}}]},resources:{description:"Map of string resources.",type:"object",properties:{},additionalProperties:!0}}},Ul={$schema:"https://json-schema.org/draft-04/schema#",id:"https://api.dataplatform.ibm.com/schemas/common-pipeline/operators/uihints-v3-schema.json#",description:"WDP UI Hints schema",title:"WDP UI Hints schema",type:"object",properties:{id:{description:"Operator identifier",type:"string"},json_schema:{description:"Refers to the JSON schema used to validate documents of this type",enum:["https://api.dataplatform.ibm.com/schemas/common-pipeline/operators/uihints-v3-schema.json"]},label:{description:"External name of operator",type:"object",$ref:"#/definitions/resource_definition"},description:{description:"Description of operator",type:"object",$ref:"#/definitions/resource_definition"},icon:{description:"URL to operation icon",type:"string"},group_info:{type:"array",items:{$ref:"#/definitions/group_definition"}},editor_size:{description:"Editor size for node edits",enum:["small","medium","large"]},pixel_width:{description:"Gives more control of editor panel width. The panel is shown at min size if editor_size is small and max size if editor_size is medium. If min and max are the same no sizing button is displayed.",type:"object",properties:{min:{description:"Minimum size in pixels for the right side editor flyout",type:"number"},max:{description:"Maximum size in pixels for the right side editor flyout",type:"number"}}},parameter_info:{items:{$ref:"#/definitions/parameter_definition"},type:"array"},complex_type_info:{items:{$ref:"#/definitions/complex_type_definition"},type:"array"},ui_parameters:{description:"List of UI only parameters",type:"array",items:{$ref:"https://api.dataplatform.ibm.com/schemas/common-pipeline/operators/operator-v3-schema.json#/definitions/parameter_definition"}},action_info:{items:{$ref:"#/definitions/action_definition"},type:"array"},help:{description:"Help information",type:"object",properties:{data:{description:"Data passed in the helpClickHandler.",type:"object",additionalProperties:!0}},additionalProperties:!0}},required:["id"],definitions:{group_definition:{description:"Grouping for parameters and groups",type:"object",properties:{id:{description:"Identifier for this group",type:"string"},type:{description:"The group type to be displayed",type:"string",enum:["controls","tabs","subTabs","panels","columnSelection","columnSelectionRecursive","panelSelector","customPanel","summaryPanel","actionPanel","textPanel","twistyPanel","tearsheetPanel","columnPanel"]},depends_on_ref:{description:"Parameter name this group depends upon. Valid for panelSelector groups only.",type:"string"},insert_panels:{description:"Indicates whether panels, contained with a panelSelector, should be inserted between the radio buttons of a radio button set indicated by the depends_on_ref parameter.",type:"boolean"},nested_panel:{description:"Indicate whether panel should be nested. Nested panels are indented by 16px from the left and display left border. Default is false.",type:"boolean"},open:{description:"Used to determine if a panel is open or closed when UI is displayed.  Currenty only supported with twistyPanel. Default is false.",type:"boolean"},label:{description:"Group label",type:"object",$ref:"#/definitions/resource_definition"},description:{description:"Group description. Used in a textPanel and tearsheetPanel",type:"object",$ref:"#/definitions/resource_definition"},parameter_refs:{description:"List of parameters to be displayed",type:"array",items:{type:"string"}},action_refs:{description:"List of actions to be displayed.  Used with an actionPanel",type:"array",items:{type:"string"}},data:{description:"Data passed to custom panel when group type is 'customPanel'",additionalProperties:!0,oneOf:[{type:"object"},{type:"array"}]},group_info:{items:{$ref:"#/definitions/group_definition"},type:"array"},class_name:{description:"Optional class name to set for this group",type:"string"}},required:["id"]},parameter_definition:{description:"Operator parameters hints",type:"object",properties:{parameter_ref:{description:"Parameter reference to base operator parameter definition",type:"string"},label:{description:"External name for parameter",type:"object",$ref:"#/definitions/resource_definition"},label_visible:{description:"Whether to display the label or not. If not displayed, the label can still be used by screen readers",type:"boolean",default:!0},description:{description:"Description of parameter with optional placement context and optional link",type:"object",allOf:[{$ref:"#/definitions/resource_definition"},{properties:{placement:{description:"Optional placement context for the text",enum:["as_tooltip","on_panel"],default:"as_tooltip"},link:{description:"Optional link in the description. tooltipLinkHandler callback must be defined whenever link object is added in uiHints.",type:"object",properties:{id:{description:"link id",type:"string"},data:{description:"Data passed to the tooltipLinkHandler callback",type:"object",additionalProperties:!0}},required:["id"]}}}]},control:{description:"Which control to use.  In most cases the control gets to be determined and should not be set",type:"string",enum:["readonly","readonlyTable","textfield","passwordfield","textarea","expression","numberfield","spinner","checkbox","radioset","checkboxset","toggletext","toggle","oneofselect","multiselect","someofselect","selectcolumn","selectcolumns","selectschema","structuretable","structurelisteditor","structureeditor","custom","datefield","datepicker","datepickerRange","timefield","timestampfield","code","list","hidden"]},increment:{description:"Determines the increment/decrement value for the spinner control only",type:"number",default:1},orientation:{description:"Determines how the control is displayed",type:"string",enum:["vertical","horizontal"]},width:{description:"Percentage of group width the control should use",type:"number"},char_limit:{description:"Limits the number of characters a user can enter into the control for string parameters only",type:"number"},display_chars:{description:"This has been deprecated and is subject to removal. Limits the number of characters displayed for a text field in a column in a table.  The text will have an ellipsis appended at this limit.",type:"number",default:64},separator:{description:"Determines where to put a separator relative to the current control",type:"string",enum:["before","after"]},visible:{description:"Determines whether to display parameter in control. Used in complex structures",type:"boolean"},place_holder_text:{description:"Text hint for the user displayed input controls",type:"object",$ref:"#/definitions/resource_definition"},text_before:{description:"Static text to be displayed before the control",type:"object",$ref:"#/definitions/text_definition"},text_after:{description:"Static text to be displayed after the control",type:"object",$ref:"#/definitions/text_definition"},resource_key:{description:"Used as a key for enum value labels",type:"string"},edit_style:{description:"Editing style of elements in a table",type:"string",enum:["subpanel","inline","on_panel"]},value_icons:{description:"For enumerated types, this defines the set of icons for the valid values. The ordering must be consistent with the order in the parameter enum attribute.",type:"array",items:{type:"string"}},sortable:{description:"Determines if this column values can be sorted into ascending/descending order in a table. Applies to structure parameters only.",type:"boolean"},filterable:{description:"Determines if this column values can be filtered so that only rows that match the filter in column values are shown in the table. Applies to structure parameters and multiselect control only.",type:"boolean"},resizable:{description:"Determines if this column can be resized in a table. When a column is resized, width of all the columns to the right of resized column is adjusted. Applies to structure parameters only.",type:"boolean",default:!1},language:{description:"The language for the expression editor syntax highlight and autocomplete workds. Applies to expression control type.",type:"string",enum:["CLEM","javascript","text/x-hive","text/x-rsrc","text/x-python","text/x-sql"]},summary:{description:"Determines if this column values will be shown in the summaryPanel",type:"boolean"},generated_values:{description:"Generates values for a column in a 'readonly' parameter.",type:"object",properties:{operation:{description:"Currently only 'index' is supported which will auto-increment the integer column value starting at 1. The start value can be configured by setting a start_value.",type:"string",enum:["index"]},start_value:{description:"Optional start value to increment from when the 'type' is 'index'. If the start_value is not set, it will default to 1.",type:"integer"}},required:["operation"]},number_generator:{description:"Adds a number generation button beside the numeric control",type:"object",properties:{label:{description:"Number generator button label. It is visible on hover.",type:"object",$ref:"#/definitions/resource_definition"},range:{description:"Number generator range",type:"object",properties:{min:{description:"Maximum value for generated numbers",type:"number"}},required:["min","max"]}},required:["label"]},dm_default:{description:"Used within complex structures containing 'column' key_definition fields. This associates the subControl parameter with a field attribute in the current record schema.",type:"string",enum:["type","description","measure","modeling_role"]},dm_icon:{description:"This can be set to display an icon of the corresponding dm type in the `role`:`column' field of a table.",type:"string",enum:["measure","none"]},custom_control_id:{description:"Used to determine which custom control to use when control=custom.",type:"string"},data:{description:"Data passed to custom control when control=custom",type:"object",additionalProperties:!0},date_format:{description:"A format string such as YYYY-MM-DD which describes the display and entry format for a date field.",type:"string"},time_format:{description:"A format string such as HH:mm:ss which describes the display and entry format for a time field.",type:"string"},moveable_rows:{description:"Determines if rows can be moved up or down in a table or array of strings",type:"boolean"},rows:{description:"Number of rows to display in tables",type:"integer",default:4},action_ref:{description:"Determines an action should be added to the control",type:"string"},custom_value_allowed:{description:"Determines if a dropdown, outside of a table, can allow a custom value to be entered",type:"boolean"},class_name:{description:"Optional class name to set for this control",type:"string"},enable_maximize:{description:"Determines if maximize/minimze buttons are shown for code control",type:"boolean"}},required:["parameter_ref"]},complex_type_definition:{type:"object",description:"Complex parameters",properties:{complex_type_ref:{type:"string",description:"Name of complex type, can be referenced in other places."},label:{description:"External name used in subpanels",type:"object",$ref:"#/definitions/resource_definition"},key_definition:{$ref:"#/definitions/parameter_definition"},layout:{description:"Array of rows containing structure element names",type:"array",items:{description:"A single row of structure parameter names for laying out horizontally",type:"array",items:{description:"A parameter name within the current structure",type:"string"}}},parameters:{type:"array",description:"List of parameters",items:{anyOf:[{$ref:"#/definitions/parameter_definition"},{$ref:"#/definitions/complex_type_definition"}]}},add_remove_rows:{description:"Determines if the table can have rows added and removed",type:"boolean",default:!0},row_selection:{description:"Determines how many rows can be selected at a time.  'multiple-edit': select multiple rows and allow the editing of column values for all selected rows.",type:"string",enum:["single","multiple","multiple-edit"]},header:{description:"Determines if the table header should be displayed",type:"boolean",default:!0},include_all_fields:{description:"Use when `add_remove_rows` is false. Ensures the control contains a record for each field in the data model.",type:"boolean",default:!0},buttons:{description:"Display custom buttons in place of any buttons from the table. Will override 'add_remove_rows' and readonlyTable edit buttons.",type:"array",items:{$ref:"#/definitions/button_definition"}}},required:["complex_type_ref","parameters"]},action_definition:{description:"Actions that callback to application",type:"object",properties:{id:{description:"Identifier for this action",type:"string"},description:{description:"Description of action.  Use for tooltip.",type:"object",$ref:"#/definitions/resource_definition"},control:{description:"The action type to be displayed",type:"string",enum:["button","image"]},label:{description:"Action label",type:"object",$ref:"#/definitions/resource_definition"},button:{description:"Properties for button kind and size. Use when control=button.",type:"object",properties:{kind:{description:"button kind",type:"string",enum:["primary","secondary","tertiary","ghost","danger","danger--tertiary","danger--ghost"],default:"tertiary"},size:{description:"button size",enum:["sm","md","lg","xl"],default:"sm"}}},image:{description:"Properties for how the image will look.  Use when control=image.",type:"object",properties:{url:{description:"image url to be used for action",type:"string"},placement:{description:"placement of the action image",enum:["right","left"]},size:{description:"pixel size of the image.",type:"object",properties:{height:{description:"image height in pixels",type:"number"},width:{description:"image width in pixels",type:"number"}}},tooltip_direction:{description:"Action image tooltip direction.",enum:["right","left","top","bottom"],default:"bottom"}}},data:{description:"Data returned when action called",type:"object",additionalProperties:!0}},required:["id"]},resource_definition:{description:"Localizable string resource",type:"object",properties:{default:{type:"string"},resource_key:{type:"string"}},anyOf:[{required:["default"]},{required:["resource_key"]}]},text_definition:{description:"Static text to be displayed before or after the control",type:"object",allOf:[{$ref:"#/definitions/resource_definition"},{properties:{type:{description:"Type of text message to display",enum:["info"]}}}]},button_definition:{description:"Button to be displayed after the table's search bar",type:"object",properties:{id:{description:"Button identifier used to idenify the button in the callback function",type:"string"},label:{description:"Button label to display. If an icon is specified as well, the icon will be shown to the right of the label.",type:"object",$ref:"#/definitions/resource_definition"},description:{description:"Tooltip text to display when the button is hovered",type:"object",$ref:"#/definitions/resource_definition"},icon:{description:"URL to .svg image to display",type:"string"},carbon_icon:{description:"Host provided name of Carbon icon to display. A callback function is required for the host application to return the jsx icon object imported from @carbon/icons-react library",type:"string"},enabled:{description:"Button will be enabled if true, disabled if false",type:"boolean",default:!1},divider:{description:"Display a divider before or after this button",type:"string",enum:["before","after"],default:"after"}},anyOf:[{required:["id","label"]},{required:["id","icon","description"]},{required:["id","carbon_icon","description"]}]}}},zl={$schema:"https://json-schema.org/draft-04/schema#",id:"https://api.dataplatform.ibm.com/schemas/common-pipeline/operators/conditions-v3-schema.json#",title:"Watson Data Platform Validation Schema",description:"User Interface Condition schema for the Watson Data Platform",type:"object",properties:{json_schema:{description:"Refers to the JSON schema used to validate documents of this type",enum:["https://api.dataplatform.ibm.com/schemas/common-pipeline/operators/conditions-v3-schema.json"]},conditions:{type:"array",items:{$ref:"#/definitions/conditions_definition"}}},required:["conditions"],definitions:{conditions_definition:{type:"object",oneOf:[{$ref:"#/definitions/validation_definition"},{$ref:"#/definitions/enabled_definition"},{$ref:"#/definitions/visible_definition"},{$ref:"#/definitions/filter_definition"},{$ref:"#/definitions/enum_filter_definition"},{$ref:"#/definitions/allow_change_definition"},{$ref:"#/definitions/default_value_definition"}]},validation_definition:{properties:{validation:{description:"A single validation. The fail_message is displayed upon validation failure.",type:"object",properties:{id:{description:"Unique identifier.  Required when multiple fail_message sections have the same focus_parameter_ref value.",type:"string"},fail_message:{description:"Error/warning",type:"object",$ref:"#/definitions/fail_message_definition"},evaluate:{description:"Evaluates to a boolean result",type:"object",$ref:"#/definitions/evaluate_definition"}},required:["fail_message","evaluate"]}},required:["validation"]},enabled_definition:{properties:{enabled:{description:"Enablement test. Disables controls if evaluate is false.",type:"object",properties:{parameter_refs:{description:"Array of parameter names affected by this operation",type:"array",minItems:1,items:{type:"string"},uniqueItems:!0},values:{description:"Optional array of enumeration item names to operate upon",type:"array",minItems:1,items:{type:"string"},uniqueItems:!0},group_refs:{description:"Array of group ids affected by this operation",type:"array",minItems:1,items:{type:"string"},uniqueItems:!0},action_refs:{description:"Array of action ids affected by this operation",type:"array",minItems:1,items:{type:"string"},uniqueItems:!0},evaluate:{description:"Evaluates to a boolean result",type:"object",$ref:"#/definitions/evaluate_definition"}},anyOf:[{required:["parameter_refs"]},{required:["group_refs"]},{required:["action_refs"]}],required:["evaluate"]}},required:["enabled"]},visible_definition:{properties:{visible:{description:"Visibility test. Hides controls if evaluate is false.",type:"object",properties:{parameter_refs:{description:"Array of parameter names affected by this operation",type:"array",minItems:1,items:{type:"string"},uniqueItems:!0},values:{description:"Optional array of enumeration item names to operate upon",type:"array",minItems:1,items:{type:"string"},uniqueItems:!0},group_refs:{description:"Array of group ids affected by this operation",type:"array",minItems:1,items:{type:"string"},uniqueItems:!0},action_refs:{description:"Array of action ids affected by this operation",type:"array",minItems:1,items:{type:"string"},uniqueItems:!0},evaluate:{description:"Evaluates to a boolean result",type:"object",$ref:"#/definitions/evaluate_definition"}},anyOf:[{required:["parameter_refs"]},{required:["group_refs"]},{required:["action_refs"]}],required:["evaluate"]}},required:["visible"]},evaluate_definition:{oneOf:[{$ref:"#/definitions/and_definition"},{$ref:"#/definitions/or_definition"},{$ref:"#/definitions/condition_definition"},{$ref:"#/definitions/filter_condition_definition"}]},or_definition:{description:"Container for 'or' operations",type:"object",properties:{or:{description:"The 'or' condition. Any sub-condition evaluates to true. Can nest any number of additional conditional types.",type:"array",items:{anyOf:[{$ref:"#/definitions/and_definition"},{$ref:"#/definitions/or_definition"},{$ref:"#/definitions/condition_definition"},{$ref:"#/definitions/filter_condition_definition"}]}}},required:["or"]},and_definition:{description:"Container for 'and' operations",type:"object",properties:{and:{description:"The 'and' condition. All sub-conditions evaluate to true. Can nest any number of additional conditional types.",type:"array",items:{anyOf:[{$ref:"#/definitions/and_definition"},{$ref:"#/definitions/or_definition"},{$ref:"#/definitions/condition_definition"},{$ref:"#/definitions/filter_condition_definition"}]}}},required:["and"]},condition_definition:{description:"A parameter condition. Evaluates to true or false.",type:"object",properties:{condition:{description:"The condition that is evaluated",type:"object",properties:{op:{description:"A single operator for the properties of the condition.",anyOf:[{enum:["isEmpty","isNotEmpty","greaterThan","lessThan","equals","notEquals","contains","notContains","colNotExists","cellNotEmpty","colDoesExist","isDateTime","dmTypeEquals","dmTypeNotEquals","dmMeasurementEquals","dmMeasurementNotEquals","dmRoleEquals","dmRoleNotEquals","matches","notMatches"]},{description:"The name of the custom operator",type:"string"}]},parameter_ref:{description:"The primary parameter - must be present",type:"string"},parameter_2_ref:{description:"Optional second parameter for multi-parameter validation",type:"string"},value:{description:"Optional value against which to compare the primary parameter value",oneOf:[{type:"string"},{type:"number"},{type:"boolean"},{type:"array"},{type:"null"}]}},required:["op","parameter_ref"]}},required:["condition"]},fail_message_definition:{properties:{focus_parameter_ref:{description:"The parameter control to get the error/warning message.",type:"string"},message:{description:"User message",type:"object",$ref:"#/definitions/message_definition"},type:{enum:["error","warning","info"]}},required:["focus_parameter_ref","message"]},message_definition:{description:"User message",type:"object",properties:{default:{type:"string"},resource_key:{type:"string"}},anyOf:[{required:["default"]},{required:["resource_key"]}]},filter_definition:{properties:{filter:{description:"Filter test. Includes support for filtering the values to be displayed in a control",type:"object",properties:{parameter_ref:{description:"Parameter affected by this operation",type:"string"},parameter_refs:{description:"Parameters affected by this operation - exclusive with parameter_ref",type:"array",items:{type:"string"}},evaluate:{description:"Evaluates to return values included in a control",type:"object",$ref:"#/definitions/evaluate_definition"}},oneOf:[{required:["evaluate","parameter_ref"]},{required:["evaluate","parameter_refs"]}]}},required:["filter"]},enum_filter_definition:{properties:{enum_filter:{description:"Allows filtering of available enumeration options",type:"object",properties:{target:{description:"The target parameter information",type:"object",properties:{parameter_ref:{description:"The enumeration parameter affected by this operation",type:"string"},values:{description:"Array of available enumeration options when the condition evaluates to 'true'",type:"array",minItems:1,uniqueItems:!0}},required:["parameter_ref","values"]},evaluate:{description:"Evaluates to return values included in an enumeration control",type:"object",$ref:"#/definitions/evaluate_definition"}},required:["target","evaluate"]}},required:["enum_filter"]},filter_condition_definition:{description:"Allows for filtering available fields in the data record schema(s)",type:"object",properties:{condition:{description:"The condition that is evaluated",type:"object",anyOf:[{properties:{op:{$ref:"#/definitions/filter_op_definition"},value:{description:"Value to compare against data record schema field attribute",type:"string"}},required:["op"]},{properties:{op:{$ref:"#/definitions/filter_op_definition"},values:{description:"Array of values which are compared to a data record schema field attribute",type:"array",minItems:1,items:{type:"string"},uniqueItems:!0}},required:["op","values"]}]}},required:["condition"]},filter_op_definition:{description:"A single operator for comparing data record schema field attributes and sharing source fields",enum:["dmMeasurement","dmType","dmModelingRole","dmSharedFields"]},allow_change_definition:{properties:{allow_change:{description:"Allow change test. Allows a field value to be changed if evaluates to true.",type:"object",properties:{parameter_refs:{description:"Array of parameter names who values changes are allowed by this operation",type:"array",minItems:1,items:{type:"string"},uniqueItems:!0},evaluate:{description:"Evaluates to a boolean result",type:"object",$ref:"#/definitions/evaluate_definition"}},required:["parameter_refs","evaluate"]}},required:["allow_change"]},default_value_definition:{properties:{default_value:{description:"Set default value of the parameter_ref if condition evaluates to true.",type:"object",properties:{parameter_ref:{description:"Parameter whose default value is to be set.",type:"string"},value:{description:"This will be the default value of parameter_ref if condition evaluates to true.",type:["number","string","boolean","object","array"]},evaluate:{description:"Evaluates to a boolean result",type:"object",$ref:"#/definitions/evaluate_definition"}},required:["parameter_ref","value","evaluate"]}},required:["default_value"]}}},Hl={$schema:"https://json-schema.org/draft-04/schema#",id:"https://api.dataplatform.ibm.com/schemas/common-pipeline/operators/operator-v3-schema.json#",title:"Watson Data Platform Operator Schema",description:"Operator schema for the Watson Data Platform",type:"object",properties:{id:{description:"Operator identifier",type:"string"},json_schema:{description:"Refers to the JSON schema used to validate documents of this type",enum:["https://api.dataplatform.ibm.com/schemas/common-pipeline/operators/operator-v3-schema.json"]},operator_type:{description:"operator type",enum:["model","transformer","estimator","dataReader","dataWriter"]},input_ports:{description:"List of input ports. If no ports are defined this is a source operator that accepts no data inputs. If the input_ports array is missing a single input port with id 'input_port' is assumed which accepts only a single connection.",type:"array",minItems:0,items:{$ref:"#/definitions/port_definition"}},output_ports:{description:"List of output ports. If no ports are defined this is a terminal operator that provides no data outputs. If the output_ports array is missing a single output port named 'output_port' is assumed which accepts multiple connections.",type:"array",minItems:0,items:{$ref:"#/definitions/port_definition"}},complex_types:{description:"List of complex types",type:"array",items:{$ref:"#/definitions/complex_type_definition"}},parameters:{description:"List of parameters",type:"array",items:{$ref:"#/definitions/parameter_definition"}},app_data:{$ref:"#/definitions/app_data_def"}},required:["id","operator_type","parameters"],definitions:{parameter_definition:{description:"Operator parameters definition",type:"object",properties:{id:{description:"A unique name for the parameter.",type:"string"},required:{description:"Indication whether parameter is required or optional",type:"boolean",default:!1},role:{description:"Role of parameter",enum:["column","new_column","expression"]},type:{description:"Field type. Can be a primitive type (string, integer, double, date, time, timestamp, or custom), an array, or map containing those types(note arrays and maps can contain complex_types)",type:"string"},enum:{description:"List of valid values. Can be used instead of specifying type.",type:"array"},default:{description:"default value based on type of parameter",anyOf:[{$ref:"#/definitions/parameter_ref_definition"},{oneOf:[{type:"string"},{type:"number"},{type:"boolean"},{type:"array"},{type:"object"},{type:"null"}]}]}},anyOf:[{required:["id","type"]},{required:["id","enum"]},{required:["id","type","enum"]}]},parameter_ref_definition:{description:"Structure for parameter refs",type:"object",properties:{parameter_ref:{description:"Reference to another parameter.",type:"string"}},required:["parameter_ref"]},complex_type_definition:{description:"Structure for complex parameters",type:"object",properties:{id:{description:"Identifier of complex type, can be referenced in other places.",type:"string"},type:{description:"Used to determine how parameters in the complex_type stored. Valid values are array and object.",type:"string"},key_definition:{$ref:"#/definitions/parameter_definition"},parameters:{description:"List of parameters",type:"array",items:{anyOf:[{$ref:"#/definitions/parameter_definition"},{$ref:"#/definitions/complex_type_definition"}]}}},required:["id","parameters"]},port_definition:{description:"Operator ports support multiple differentiated connections for either inputs or outputs.",type:"object",properties:{id:{description:"Unique identifier within the node",type:"string"},cardinality:{description:"Property to capture how many connections are allowed for this port, e.g., min: 1, max:1 implies you must supply 1 and only 1; min:0, max:1 implies it is optional and a max of one, min:0, max:-1 means it is optional and you can may have any number of connections. The default value is 1:1 for inputs and 1:-1 for outputs.",type:"object",properties:{min:{description:"Minimum data sets that are required for this port",type:"integer",default:1},max:{description:"Maximum data sets that are allowed on this port. A negative value indicates unlimited. The default value is 1 for inputs and -1 for outputs.",type:"integer"}},additionalProperties:!1},parameters:{description:"List of parameters",type:"array",items:{$ref:"#/definitions/parameter_definition"}},complex_types:{description:"List of complex types",type:"array",items:{$ref:"#/definitions/complex_type_definition"}}}},app_data_def:{description:"Object containing application-specific data",type:"object",properties:{},additionalProperties:!0}}};function jl(e){var t=function(){var e=new A.Validator,t="https://api.dataplatform.ibm.com/schemas/common-canvas/",r="https://api.dataplatform.ibm.com/schemas/common-pipeline/";return e.addSchema(Vl,t+"parameter-defs/pipeline-flow-v3-schema.json"),e.addSchema(Ul,r+"operators/uihints-v3-schema.json"),e.addSchema(zl,r+"operators/conditions-v3-schema.json"),e.addSchema(Hl,r+"operators/operator-v3-schema.json"),e.addSchema(i.dataRecordMetadataV3Schema,r+"datarecord-metadata/datarecord-metadata-v3-schema.json"),e}();!function(e,t,r,o){var n=o.validate(e,t,{nestedErrors:!0});n&&n.errors&&n.errors.length>0&&console.error(n)}(e,Vl,0,t)}function Gl(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var ql=function(r){t._inherits(i,r);var n=Gl(i);function i(r){var a;return e._classCallCheck(this,i),(a=n.call(this,r)).state={focused:!1,titleValidation:null},a.editTitleClickHandler=a.editTitleClickHandler.bind(t._assertThisInitialized(a)),a.helpClickHandler=a.helpClickHandler.bind(t._assertThisInitialized(a)),a.id=o.generateId(),a.textInputRef=O.default.createRef(),a.labelText=o.formatMessage(r.controller.getReactIntl(),u.MESSAGE_KEYS.TITLE_EDITOR_LABEL),a.textInputOnFocus=a.textInputOnFocus.bind(t._assertThisInitialized(a)),a.textInputOnBlur=a.textInputOnBlur.bind(t._assertThisInitialized(a)),a.headingEnabled=a.props.showHeading&&(a.props.heading||a.props.icon),a.handleTitleChange=a.handleTitleChange.bind(t._assertThisInitialized(a)),a.titleChangeHandler=a.props.controller.getHandlers().titleChangeHandler,a}return e._createClass(i,[{key:"_handleKeyPress",value:function(e){"Enter"===e.key&&this.textInputRef.current.blur()}},{key:"editTitleClickHandler",value:function(){this.textInputRef.current.focus()}},{key:"helpClickHandler",value:function(){this.props.helpClickHandler&&this.props.helpClickHandler(this.props.controller.getForm().componentId,this.props.help.data,this.props.controller.getAppData())}},{key:"textInputOnFocus",value:function(){this.setState({focused:!0})}},{key:"textInputOnBlur",value:function(){this.setState({focused:!1})}},{key:"handleTitleChange",value:function(t){var r=this;null!==this.state.titleValidation&&this.setState({titleValidation:null});var o=t.target.value;"function"==typeof this.titleChangeHandler&&this.titleChangeHandler(o,(function(t){t&&"object"===e._typeof(t)&&t.type&&t.message?r.setState({titleValidation:t}):r.setState({titleValidation:null})})),this.props.setTitle(o)}},{key:"render",value:function(){var e=this,t=o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.TITLE_EDITOR_LABEL),r=o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.TITLE_EDITOR_HELPBUTTON_LABEL),n=o.formatMessage(this.props.controller.getReactIntl(),u.MESSAGE_KEYS.PROPERTIESEDIT_CLOSEBUTTON_LABEL),i=[u.CONDITION_MESSAGE_TYPE.ERROR,u.CONDITION_MESSAGE_TYPE.WARNING],s=a.get_1(this.state.titleValidation,"type",null)===u.CONDITION_MESSAGE_TYPE.WARNING,p=a.get_1(this.state.titleValidation,"type",null)===u.CONDITION_MESSAGE_TYPE.ERROR,c=!1===this.props.labelEditable||this.state.focused?O.default.createElement("div",null):O.default.createElement(l.Button,{kind:"ghost",className:"properties-title-editor-btn edit","data-id":"edit",onClick:this.editTitleClickHandler,tooltipPosition:"bottom",tooltipAlignment:"end",renderIcon:d.Edit16,size:"small",iconDescription:t,hasIconOnly:!0}),f=this.props.help?O.default.createElement(l.Button,{kind:"ghost",className:"properties-title-editor-btn help","data-id":"help",onClick:this.helpClickHandler,tooltipPosition:"bottom",renderIcon:d.Help16,size:"small",iconDescription:r,hasIconOnly:!0}):null,h=this.props.closeHandler?O.default.createElement("div",{className:"properties-close-button"},O.default.createElement(l.Button,{kind:"ghost",size:"small","data-id":"close",onClick:this.props.closeHandler,tooltipPosition:"left",renderIcon:d.Close16,iconDescription:n,hasIconOnly:!0})):null,m=null;if(this.headingEnabled){var y=this.props.heading?O.default.createElement("div",{className:"properties-title-heading-label"},this.props.heading):null,v=this.props.icon&&"string"==typeof this.props.icon?O.default.createElement(P.default,{className:"properties-title-heading-icon",src:this.props.icon}):null;(y||v)&&(m=O.default.createElement("div",{className:"properties-title-heading"},v,y,f))}return O.default.createElement("div",{className:u.classNames("properties-title-editor",{"properties-title-with-heading":this.headingEnabled})},h,m,O.default.createElement("div",{className:u.classNames("properties-title-editor-input",{"properties-title-editor-with-help":this.props.help&&!this.headingEnabled&&!i.includes(a.get_1(this.state.titleValidation,"type")),"properties-title-editor-with-warning":s,"properties-title-editor-with-error":p})},O.default.createElement(l.TextInput,u._extends({id:this.id,ref:this.textInputRef,value:this.props.title,onChange:this.handleTitleChange,onKeyPress:function(t){return e._handleKeyPress(t)},readOnly:!1===this.props.labelEditable,labelText:this.labelText,hideLabel:!0,size:"sm",onFocus:this.textInputOnFocus,onBlur:this.textInputOnBlur,light:this.props.controller.getLight(),invalid:p,invalidText:a.get_1(this.state.titleValidation,"message"),warn:s,warnText:a.get_1(this.state.titleValidation,"message")},this.state.focused&&{className:"properties-title-editor-focused"})),i.includes(a.get_1(this.state.titleValidation,"type"))?null:c),this.headingEnabled||i.includes(a.get_1(this.state.titleValidation,"type"))?null:f)}}]),i}(r.Component),Yl=c.connect((function(e,t){return{title:e.componentMetadataReducer.title}}),(function(e,t){return{setTitle:function(t){e(at(t))}}}))(ql),Kl='/*\n * Copyright 2017-2022 Elyra Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:export {\n  flyoutWidthSmall: 320px;\n  flyoutWidthMedium: 480px;\n  flyoutWidthLarge: 640px;\n  flyoutWidthMax: 900px;\n}';function Wl(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var Xl=parseInt(Kl.flyoutWidthSmall,10),$l=parseInt(Kl.flyoutWidthMedium,10),Jl=parseInt(Kl.flyoutWidthLarge,10),Zl=parseInt(Kl.flyoutWidthMax,10),Ql=function(r){t._inherits(s,r);var i=Wl(s);function s(r){var o;e._classCallCheck(this,s),(o=i.call(this,r)).propertiesController=new Fl,o.propertiesController.setPropertiesConfig(o.props.propertiesConfig),o.props.propertiesInfo.initialEditorSize&&o.propertiesController.setEditorSize(o.props.propertiesInfo.initialEditorSize),o.propertiesController.setCustomControls(r.customControls),o.propertiesController.setConditionOps(r.customConditionOps),o.propertiesController.setLight(r.light),o.propertiesController.setAppData(r.propertiesInfo.appData),o.propertiesController.setExpressionInfo(r.propertiesInfo.expressionInfo),o.propertiesController.setHandlers({controllerHandler:r.callbacks.controllerHandler,propertyListener:r.callbacks.propertyListener,actionHandler:r.callbacks.actionHandler,buttonHandler:r.callbacks.buttonHandler,buttonIconHandler:r.callbacks.buttonIconHandler,validationHandler:r.callbacks.validationHandler,titleChangeHandler:r.callbacks.titleChangeHandler,tooltipLinkHandler:r.callbacks.tooltipLinkHandler}),o.setForm(r.propertiesInfo),o.previousErrorMessages={},o.propertiesController.validatePropertiesValues(!1),r.propertiesInfo.messages&&(o.propertiesController.validatePropertiesValues(!0),o.previousErrorMessages=o.propertiesController.getAllErrorMessages()),o.props.callbacks.propertyListener&&o.props.callbacks.propertyListener({action:u.ACTIONS.PROPERTIES_LOADED}),o.currentParameters=o.propertiesController.getPropertyValues();var n=o.getEditorSize();return o.state={showPropertiesButtons:!0,editorSize:n},o.applyPropertiesEditing=o.applyPropertiesEditing.bind(t._assertThisInitialized(o)),o.showPropertiesButtons=o.showPropertiesButtons.bind(t._assertThisInitialized(o)),o.updateEditorSize=o.updateEditorSize.bind(t._assertThisInitialized(o)),o.cancelHandler=o.cancelHandler.bind(t._assertThisInitialized(o)),o._getOverrideSize=o._getOverrideSize.bind(t._assertThisInitialized(o)),o._getResizeButton=o._getResizeButton.bind(t._assertThisInitialized(o)),o._isResizeButtonRequired=o._isResizeButtonRequired.bind(t._assertThisInitialized(o)),o.onBlur=o.onBlur.bind(t._assertThisInitialized(o)),o}return e._createClass(s,[{key:"componentDidMount",value:function(){this.props.callbacks.setPropertiesHasMounted()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){if(e.propertiesInfo&&(!o.isEqual_1(Object.keys(e.propertiesInfo),Object.keys(this.props.propertiesInfo))||e.propertiesInfo.formData&&!o.isEqual_1(e.propertiesInfo.formData,this.props.propertiesInfo.formData)||e.propertiesInfo.parameterDef&&!o.isEqual_1(e.propertiesInfo.parameterDef,this.props.propertiesInfo.parameterDef)||e.propertiesInfo.appData&&!o.isEqual_1(e.propertiesInfo.appData,this.props.propertiesInfo.appData))){this.setForm(e.propertiesInfo);var t=this.propertiesController.getForm().editorSize;this.state.editorSize!==t&&this.setState({editorSize:t}),this.currentParameters=this.propertiesController.getPropertyValues(),this.propertiesController.setAppData(e.propertiesInfo.appData),this.propertiesController.setCustomControls(e.customControls),this.propertiesController.setConditionOps(e.customConditionOps),this.previousErrorMessages={},e.propertiesInfo.messages&&(this.propertiesController.validatePropertiesValues(),this.previousErrorMessages=this.propertiesController.getAllErrorMessages())}}},{key:"onBlur",value:function(e){!this.props.propertiesConfig.applyOnBlur||!this.commonProperties||this.commonProperties.contains(e.relatedTarget)||this.propertiesController.isSummaryPanelShowing()||this.propertiesController.isSubPanelsShowing()||this.applyPropertiesEditing(!1)}},{key:"setForm",value:function(e){var t=null;e.formData&&0!==Object.keys(e.formData).length?t=e.formData:e.parameterDef&&(this.props.propertiesConfig.schemaValidation&&jl(e.parameterDef),t=so.makeForm(e.parameterDef,this.props.propertiesConfig.containerType,this.props.propertiesConfig.convertValueDataTypes)),t&&t.data&&t.data.inputDataModel&&!t.data.datasetMetadata&&(t.data.datasetMetadata=o.convertInputDataModel(t.data.inputDataModel)),this.propertiesController.setForm(t,this.props.intl),t&&(this.originalTitle=t.label),this.initialValueInfo={additionalInfo:{messages:[]},undoInfo:{}},this.uiParameterKeys=this._getUiOnlyKeys(),this.initialValueInfo=this._setValueInforProperties(this.initialValueInfo),e.messages&&(this.initialValueInfo.additionalInfo.messages=n.cloneDeep_1(e.messages)),this.initialValueInfo.undoInfo.properties=this.propertiesController.getPropertyValues(),this.initialValueInfo.undoInfo.messages=this.propertiesController.getAllErrorMessages(),this.initialValueInfo.additionalInfo.title=this.propertiesController.getTitle()}},{key:"getApplyButtonLabel",value:function(){return this.props.propertiesConfig.buttonLabels&&this.props.propertiesConfig.buttonLabels.primary?this.props.propertiesConfig.buttonLabels.primary:o.formatMessage(this.props.intl,u.MESSAGE_KEYS.PROPERTIESEDIT_APPLYBUTTON_LABEL)}},{key:"getRejectButtonLabel",value:function(){return this.props.propertiesConfig.buttonLabels&&this.props.propertiesConfig.buttonLabels.secondary?this.props.propertiesConfig.buttonLabels.secondary:o.formatMessage(this.props.intl,u.MESSAGE_KEYS.PROPERTIESEDIT_REJECTBUTTON_LABEL)}},{key:"getPropertiesActionLabel",value:function(){if(this.props.callbacks.propertiesActionLabelHandler){var e=this.props.callbacks.propertiesActionLabelHandler();if(e)return e}return o.formatMessage(this.props.intl,u.MESSAGE_KEYS.PROPERTIES_ACTION_LABEL,{node_label:this.propertiesController.getTitle()})}},{key:"getEditorSize",value:function(){var e=this.propertiesController.getForm().editorSize,t=this.props.propertiesInfo.initialEditorSize;return(e!==o.Size.SMALL||t!==o.Size.LARGE&&t!==o.Size.MAX)&&(e!==o.Size.MEDIUM||t!==o.Size.SMALL&&t!==o.Size.MAX)&&(e!==o.Size.LARGE||t!==o.Size.SMALL&&t!==o.Size.MEDIUM)?e===o.Size.MAX?e:t||e:e}},{key:"_getOverrideSize",value:function(){var e=this.propertiesController.getForm().pixelWidth,t=this.propertiesController.getForm().editorSize,r=null;return e&&(t===o.Size.SMALL?this.state.editorSize===o.Size.SMALL&&e.min?r=e.min:this.state.editorSize===o.Size.MEDIUM&&e.max&&(r=e.max):t===o.Size.MEDIUM?this.state.editorSize===o.Size.MEDIUM&&e.min?r=e.min:this.state.editorSize===o.Size.LARGE&&e.max&&(r=e.max):t===o.Size.LARGE?this.state.editorSize===o.Size.LARGE&&e.min?r=e.min:this.state.editorSize===o.Size.MAX&&e.max&&(r=e.max):t===o.Size.MAX&&e.max&&(r=e.max)),r}},{key:"_getResizeButton",value:function(){var e=O.default.createElement(h.Icon,{type:u.CARBON_ICONS.CHEVRONARROWS.LEFT,className:"properties-resize-caret-left"});return this.propertiesController.getForm().editorSize===o.Size.SMALL?this.state.editorSize===o.Size.MEDIUM&&(e=O.default.createElement(h.Icon,{type:u.CARBON_ICONS.CHEVRONARROWS.RIGHT,className:"properties-resize-caret-right"})):this.propertiesController.getForm().editorSize===o.Size.MEDIUM?this.state.editorSize===o.Size.LARGE&&(e=O.default.createElement(h.Icon,{type:u.CARBON_ICONS.CHEVRONARROWS.RIGHT,className:"properties-resize-caret-right"})):this.propertiesController.getForm().editorSize===o.Size.LARGE&&this.state.editorSize===o.Size.MAX&&(e=O.default.createElement(h.Icon,{type:u.CARBON_ICONS.CHEVRONARROWS.RIGHT,className:"properties-resize-caret-right"})),e}},{key:"_isResizeButtonRequired",value:function(){var e=this.propertiesController.getForm().pixelWidth;if(!1!==this.props.propertiesConfig.enableResize){if(e){if(!e.min&&!e.max)return o.logger.warn("Pixel width was provided but no min or max property was found in it."),!0;if(this.propertiesController.getForm().editorSize===o.Size.SMALL){if(e.min&&!e.max&&e.min>=$l)return o.logger.warn("No resize button shown. Pixel width min size is greater than or equal to default max size: "+$l),!1;if(!e.min&&e.max&&e.max<=Xl)return o.logger.warn("No resize button shown. Pixel width max size is less than or equal to default min size: "+Xl),!1;if(e.min>=e.max)return o.logger.warn("No resize button shown. Pixel width min size is greater than or equal to pixel width max size."),!1}else if(this.propertiesController.getForm().editorSize===o.Size.MEDIUM){if(e.min&&!e.max&&e.min>=Jl)return o.logger.warn("No resize button shown. Pixel width min size is greater than or equal to default max size: "+Jl),!1;if(!e.min&&e.max&&e.max<=$l)return o.logger.warn("No resize button shown. Pixel width max size is less than or equal to default min size: "+$l),!1;if(e.min>=e.max)return o.logger.warn("No resize button shown. Pixel width min size is greater than or equal to default max size."),!1}else if(this.propertiesController.getForm().editorSize===o.Size.LARGE){if(e.min&&!e.max&&e.min>=Zl)return o.logger.warn("No resize button shown. Pixel width min size is greater than or equal to default max size: "+Zl),!1;if(!e.min&&e.max&&e.max<=Jl)return o.logger.warn("No resize button shown. Pixel width max size is less than or equal to default min size: "+Jl),!1;if(e.min>=e.max)return o.logger.warn("No resize button shown. Pixel width min size is greater than or equal to default max size."),!1}else if(this.propertiesController.getForm().editorSize===o.Size.MAX)return!!e.min&&(o.logger.warn("No resize button shown. Pixel width min size ignored."),!1)}else if(this.propertiesController.getForm().editorSize===o.Size.MAX)return!1;return!0}return!1}},{key:"_setValueInforProperties",value:function(e,t){var r=t&&!0===t.applyProperties,o=this.props.propertiesConfig.conditionReturnValueHandling===u.CONDITION_RETURN_VALUE_HANDLING.NULL,n=this.propertiesController.getPropertyValues({filterHiddenDisabled:o,applyProperties:r});return this.uiParameterKeys.length>0?(e.properties=Ee(n,this.uiParameterKeys),e.uiProperties=Y(n,this.uiParameterKeys)):e.properties=n,e}},{key:"_getUiOnlyKeys",value:function(){var e=[],t=this.propertiesController.getControls();if(Object.keys(t).length>0)for(var r in t){if(a.has_1(t,r))t[r].uionly&&e.push(r)}return e}},{key:"cancelHandler",value:function(e){this.props.callbacks.closePropertiesDialog&&this.props.callbacks.closePropertiesDialog(e)}},{key:"applyPropertiesEditing",value:function(e){this.propertiesController.validatePropertiesValues();var t=this.propertiesController.getAllErrorMessages();if(this.originalTitle!==this.propertiesController.getTitle()||this.currentParameters&&JSON.stringify(this.currentParameters)!==JSON.stringify(this.propertiesController.getPropertyValues())||JSON.stringify(this.previousErrorMessages)!==JSON.stringify(t)||this.props.propertiesConfig.applyPropertiesWithoutEdit){var r={additionalInfo:{},undoInfo:{}};(r=this._setValueInforProperties(r,{applyProperties:!0})).undoInfo.properties=this.propertiesController.getPropertyValues();var o=this.propertiesController.getErrorMessages(!0,!0,!0,!1);o&&(r.additionalInfo.messages=o),r.undoInfo.messages=this.propertiesController.getAllErrorMessages(),this.propertiesController.getTitle()&&(r.additionalInfo.title=this.propertiesController.getTitle());var a=this.getPropertiesActionLabel(),i=new po(r,this.initialValueInfo,this.props.propertiesInfo.appData,this.props.callbacks.applyPropertyChanges,a);this.propertiesController.getCommandStack().do(i),this.currentParameters=this.propertiesController.getPropertyValues(),this.initialValueInfo=n.cloneDeep_1(r),this.previousErrorMessages=this.propertiesController.getAllErrorMessages()}e&&this.cancelHandler(u.APPLY)}},{key:"showPropertiesButtons",value:function(e){this.setState({showPropertiesButtons:e})}},{key:"updateEditorSize",value:function(e){this.setState({editorSize:e}),this.propertiesController.setEditorSize(e)}},{key:"resize",value:function(){this.propertiesController.getForm().editorSize===o.Size.SMALL?this.state.editorSize===o.Size.SMALL?this.updateEditorSize(o.Size.MEDIUM):this.updateEditorSize(o.Size.SMALL):this.propertiesController.getForm().editorSize===o.Size.MEDIUM?this.state.editorSize===o.Size.MEDIUM?this.updateEditorSize(o.Size.LARGE):this.updateEditorSize(o.Size.MEDIUM):this.propertiesController.getForm().editorSize===o.Size.LARGE&&(this.state.editorSize===o.Size.LARGE?this.updateEditorSize(o.Size.MAX):this.updateEditorSize(o.Size.LARGE))}},{key:"render",value:function(){var e=this,t=this.props.propertiesConfig.applyOnBlur&&this.props.propertiesConfig.rightFlyout,r=this.cancelHandler.bind(this,u.CANCEL);t&&(r=null);var n=this.getApplyButtonLabel(),a=this.getRejectButtonLabel(),i=this.propertiesController.getForm();if(null!==i){var s=[],p=O.default.createElement("div",null),d=O.default.createElement("div",null),f=null,h=!1;if(this.props.propertiesConfig.rightFlyout&&(p=O.default.createElement(Yl,{labelEditable:i.labelEditable,help:i.help,controller:this.propertiesController,helpClickHandler:this.props.callbacks.helpClickHandler,closeHandler:t?this.applyPropertiesEditing.bind(this,!0):null,icon:i.icon,heading:i.heading,showHeading:this.props.propertiesConfig.heading}),h=this.props.propertiesConfig.heading&&(i.icon||i.heading),d=O.default.createElement(Pe,{controller:this.propertiesController,okHandler:t?null:this.applyPropertiesEditing.bind(this,!0),cancelHandler:r,applyLabel:n,rejectLabel:a,showPropertiesButtons:this.state.showPropertiesButtons,disableSaveOnRequiredErrors:this.props.propertiesConfig.disableSaveOnRequiredErrors}),this._isResizeButtonRequired())){var m=this._getResizeButton(),y=m.props&&"properties-resize-caret-left"===m.props.className?o.formatMessage(this.props.intl,u.MESSAGE_KEYS.PROPERTIESEDIT_RESIZEBUTTON_EXPAND_LABEL):o.formatMessage(this.props.intl,u.MESSAGE_KEYS.PROPERTIESEDIT_RESIZEBUTTON_CONTRACT_LABEL);f=O.default.createElement(l.Button,{kind:"ghost",className:"properties-btn-resize",onClick:this.resize.bind(this),"aria-label":y},m)}var v=O.default.createElement(ar,{key:"editor-form-key",controller:this.propertiesController,additionalComponents:this.props.propertiesInfo.additionalComponents,showPropertiesButtons:this.showPropertiesButtons,customPanels:this.props.customPanels,rightFlyout:this.props.propertiesConfig.rightFlyout});s="Editing"===this.props.propertiesConfig.containerType?O.default.createElement(Re,{applyLabel:n,rejectLabel:a,bsSize:this.state.editorSize,title:this.propertiesController.getTitle(),okHandler:this.applyPropertiesEditing.bind(this,!0),cancelHandler:r,showPropertiesButtons:this.state.showPropertiesButtons},v):"Custom"===this.props.propertiesConfig.containerType?O.default.createElement("div",{className:u.classNames("properties-custom-container",{"properties-custom-container-with-heading":!t&&h,"properties-custom-container-applyOnBlur":t&&!h,"properties-custom-container-applyOnBlur-with-heading":t&&h})},v):"Tearsheet"===this.props.propertiesConfig.containerType?O.default.createElement(Oe,{open:!0,onCloseCallback:this.props.propertiesConfig.applyOnBlur?this.applyPropertiesEditing.bind(this,!0):null,tearsheet:{title:this.propertiesController.getTitle(),content:v},applyLabel:n,rejectLabel:a,okHandler:this.applyPropertiesEditing.bind(this,!0),cancelHandler:r,showPropertiesButtons:this.state.showPropertiesButtons,applyOnBlur:this.props.propertiesConfig.applyOnBlur}):O.default.createElement(Te,{onHide:this.props.callbacks.closePropertiesDialog,title:this.propertiesController.getTitle(),bsSize:this.state.editorSize,okHandler:this.applyPropertiesEditing.bind(this,!0),cancelHandler:r,showPropertiesButtons:this.state.showPropertiesButtons,applyLabel:n,rejectLabel:a},v);var g=u.classNames("properties-wrapper",{"properties-right-flyout":this.props.propertiesConfig.rightFlyout,"properties-light-enabled":this.props.light,"properties-light-disabled":!this.props.light},"properties-".concat(this.state.editorSize)),b=this._getOverrideSize(),E=null;return null!==b&&(E={width:b+"px"}),O.default.createElement(c.Provider,{store:this.propertiesController.getStore()},O.default.createElement("aside",{"aria-label":o.formatMessage(this.props.intl,u.MESSAGE_KEYS.PROPERTIES_LABEL),role:"complementary",ref:function(t){return e.commonProperties=t},className:g,tabIndex:"0",onBlur:this.onBlur,style:E},f,p,s,d))}return O.default.createElement("div",null)}}]),s}(O.default.Component),eu=_.injectIntl(Ql,{forwardRef:!0});function tu(e){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,n=t._getPrototypeOf(e);if(r){var a=t._getPrototypeOf(this).constructor;o=Reflect.construct(n,arguments,a)}else o=n.apply(this,arguments);return t._possibleConstructorReturn(this,o)}}var ru=function(r){t._inherits(a,r);var n=tu(a);function a(r){var o;return e._classCallCheck(this,a),(o=n.call(this,r)).state={hasError:!1,error:null,info:null},o.createPropertiesMainComponent=o.createPropertiesMainComponent.bind(t._assertThisInitialized(o)),o.revertState=o.revertState.bind(t._assertThisInitialized(o)),o.propertiesMainHasMounted=!1,o.setPropertiesHasMounted=o.setPropertiesHasMounted.bind(t._assertThisInitialized(o)),o.applyPropertiesEditing=o.applyPropertiesEditing.bind(t._assertThisInitialized(o)),o}return e._createClass(a,[{key:"componentDidCatch",value:function(e,t){this.setState({hasError:!0,error:e,info:t})}},{key:"setPropertiesHasMounted",value:function(){this.propertiesMainHasMounted=!0}},{key:"applyPropertiesEditing",value:function(e){this.PropertiesMain.applyPropertiesEditing(e)}},{key:"createPropertiesMainComponent",value:function(){var e=this;return Object.assign(this.props.callbacks,{setPropertiesHasMounted:this.setPropertiesHasMounted}),O.default.createElement(eu,{ref:function(t){e.PropertiesMain=t},propertiesInfo:this.props.propertiesInfo,propertiesConfig:this.props.propertiesConfig,customPanels:this.props.customPanels,callbacks:this.props.callbacks,customControls:this.props.customControls,customConditionOps:this.props.customConditionOps,light:this.props.light})}},{key:"revertState",value:function(){this.setState({hasError:!1,error:null,info:null})}},{key:"displayAppropriateUIFallback",value:function(){var e,t,r={text:o.formatMessage(this.props.intl,u.MESSAGE_KEYS.PROPERTIES_UNEXPECTED_MESSAGE),type:"error"},n=O.default.createElement("div",{className:"properties-error-heading"},O.default.createElement(fa,{messageInfo:r})),a=o.formatMessage(this.props.intl,u.MESSAGE_KEYS.PROPERTIES_SUPPORT_MESSAGE),i=o.formatMessage(this.props.intl,u.MESSAGE_KEYS.PROPERTIESEDIT_CLOSEBUTTON_LABEL),s=this.props.callbacks.closePropertiesDialog,l=o.formatMessage(this.props.intl,u.MESSAGE_KEYS.PROPERTIESEDIT_REVERTBUTTON_LABEL),p=this.revertState,c=o.formatMessage(this.props.intl,u.MESSAGE_KEYS.PROPERTIES_LABEL);return"Custom"===this.props.propertiesConfig.containerType?(!0===this.propertiesMainHasMounted?(e=o.formatMessage(this.props.intl,u.MESSAGE_KEYS.PROPERTIES_REVERT_MESSAGE),t=O.default.createElement("div",{className:"properties-modal-buttons"},O.default.createElement(o.PropertiesButtons,{className:"properties-error-display-close-button",okHandler:s,cancelHandler:p,showPropertiesButtons:!0,applyLabel:i,rejectLabel:l}))):(e=o.formatMessage(this.props.intl,u.MESSAGE_KEYS.PROPERTIES_CLOSE_MESSAGE),t=O.default.createElement("div",{className:"properties-modal-buttons"},O.default.createElement(o.PropertiesButtons,{className:"properties-error-display-close-button",okHandler:s,showPropertiesButtons:!0,applyLabel:i}))),this.props.propertiesConfig.rightFlyout?O.default.createElement("aside",{"aria-label":c,role:"complementary",className:"properties-wrapper properties-right-flyout properties-small"},O.default.createElement("div",{className:"properties-flyout-error-container"},n,O.default.createElement("br",null),O.default.createElement("br",null),O.default.createElement("div",{className:"properties-error-content"},e,O.default.createElement("br",null),a)),t):O.default.createElement("aside",{"aria-label":c,role:"complementary",className:"properties-wrapper properties-custom-container"},O.default.createElement("div",{className:"properties-flyout-error-container"},n,O.default.createElement("br",null),O.default.createElement("br",null),O.default.createElement("div",{className:"properties-error-content"},e,O.default.createElement("br",null),a)),t)):(!0===this.propertiesMainHasMounted?(e=o.formatMessage(this.props.intl,u.MESSAGE_KEYS.PROPERTIES_REVERT_MESSAGE),t=O.default.createElement(Te,{bsSize:"large",showPropertiesButtons:!0,applyLabel:i,rejectLabel:l,okHandler:s,cancelHandler:p,title:n},O.default.createElement("div",{className:"properties-modal-container properties-error-content"},e,O.default.createElement("br",null),a))):(e=o.formatMessage(this.props.intl,u.MESSAGE_KEYS.PROPERTIES_CLOSE_MESSAGE),t=O.default.createElement("div",{className:"properties-modal-error"},O.default.createElement(Te,{okHandler:s,bsSize:"large",showPropertiesButtons:!0,applyLabel:i,rejectLabel:"null",title:n},O.default.createElement("div",{className:"properties-modal-container properties-error-content"},e,O.default.createElement("br",null),a)))),t)}},{key:"render",value:function(){return this.state.hasError?this.displayAppropriateUIFallback():this.createPropertiesMainComponent()}}]),a}(O.default.Component);ru.defaultProps={propertiesConfig:{containerType:"Custom",rightFlyout:!0,applyOnBlur:!1,trimSpaces:!0,disableSaveOnRequiredErrors:!1,enableResize:!0,conditionReturnValueHandling:"value",schemaValidation:!1,applyPropertiesWithoutEdit:!1,maxLengthForMultiLineControls:1024,maxLengthForSingleLineControls:128,convertValueDataTypes:!1},callbacks:{},light:!0};var ou=_.injectIntl(ru,{forwardRef:!0});exports.Form=so,exports.PropertiesController=Fl,exports.commonProperties=ou;
//# sourceMappingURL=common-properties-bba2c3c1.js.map
