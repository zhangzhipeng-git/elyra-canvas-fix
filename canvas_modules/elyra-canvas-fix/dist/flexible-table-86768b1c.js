"use strict";var e=require("./extends-841b39ac.js"),t=require("./createClass-826941b3.js"),r=require("./getPrototypeOf-1e698126.js"),o=require("./isArrayLikeObject-694e2d20.js"),i=require("react"),l=require("react-intl"),s=require("react-dom"),a=require("carbon-components-react"),n=require("./_baseForOwn-306b61ba.js"),d=require("react-virtualized"),c=require("react-draggable"),p=require("@carbon/icons-react"),u=require("./lib/tooltip.js"),h=require("uuid"),f=require("react-resize-detector");function b(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var m=b(i),v=b(s),w=b(c),y=b(f),g={"subPanel.button.tooltip":"Edit","structureListEditor.addButton.label":"Add value","structureListEditor.removeButton.label":"Remove","structureTable.addButton.label":"Add columns","structureTable.removeButton.label":"Remove","fieldPicker.saveButton.label":"Select Fields for","fieldPicker.saveButton.modal.label":"Save and continue","fieldPicker.resetButton.label":"Reset ","fieldPicker.filter.label":"Filter:","fieldPicker.fieldColumn.label":"Field name","fieldPicker.schemaColumn.label":"Schema name","fieldPicker.dataTypeColumn.label":"Data type","fieldPicker.integer.label":"integer","fieldPicker.double.label":"double","fieldPicker.string.label":"string","fieldPicker.date.label":"date","fieldPicker.time.label":"time","fieldPicker.timestamp.label":"timestamp","flyout.applyButton.label":"OK","flyout.rejectButton.label":"Cancel","propertiesEdit.closeButton.label":"Close","propertiesEdit.applyButton.label":"Save","propertiesEdit.rejectButton.label":"Cancel","propertiesEdit.revertButton.label":"Revert","propertiesEdit.resizeButton.expand.label":"Expand","propertiesEdit.resizeButton.contract.label":"Contract","properties.revert.message":"Click Revert to go back to the previous screen or click Close to exit the pane. Then try your operation again.","properties.close.message":"Click Close to exit the pane. Then try your operation again.","properties.support.message":"If the problem persists, contact support.","properties.unexpected.message":"Oops, the pane didn't load.","table.search.header":"View in tables","table.search.placeholder":"Find in column {column_name}","table.search.label":"Search in {table_name} table","summary.longTable.placeholder":"More than ten fields...","alerts.tab.title":"Alerts","title.editor.label":"edit title","title.editor.helpButton.label":"help","table.summary.error":"There are {errorMsgCount} error cells. ","table.summary.warning":"There are {warningMsgCount} warning cells. ","control.summary.error":"There are {errorMsgCount} parameters with errors. ","control.summary.warning":"There are {warningMsgCount} parameters with warnings. ","control.summary.error.warning":"There are {errorMsgCount} parameters with errors and {warningMsgCount} parameters with warnings.","required.error":"You must provide your {label}.","datetime.format.error":"Invalid {role}. Format should be {format}.","invalid.field.error":"Invalid {label}, field not found in data set.","invalid.number.error":"Number is not valid.","expression.validate.label":"Validate","expression.validating.label":"Validating","expression.builder.title":"Expression Builder","expression.builder.icon.description":"launch expression builder","expression.builder.label":"Expression","expression.fields.table.label":"Fields table","expression.values.table.label":"Values table","expression.fields.empty.table.label":"No fields found","expression.values.empty.table.label":"No values found","expression.functions.table.label":"Functions table","expression.fields.dropdown":"Fields","expression.fields.title":"Fields","expression.values.title":"Values","expression.field.column":"Field","expression.field.column.description":"","expression.storage.column":"Storage","expression.value.column":"Value","expression.value.column.description":"","expression.function.column":"Function","expression.return.column":"Return","expression.recently.used.column":"Item","expression.field.tab":"Fields","expression.functions.tab":"Functions","expression.recently.used":"Recently Used","expression.all.functions":"All Functions","expression.min.label":"Min","expression.minimize.label":"Minimize","expression.max.label":"Max","expression.maximize.label":"Maximize","toggle.on.label":"On","toggle.off.label":"Off","passwordShow.tooltip":"Show password","passwordHide.tooltip":"Hide password","expression.no.functions":"No functions found.","multi.selected.row.label":"rows selected.","multi.selected.row.action":"Changing a value in this row will change the value in all allowed selected rows.","datetimefield.format.error.message":"Invalid format object provided. Check input definitions.","editorform.group.type.error":"(Unknown group type '{group.groupType()}')","moveable.table.button.top":"Move to top","moveable.table.button.up":"Move up","moveable.table.button.down":"Move down","moveable.table.button.bottom":"Move to bottom","list.table.label":"Values","dropdown.tooltip.openMenu":"Open menu","dropdown.tooltip.closeMenu":"Close menu","dropdown.tooltip.clear.all":"Clear all","dropdown.tooltip.clear.selection":"Clear selection","truncate.long.string.error":"These values exceed the display limit of {truncate_limit} characters and can't be edited.","properties.label":"Properties","readonlytable.edit.button.label":"Edit","toggletext.icon.description":"{toggletext_label} Icon","multiselect.dropdown.empty.label":"None selected","multiselect.dropdown.options.selected.label":"options selected","virtualizedTable.header.checkbox.label":"Select all {header_checkbox_label}","virtualizedTable.row.checkbox.label":"Select row {row_index} from {table_label}","properties.empty.table.text":'To begin, click "{button_label}"',"label.indicator.required":"(required)","label.indicator.optional":"(optional)","emptyList.placeholder":"No options available"};var R=function(e,t){return null!=e&&t in Object(e)},C=o._hasPath;var E=function(e,t){return null!=e&&C(e,t,R)};var I=function(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}},k=o._baseIsMatch,T=o._getMatchData,_=I;var S=function(e){var t=T(e);return 1==t.length&&t[0][2]?_(t[0][0],t[0][1]):function(r){return r===e||k(r,e,t)}},x=o._baseIsEqual,O=o.get_1,N=E,H=o._isKey,M=o._isStrictComparable,A=I,D=o._toKey;var L=function(e,t){return H(e)&&M(t)?A(D(e),t):function(r){var o=O(r,e);return void 0===o&&o===t?N(r,e):x(t,o,3)}};var z=function(e){return function(t){return null==t?void 0:t[e]}},W=o._baseGet;var B=z,P=function(e){return function(t){return W(t,e)}},j=o._isKey,F=o._toKey;var K=function(e){return j(e)?B(F(e)):P(e)},G=S,U=L,q=o.identity_1,V=o.isArray_1,X=K;var Y=function(e){return"function"==typeof e?e:null==e?q:"object"==typeof e?V(e)?U(e[0],e[1]):G(e):X(e)},$=o._baseAssignValue,J=n._baseForOwn,Q=Y;var Z=function(e,t){var r={};return t=Q(t),J(e,(function(e,o,i){$(r,o,t(e,o,i))})),r},ee=o._baseDifference,te=o._baseFlatten,re=Y,oe=o._baseRest,ie=o.isArrayLikeObject_1,le=o.last_1,se=oe((function(e,t){var r=le(t);return ie(r)&&(r=void 0),ie(e)?ee(e,te(t,1,ie,!0),re(r)):[]}));function ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,i=r._getPrototypeOf(e);if(t){var l=r._getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,l)}else o=i.apply(this,arguments);return r._possibleConstructorReturn(this,o)}}var ne=function(i){r._inherits(s,i);var l=ae(s);function s(e,i){var a;return t._classCallCheck(this,s),(a=l.call(this,e,i)).state={rowCount:a.props.rowCount,columns:a.props.columns,columnResized:!1},a.virtualizedTableRef=m.default.createRef(),a.lastChecked=o.isEmpty_1(e.rowsSelected)?null:e.rowsSelected.slice(-1).pop(),a.isOverSelectOption=!1,a.mouseEventCalled=!1,a.keyBoardEventCalled=!1,a.cellRenderer=a.cellRenderer.bind(r._assertThisInitialized(a)),a.selectAll=a.selectAll.bind(r._assertThisInitialized(a)),a.headerRowRenderer=a.headerRowRenderer.bind(r._assertThisInitialized(a)),a.headerColRenderer=a.headerColRenderer.bind(r._assertThisInitialized(a)),a.onRowClick=a.onRowClick.bind(r._assertThisInitialized(a)),a.overSelectOption=a.overSelectOption.bind(r._assertThisInitialized(a)),a.resizeColumn=a.resizeColumn.bind(r._assertThisInitialized(a)),a}return t._createClass(s,[{key:"componentDidUpdate",value:function(){"function"==typeof this.props.rowHeight&&this.recomputeRowHeights()}},{key:"onRowClick",value:function(e,t,r){if("bx--select-option"===e.target.className)e.stopPropagation();else{var o=!this.isRowSelected(t.originalRowIndex);"function"==typeof this.props.setRowsSelected&&(this.props.setRowsSelected({index:r,originalRowIndex:t.originalRowIndex,selected:o,isOverSelectOption:this.isOverSelectOption,selectMultipleRows:!!e.shiftKey&&e.shiftKey,lastCheckedRow:null===this.lastChecked?0:this.lastChecked},e),this.lastChecked=t.index)}}},{key:"onRowDoubleClick",value:function(e,t,r){this.props.onRowDoubleClick&&this.props.onRowDoubleClick(e,t,r)}},{key:"getCheckboxLabelColumnIndex",value:function(e){for(var t=0;t<e.length;t++)if("index"!==e[t].operation)return t;return 0}},{key:"getColumnIndex",value:function(e,t){return e.findIndex((function(e){return e.key===t}))}},{key:"getColumnWiseDeltas",value:function(t,r){var o={};if(t.length>0){t.sort((function(e,t){return e.width-t.width}));for(var i=r,l=0;l<t.length;l++){var s=t.slice(l).reduce((function(e,t){return e+t.width}),0),a=Math.round(t[l].width*i/s);t[l].headerLabel.length>0&&t[l].width-a<e.MINIMUM_COLUMN_WIDTH?a=t[l].width-e.MINIMUM_COLUMN_WIDTH:t[l].width-a<e.MINIMUM_COLUMN_WIDTH_WITHOUT_LABEL&&(a=t[l].width-e.MINIMUM_COLUMN_WIDTH_WITHOUT_LABEL),i-=a,o[t[l].key]=a}if(i>0)return Z(o,(function(){return 0}))}return o}},{key:"isRowSelected",value:function(e){return!!this.props.rowsSelected&&this.props.rowsSelected.indexOf(e)>-1}},{key:"isLastColumn",value:function(e){var t=this.getColumnIndex(this.props.columns,e)===this.props.columns.length-1;return t}},{key:"selectAll",value:function(e){this.props.setAllRowsSelected(e)}},{key:"cellRenderer",value:function(e){var t=e.cellData;return null==t?"":t}},{key:"cellRendererHTML",value:function(e){var t=e.cellData;return null==t?"":m.default.createElement("div",{dangerouslySetInnerHTML:{__html:t}})}},{key:"recomputeRowHeights",value:function(e){this.virtualizedTableRef&&this.virtualizedTableRef.current&&this.virtualizedTableRef.current.recomputeRowHeights(e)}},{key:"headerRowRenderer",value:function(t,r){var o=r.className,i=r.columns,l=r.style,s=void 0===this.props.columns||0===this.props.columns.length?0:this.getCheckboxLabelColumnIndex(this.props.columns),n=void 0===this.props.columns||0===this.props.columns.length?"":this.props.columns[s].headerLabel,d=this.props.intl.formatMessage({id:"virtualizedTable.header.checkbox.label",defaultMessage:g["virtualizedTable.header.checkbox.label"]},{header_checkbox_label:n}),c=this.props.selectable&&this.props.rowSelection!==e.ROW_SELECTION.SINGLE?m.default.createElement("div",{role:"columnheader",className:"properties-vt-header-checkbox"},m.default.createElement(a.Checkbox,{id:"properties-vt-hd-cb-".concat(t),onChange:this.selectAll,checked:this.props.checkedAll,labelText:d,hideLabel:!0})):"";return m.default.createElement("div",{className:o,"data-role":"properties-header-row",role:"row",style:l},c,i)}},{key:"headerColRenderer",value:function(t){var r=this,i=t.columnData,l=t.dataKey,s=t.disableSort,a=t.label;t.sortBy,t.sortDirection;var n=null;if(void 0!==this.props.sortColumns[l]){var d=null;switch(this.props.sortColumns[l]){case e.SORT_DIRECTION.ASC:d=m.default.createElement(p.ArrowUp16,{disabled:this.props.tableState===e.STATES.DISABLED});break;case e.SORT_DIRECTION.DESC:d=m.default.createElement(p.ArrowDown16,{disabled:this.props.tableState===e.STATES.DISABLED});break;default:d=m.default.createElement(p.ArrowsVertical16,{disabled:this.props.tableState===e.STATES.DISABLED})}n=m.default.createElement("span",{className:"properties-ft-column-sort-icon"},d)}var c=i.headerLabel?m.default.createElement("div",{className:"properties-tooltips"},m.default.createElement("span",{style:{fontWeight:"bold"}},i.headerLabel)):null,f=o.isEmpty_1(i.description)?null:m.default.createElement("div",{className:"properties-vt-info-icon-tip"},m.default.createElement(u,{id:"properties-tooltip-".concat(i.headerLabel,"-info"),tip:i.description,direction:"bottom",className:"properties-tooltips",showToolTipOnClick:!0},m.default.createElement(p.Information16,{className:"properties-vt-info-icon"}))),b=h.v4()+"-tooltip-column-"+l,v=i.resizable&&!this.isLastColumn(l)?m.default.createElement(w.default,{axis:"x",defaultClassName:"properties-vt-header-resize",defaultClassNameDragging:"properties-vt-header-resize-active",onDrag:function(e,t){var o=t.deltaX;r.resizeColumn({dataKey:l,deltaX:o})},position:{x:0},zIndex:999},m.default.createElement("div",{role:"button",tabIndex:"0","aria-label":"Resize column"})):"",y=o.isEmpty_1(c)?m.default.createElement("div",{className:"properties-vt-label-icon"},a,f):m.default.createElement("div",{className:"properties-vt-label-tip-icon"},m.default.createElement(u,{id:b,tip:c,direction:"bottom",className:"properties-tooltips"},a),f);return m.default.createElement("div",{className:e.classNames({"properties-vt-column-with-resize":""!==v,"properties-vt-column-without-resize":""===v})},m.default.createElement("div",{className:e.classNames("properties-vt-column properties-tooltips-container",{"sort-column-active":l===this.props.sortBy})},y,!1===s&&n),v)}},{key:"resizeColumn",value:function(t){var r=this,i=t.dataKey,l=t.deltaX;this.setState((function(t){var s=t.columns,a=r.getColumnIndex(s,i),n=s.slice(a+1).filter((function(e){return!e.staticWidth})).filter((function(t){return!(l>=0)||(t.headerLabel.length>0?t.width>e.MINIMUM_COLUMN_WIDTH:t.width>e.MINIMUM_COLUMN_WIDTH_WITHOUT_LABEL)})),d=r.getColumnWiseDeltas(n,l),c=Object.keys(d),p=Object.values(d).every((function(e){return 0===e}));return s[a].width+l>e.MINIMUM_COLUMN_WIDTH&&!o.isEmpty_1(d)&&!p&&(s[a].width+=l,c.forEach((function(e){var t=s.findIndex((function(t){return t.key===e}));s[t].width-=d[e]}))),{columnResized:!0,columns:s}}))}},{key:"overSelectOption",value:function(e){"mouseenter"!==e.type||this.keyBoardEventCalled?"mouseleave"===e.type&&this.mouseEventCalled?(this.mouseEventCalled=!1,this.isOverSelectOption=!this.isOverSelectOption):"focus"!==e.type||this.mouseEventCalled?"blur"===e.type&&this.keyBoardEventCalled&&(this.keyBoardEventCalled=!1,this.isOverSelectOption=!this.isOverSelectOption):(this.keyBoardEventCalled=!0,this.isOverSelectOption=!this.isOverSelectOption):(this.mouseEventCalled=!0,this.isOverSelectOption=!this.isOverSelectOption)}},{key:"rowRenderer",value:function(t,r){var o=this,i=r.className,l=r.columns,s=r.index,n=r.key,d=r.rowData,c=r.style,p="",u=!1,h="boolean"==typeof d.disabled&&d.disabled;if("function"==typeof this.props.rowHeight&&0===this.props.rowHeight({index:s}))return null;if(this.props.selectable){var f=this.isRowSelected(d.originalRowIndex);if(u=this.props.selectable&&f,this.props.rowSelection!==e.ROW_SELECTION.SINGLE){var b=this.props.intl.formatMessage({id:"virtualizedTable.row.checkbox.label",defaultMessage:g["virtualizedTable.row.checkbox.label"]},{row_index:s+1,table_label:this.props.tableLabel?this.props.tableLabel:""});p=m.default.createElement("div",{className:"properties-vt-row-checkbox",role:"gridcell",onMouseEnter:function(e){return o.overSelectOption(e)},onMouseLeave:function(e){return o.overSelectOption(e)},onFocus:function(e){return o.overSelectOption(e)},onBlur:function(e){return o.overSelectOption(e)},onKeyDown:function(e){"Space"!==e.code&&"Enter"!==e.code||o.onRowClick(e,d,s)}},m.default.createElement(a.Checkbox,{id:"properties-vt-row-cb-".concat(t,"-").concat(s),key:"properties-vt-row-cb-".concat(t,"-").concat(s),labelText:b,hideLabel:!0,checked:f,disabled:h}))}}if(this.props.summaryTable&&(p=m.default.createElement("div",{className:"properties-vt-row-checkbox"})),!0===d.loading)return m.default.createElement("div",{className:i,key:n,"data-role":"properties-loading-row",role:"row",style:c},m.default.createElement(a.Loading,{className:"properties-vt-small-loading",small:!0,withOverlay:!1}));var v=parseInt(c.width,10)+"px",w=Object.assign({},c,{width:v});return m.default.createElement("div",{style:{},key:n,className:"properties-vt-double-click",onDoubleClick:function(e){return o.onRowDoubleClick(e,d.rowKey,s)}},m.default.createElement("div",{className:e.classNames(i,{"properties-vt-row-selected":u},{"properties-vt-row-disabled":h},{"properties-vt-row-non-interactive":!this.props.selectable}),"data-role":"properties-data-row",role:"row",style:w,onMouseDown:function(e){return o.onRowClick(e,d,s)}},p,l))}},{key:"render",value:function(){var t=this;return m.default.createElement("div",{className:"properties-vt"},m.default.createElement("div",{className:e.classNames("properties-vt-autosizer",{"properties-vt-single-selection":this.props.rowSelection&&this.props.rowSelection===e.ROW_SELECTION.SINGLE,"properties-light-disabled":!this.props.light})},m.default.createElement(d.AutoSizer,null,(function(r){var o=r.height,i=r.width;return m.default.createElement(d.Table,{ref:t.virtualizedTableRef,width:i||500,height:t.props.tableHeight||o||2e3,className:"properties-autosized-vt","aria-label":t.props.tableLabel?t.props.tableLabel:"",disableHeader:t.props.disableHeader,headerClassName:"properties-autosized-vt-header",headerHeight:32,headerRowRenderer:t.headerRowRenderer.bind(t,t.props.scrollKey),onHeaderClick:t.props.onHeaderClick,rowClassName:"properties-vt-row-class",rowHeight:t.props.rowHeight?t.props.rowHeight:32,rowCount:t.state.rowCount,rowGetter:t.props.rowGetter,rowRenderer:t.rowRenderer.bind(t,t.props.scrollKey),scrollToIndex:t.props.scrollToIndex,scrollToAlignment:t.props.scrollToAlignment,sort:t.props.onSort,sortDirection:t.props.sortDirection},t.state.columns.map((function(r){return m.default.createElement(d.Column,e._extends({key:r.key,label:r.label,dataKey:r.key,width:r.width,columnData:r,disableSort:void 0===t.props.sortColumns[r.key],cellRenderer:r.isHTML?t.cellRendererHTML:t.cellRenderer,headerRenderer:t.headerColRenderer},r.minWidth&&{minWidth:r.minWidth}))})))}))))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var r={};return e.rowCount!==t.rowCount&&(r.rowCount=e.rowCount),t.columnResized&&o.isEmpty_1(se(e.columns,t.columns,"headerLabel"))||(r.columns=e.columns),r}}]),s}(m.default.Component);ne.defaultProps={disableHeader:!1};var de=l.injectIntl(ne);function ce(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return pe(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pe(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,s=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){a=!0,l=e},f:function(){try{s||null==r.return||r.return()}finally{if(a)throw l}}}}function pe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function ue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var o,i=r._getPrototypeOf(e);if(t){var l=r._getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,l)}else o=i.apply(this,arguments);return r._possibleConstructorReturn(this,o)}}var he=function(i){r._inherits(s,i);var l=ue(s);function s(o){var i;t._classCallCheck(this,s);var a={};if(void 0!==(i=l.call(this,o)).props.sortable)for(var n=0;n<i.props.sortable.length;n++){a[i.props.sortable[n]]=e.SORT_DIRECTION.NOT_SORTED}return i.state={checkedAllRows:!1,columnSortDir:a,currentSortColumn:"",tableWidth:0,tableHeight:0,rows:void 0!==o.rows?o.rows:5.5,dynamicHeight:null},i.rowHeight=i.rowHeight.bind(r._assertThisInitialized(i)),i.rowGetter=i.rowGetter.bind(r._assertThisInitialized(i)),i.getOriginalRowIndex=i.getOriginalRowIndex.bind(r._assertThisInitialized(i)),i.getLastChildPropertyIdRow=i.getLastChildPropertyIdRow.bind(r._assertThisInitialized(i)),i.calculateColumnWidths=i.calculateColumnWidths.bind(r._assertThisInitialized(i)),i.handleFilterChange=i.handleFilterChange.bind(r._assertThisInitialized(i)),i.onSort=i.onSort.bind(r._assertThisInitialized(i)),i.sortHeaderClick=i.sortHeaderClick.bind(r._assertThisInitialized(i)),i._updateTableWidth=i._updateTableWidth.bind(r._assertThisInitialized(i)),i._adjustTableHeight=i._adjustTableHeight.bind(r._assertThisInitialized(i)),i.handleCheckedRow=i.handleCheckedRow.bind(r._assertThisInitialized(i)),i.handleCheckedAllRows=i.handleCheckedAllRows.bind(r._assertThisInitialized(i)),i.handleCheckedMultipleRows=i.handleCheckedMultipleRows.bind(r._assertThisInitialized(i)),i}return t._createClass(s,[{key:"componentDidMount",value:function(){this._adjustTableHeight(),window.addEventListener("resize",this._adjustTableHeight),this.tableNode=v.default.findDOMNode(this.refs.table)}},{key:"componentDidUpdate",value:function(e,t){e.rows===this.props.rows&&e.columns===this.props.columns&&e.noAutoSize===this.props.noAutoSize||this._adjustTableHeight(),this.props.selectedRows&&!o.isEmpty_1(this.props.data)&&this.setCheckedAll(this.props.selectedRows),this.tableNode=v.default.findDOMNode(this.refs.table)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._adjustTableHeight)}},{key:"onSort",value:function(t){var r=t.sortBy;if(this.props.onSort){var o={column:r,direction:this.state.columnSortDir[r]===e.SORT_DIRECTION.ASC?e.SORT_DIRECTION.DESC:e.SORT_DIRECTION.ASC};this.props.onSort(o)}}},{key:"getOriginalRowIndex",value:function(e,t){var r=t;return e.columns&&o.has_1(e.columns[0],"content.props.children.props.propertyId.propertyId")?r=this.getLastChildPropertyIdRow(e.columns[0].content.props.children.props.propertyId,t):e.columns&&o.has_1(e.columns[0],"content.props.children.props.propertyId.index")?r=e.columns[0].content.props.children.props.propertyId.index:e.columns&&o.has_1(e.columns[0],"content.props.children.props.propertyId.row")?r=e.columns[0].content.props.children.props.propertyId.row:"number"==typeof e.rowKey&&(r=parseInt(e.rowKey,10)),r}},{key:"getLastChildPropertyIdRow",value:function(e,t){return void 0!==e.propertyId?this.getLastChildPropertyIdRow(e.propertyId):void 0!==e.row?e.row:t}},{key:"setCheckedAll",value:function(e){for(var t=!0,r=0;r<this.props.data.length;r++){var o=this.props.data[r],i=this.getOriginalRowIndex(o,r);if(e.indexOf(i)<0){t=!1;break}}this.state.checkedAllRows!==t&&this.setState({checkedAllRows:t})}},{key:"calculateColumnWidths",value:function(t,r){var o=r-12;this.props.rowSelection!==e.ROW_SELECTION.SINGLE&&(o-=40);var i,l=t.length,s=0,a=ce(t);try{for(a.s();!(i=a.n()).done;){var n=i.value;n.width&&("string"==typeof n.width&&n.width.includes("px")?(o-=parseInt(n.width,10),l--):s=Math.max(s,n.width))}}catch(e){a.e(e)}finally{a.f()}var d,c=[],p=Math.floor(o/l),u=[],h=0,f=ce(t);try{for(f.s();!(d=f.n()).done;){var b=d.value;b.width&&!isNaN(b.width)?(u.push(b.width/s),h+=b.width/s):u.push(null)}}catch(e){f.e(e)}finally{f.f()}for(var m=o/h,v=0,w=0;w<t.length;w++){var y=t[w];if(y.width)if("string"==typeof y.width&&y.width.includes("px"))c.push(Math.floor(parseInt(y.width,10))+"px"),v+=parseInt(y.width,10);else{var g=Math.floor(u[w]*m);c.push(g+"px"),v+=g}else c.push(p),v+=p}var R=r;if(this.props.rowSelection!==e.ROW_SELECTION.SINGLE&&(R-=40),v<R){var C=parseInt(c[0],10);c[0]=C+R-v+"px"}return c}},{key:"_updateTableWidth",value:function(e,t){this.state.tableWidth!==Math.floor(e-2)&&this.setState({tableWidth:Math.floor(e-2)})}},{key:"_adjustTableHeight",value:function(){if(!this.props.noAutoSize){var t=this.state.tableHeight,r=this.state.dynamicHeight,o=e.REM_ROW_HEIGHT+e.REM_HEADER_HEIGHT;if(Array.isArray(this.props.data)&&this.props.data.length<this.state.rows)t=e.REM_ROW_HEIGHT*this.props.data.length+e.REM_HEADER_HEIGHT+(this.props.selectedEditRow?o:0)+"rem";else if(this.state.rows>0)t=e.REM_ROW_HEIGHT*this.state.rows+e.REM_HEADER_HEIGHT+(this.props.selectedEditRow?o:0)+"rem";else if(0===this.state.rows)t=e.REM_HEADER_HEIGHT+"rem";else if(-1===this.state.rows&&this.flexibleTable){var i=void 0!==this.flexibleTableHeader?v.default.findDOMNode(this.flexibleTableHeader).getBoundingClientRect().height:0,l=this.findPropertyNodeHeight(this.flexibleTable,"properties-wf-children");0===l?(t="100vh",r=-1):(t="calc(".concat(l-i-50,"px - 3.5rem)"),r=l-i-50-56)}t!==this.state.tableHeight&&this.setState({tableHeight:t,dynamicHeight:r})}}},{key:"findPropertyNodeHeight",value:function(e,t){if(e&&e.parentNode&&e.parentNode.className&&e.parentNode.className.includes(t)){var r=v.default.findDOMNode(e.parentNode).getBoundingClientRect();return r?r.height:0}return e&&e.parentNode?this.findPropertyNodeHeight(e.parentNode,t):0}},{key:"sortHeaderClick",value:function(t){var r=t.dataKey,o=this.state.columnSortDir;void 0!==o[r]&&(Object.keys(o).forEach((function(t){t!==r&&(o[t]=e.SORT_DIRECTION.NOT_SORTED)})),o[r]=o[r]===e.SORT_DIRECTION.ASC?e.SORT_DIRECTION.DESC:e.SORT_DIRECTION.ASC,this.setState({columnSortDir:o,currentSortColumn:r}))}},{key:"handleFilterChange",value:function(e){this.props.onFilter&&this.props.onFilter(e.target.value)}},{key:"handleCheckedAllRows",value:function(e){var t=[],r=this.props.data;if(e){t=Array.from(this.props.selectedRows);for(var o=0;o<r.length;o++){var i=this.getOriginalRowIndex(r[o],o);t.push(i)}}t=Array.from(new Set(t)),this.props.updateRowSelections(t),this.setState({checkedAllRows:e})}},{key:"handleCheckedMultipleRows",value:function(e,t,r){var o,i=this.props.selectedRows?this.props.selectedRows:[];return o=e<t?Array.from({length:t-e+1},(function(t,r){return e+r})):Array.from({length:e-t+1},(function(e,r){return t+r})),i=i.filter((function(e){return!o.includes(e)})),r&&(i=i.concat(o)),i}},{key:"handleCheckedRow",value:function(t,r){var o=t.originalRowIndex,i=t.index,l=t.selected,s=t.isOverSelectOption;if(!this.props.data[i].disabled&&"function"==typeof this.props.updateRowSelections)if(s){var a=this.props.selectedRows?this.props.selectedRows:[];t.selectMultipleRows?(a=this.handleCheckedMultipleRows(t.lastCheckedRow,i,l),this.setCheckedAll(a)):l?(a=a.concat(o),this.setCheckedAll(a)):a&&(a=a.filter((function(e){return e!==o})),this.setState({checkedAllRows:!1})),a.sort((function(e,t){return e-t})),this.props.updateRowSelections(a)}else this.props.rowSelection===e.ROW_SELECTION.SINGLE&&this.props.updateRowSelections(t.index,r,this.props.data[t.index].rowKey)}},{key:"generateTableHeaderRow",value:function(e){for(var r=[],o="",i=0;i<this.props.columns.length;i++){var l=this.props.columns[i];void 0!==this.props.filterable&&this.props.filterable[0]===l.key&&(o=l.label);var s=Math.abs(parseInt(e[i],10)),a=void 0;"object"===t._typeof(l.label)?a=l.label.props.labelText:"string"==typeof l.label&&(a=l.label),r.push({key:l.key,label:l.label,width:s,description:l.description,headerLabel:a,resizable:l.resizable,operation:l.operation,staticWidth:!!l.staticWidth&&l.staticWidth})}return{headers:r,searchLabel:o}}},{key:"rowGetter",value:function(e){var t=e.index,r=this.props.data[t],o=this.getOriginalRowIndex(r,t),i={};if(r.columns)for(var l=0;l<r.columns.length;l++){var s=r.columns[l];i[s.column]=s.content}return Object.assign({},i,{loading:!1,index:t,originalRowIndex:o,rowKey:void 0!==r.rowKey?r.rowKey:this.props.scrollKey+"-row-"+t,disabled:r.disabled})}},{key:"rowHeight",value:function(t){return t.index,e.ROW_HEIGHT}},{key:"render",value:function(){var t=this,r=this.state.tableWidth,i=this.calculateColumnWidths(this.props.columns,r),l=this.generateTableHeaderRow(i),s=l.headers,n=l.searchLabel,d=this.props.tableState===e.STATES.DISABLED,c=null;if(void 0!==this.props.filterable&&0!==this.props.filterable.length){var p=this.props.intl.formatMessage({id:"table.search.placeholder",defaultMessage:g["table.search.placeholder"]},{column_name:n}),u=this.props.intl.formatMessage({id:"table.search.label",defaultMessage:g["table.search.label"]},{table_name:this.props.tableLabel});c=m.default.createElement("div",{className:e.classNames("properties-ft-search-container",{disabled:d})},m.default.createElement(a.Search,{className:"properties-ft-search-text",placeholder:p,onChange:this.handleFilterChange,disabled:d,size:"sm",labelText:u,light:this.props.light}))}var h=-1;void 0!==this.props.scrollToRow&&null!==this.props.scrollToRow&&(h=this.props.scrollToRow);var f={};this.props.noAutoSize||(f={height:this.state.tableHeight});var b=this.props.showHeader?"properties-ft-container-absolute ":"properties-ft-container-absolute-noheader ",v=this.props.messageInfo?b:b+e.STATES.INFO,w=c||this.props.topRightPanel?m.default.createElement("div",{className:"properties-ft-table-header",ref:function(e){return t.flexibleTableHeader=e}},c,this.props.topRightPanel):null,R=o.isEmpty_1(this.props.data)?m.default.createElement("div",{className:"properties-ft-empty-table"},this.props.emptyTablePlaceholder):null,C=e.classNames("properties-ft-control-container",{"properties-light-disabled":!this.props.light}),E=0,I=2*e.REM_HEADER_HEIGHT,k=I*e.ONE_REM_HEIGHT;-1!==this.state.rows&&this.state.tableHeight?E=(parseInt(this.state.tableHeight,10)-(this.props.selectedEditRow?I:0))*e.ONE_REM_HEIGHT:-1===this.state.rows&&this.state.dynamicHeight&&-1!==this.state.dynamicHeight&&(E=this.state.dynamicHeight-(this.props.selectedEditRow?k:0));return m.default.createElement("div",{"data-id":"properties-ft-"+this.props.scrollKey,className:C,ref:function(e){return t.flexibleTable=e}},w,m.default.createElement("div",{className:"properties-ft-container-panel"},m.default.createElement(y.default,{handleWidth:!0,onResize:this._updateTableWidth},m.default.createElement("div",{className:e.classNames("properties-ft-container-wrapper",this.props.messageInfo?this.props.messageInfo.type:""),style:f},m.default.createElement("div",{className:v},this.props.selectedEditRow,m.default.createElement(de,e._extends({tableLabel:this.props.tableLabel,tableHeight:E,columns:s,onHeaderClick:this.sortHeaderClick,rowCount:this.props.data.length,rowHeight:this.rowHeight,rowGetter:this.rowGetter,summaryTable:this.props.summaryTable,selectable:void 0!==this.props.updateRowSelections,rowSelection:this.props.rowSelection,disableHeader:!this.props.showHeader,onRowDoubleClick:this.props.onRowDoubleClick,rowsSelected:this.props.selectedRows,checkedAll:this.state.checkedAllRows,setRowsSelected:this.handleCheckedRow,setAllRowsSelected:this.handleCheckedAllRows,scrollKey:this.props.scrollKey,onSort:this.onSort,sortBy:this.state.currentSortColumn,sortColumns:this.state.columnSortDir,sortDirection:this.state.columnSortDir[this.state.currentSortColumn],tableState:this.props.tableState,light:this.props.light},-1!==h&&{scrollToIndex:h,scrollToAlignment:"center"})))))),R)}}]),s}(m.default.Component);he.defaultProps={showHeader:!0,light:!0,emptyTablePlaceholder:""};var fe=l.injectIntl(he);exports.FlexibleTable=fe,exports._baseIteratee=Y,exports.defaultMessages=g,exports.hasIn_1=E;
//# sourceMappingURL=flexible-table-86768b1c.js.map
